function FastClick(e){var t,n=this;if(this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=e,!e||!e.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return FastClick.prototype.onClick.apply(n,arguments)},this.onMouse=function(){return FastClick.prototype.onMouse.apply(n,arguments)},this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(n,arguments)},this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(n,arguments)},this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(n,arguments)},FastClick.notNeeded(e)||(this.deviceIsAndroid&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,i){var s=Node.prototype.removeEventListener;"click"===t?s.call(e,t,n.hijacked||n,i):s.call(e,t,n,i)},e.addEventListener=function(t,n,i){var s=Node.prototype.addEventListener;"click"===t?s.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),i):s.call(e,t,n,i)}),"function"==typeof e.onclick&&(t=e.onclick,e.addEventListener("click",function(e){t(e)},!1),e.onclick=null))}!function(){var e=this,t=e._,n={},i=Array.prototype,s=Object.prototype,r=Function.prototype,o=i.push,a=i.slice,l=i.concat,c=s.toString,h=s.hasOwnProperty,u=i.forEach,d=i.map,p=i.reduce,f=i.reduceRight,m=i.filter,g=i.every,v=i.some,b=i.indexOf,y=i.lastIndexOf,_=Array.isArray,w=Object.keys,k=r.bind,S=function(e){return e instanceof S?e:this instanceof S?(this._wrapped=e,void 0):new S(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.4.4";var x=S.each=S.forEach=function(e,t,i){if(null!=e)if(u&&e.forEach===u)e.forEach(t,i);else if(e.length===+e.length){for(var s=0,r=e.length;r>s;s++)if(t.call(i,e[s],s,e)===n)return}else for(var o in e)if(S.has(e,o)&&t.call(i,e[o],o,e)===n)return};S.map=S.collect=function(e,t,n){var i=[];return null==e?i:d&&e.map===d?e.map(t,n):(x(e,function(e,s,r){i[i.length]=t.call(n,e,s,r)}),i)};var C="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(e,t,n,i){var s=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return i&&(t=S.bind(t,i)),s?e.reduce(t,n):e.reduce(t);if(x(e,function(e,r,o){s?n=t.call(i,n,e,r,o):(n=e,s=!0)}),!s)throw new TypeError(C);return n},S.reduceRight=S.foldr=function(e,t,n,i){var s=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return i&&(t=S.bind(t,i)),s?e.reduceRight(t,n):e.reduceRight(t);var r=e.length;if(r!==+r){var o=S.keys(e);r=o.length}if(x(e,function(a,l,c){l=o?o[--r]:--r,s?n=t.call(i,n,e[l],l,c):(n=e[l],s=!0)}),!s)throw new TypeError(C);return n},S.find=S.detect=function(e,t,n){var i;return P(e,function(e,s,r){return t.call(n,e,s,r)?(i=e,!0):void 0}),i},S.filter=S.select=function(e,t,n){var i=[];return null==e?i:m&&e.filter===m?e.filter(t,n):(x(e,function(e,s,r){t.call(n,e,s,r)&&(i[i.length]=e)}),i)},S.reject=function(e,t,n){return S.filter(e,function(e,i,s){return!t.call(n,e,i,s)},n)},S.every=S.all=function(e,t,i){t||(t=S.identity);var s=!0;return null==e?s:g&&e.every===g?e.every(t,i):(x(e,function(e,r,o){return(s=s&&t.call(i,e,r,o))?void 0:n}),!!s)};var P=S.some=S.any=function(e,t,i){t||(t=S.identity);var s=!1;return null==e?s:v&&e.some===v?e.some(t,i):(x(e,function(e,r,o){return s||(s=t.call(i,e,r,o))?n:void 0}),!!s)};S.contains=S.include=function(e,t){return null==e?!1:b&&e.indexOf===b?-1!=e.indexOf(t):P(e,function(e){return e===t})},S.invoke=function(e,t){var n=a.call(arguments,2),i=S.isFunction(t);return S.map(e,function(e){return(i?t:e[t]).apply(e,n)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.where=function(e,t,n){return S.isEmpty(t)?n?null:[]:S[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},S.findWhere=function(e,t){return S.where(e,t,!0)},S.max=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-1/0;var i={computed:-1/0,value:-1/0};return x(e,function(e,s,r){var o=t?t.call(n,e,s,r):e;o>=i.computed&&(i={value:e,computed:o})}),i.value},S.min=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return 1/0;var i={computed:1/0,value:1/0};return x(e,function(e,s,r){var o=t?t.call(n,e,s,r):e;o<i.computed&&(i={value:e,computed:o})}),i.value},S.shuffle=function(e){var t,n=0,i=[];return x(e,function(e){t=S.random(n++),i[n-1]=i[t],i[t]=e}),i};var T=function(e){return S.isFunction(e)?e:function(t){return t[e]}};S.sortBy=function(e,t,n){var i=T(t);return S.pluck(S.map(e,function(e,t,s){return{value:e,index:t,criteria:i.call(n,e,t,s)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index<t.index?-1:1}),"value")};var E=function(e,t,n,i){var s={},r=T(t||S.identity);return x(e,function(t,o){var a=r.call(n,t,o,e);i(s,a,t)}),s};S.groupBy=function(e,t,n){return E(e,t,n,function(e,t,n){(S.has(e,t)?e[t]:e[t]=[]).push(n)})},S.countBy=function(e,t,n){return E(e,t,n,function(e,t){S.has(e,t)||(e[t]=0),e[t]++})},S.sortedIndex=function(e,t,n,i){n=null==n?S.identity:T(n);for(var s=n.call(i,t),r=0,o=e.length;o>r;){var a=r+o>>>1;n.call(i,e[a])<s?r=a+1:o=a}return r},S.toArray=function(e){return e?S.isArray(e)?a.call(e):e.length===+e.length?S.map(e,S.identity):S.values(e):[]},S.size=function(e){return null==e?0:e.length===+e.length?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:a.call(e,0,t)},S.initial=function(e,t,n){return a.call(e,0,e.length-(null==t||n?1:t))},S.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},S.rest=S.tail=S.drop=function(e,t,n){return a.call(e,null==t||n?1:t)},S.compact=function(e){return S.filter(e,S.identity)};var N=function(e,t,n){return x(e,function(e){S.isArray(e)?t?o.apply(n,e):N(e,t,n):n.push(e)}),n};S.flatten=function(e,t){return N(e,t,[])},S.without=function(e){return S.difference(e,a.call(arguments,1))},S.uniq=S.unique=function(e,t,n,i){S.isFunction(t)&&(i=n,n=t,t=!1);var s=n?S.map(e,n,i):e,r=[],o=[];return x(s,function(n,i){(t?i&&o[o.length-1]===n:S.contains(o,n))||(o.push(n),r.push(e[i]))}),r},S.union=function(){return S.uniq(l.apply(i,arguments))},S.intersection=function(e){var t=a.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=l.apply(i,a.call(arguments,1));return S.filter(e,function(e){return!S.contains(t,e)})},S.zip=function(){for(var e=a.call(arguments),t=S.max(S.pluck(e,"length")),n=new Array(t),i=0;t>i;i++)n[i]=S.pluck(e,""+i);return n},S.object=function(e,t){if(null==e)return{};for(var n={},i=0,s=e.length;s>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},S.indexOf=function(e,t,n){if(null==e)return-1;var i=0,s=e.length;if(n){if("number"!=typeof n)return i=S.sortedIndex(e,t),e[i]===t?i:-1;i=0>n?Math.max(0,s+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;s>i;i++)if(e[i]===t)return i;return-1},S.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(y&&e.lastIndexOf===y)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var s=i?n:e.length;s--;)if(e[s]===t)return s;return-1},S.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),s=0,r=new Array(i);i>s;)r[s++]=e,e+=n;return r},S.bind=function(e,t){if(e.bind===k&&k)return k.apply(e,a.call(arguments,1));var n=a.call(arguments,2);return function(){return e.apply(t,n.concat(a.call(arguments)))}},S.partial=function(e){var t=a.call(arguments,1);return function(){return e.apply(this,t.concat(a.call(arguments)))}},S.bindAll=function(e){var t=a.call(arguments,1);return 0===t.length&&(t=S.functions(e)),x(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var n={};return t||(t=S.identity),function(){var i=t.apply(this,arguments);return S.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},S.delay=function(e,t){var n=a.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(a.call(arguments,1)))},S.throttle=function(e,t){var n,i,s,r,o=0,a=function(){o=new Date,s=null,r=e.apply(n,i)};return function(){var l=new Date,c=t-(l-o);return n=this,i=arguments,0>=c?(clearTimeout(s),s=null,o=l,r=e.apply(n,i)):s||(s=setTimeout(a,c)),r}},S.debounce=function(e,t,n){var i,s;return function(){var r=this,o=arguments,a=function(){i=null,n||(s=e.apply(r,o))},l=n&&!i;return clearTimeout(i),i=setTimeout(a,t),l&&(s=e.apply(r,o)),s}},S.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},S.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},S.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},S.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},S.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)S.has(e,n)&&(t[t.length]=n);return t},S.values=function(e){var t=[];for(var n in e)S.has(e,n)&&t.push(e[n]);return t},S.pairs=function(e){var t=[];for(var n in e)S.has(e,n)&&t.push([n,e[n]]);return t},S.invert=function(e){var t={};for(var n in e)S.has(e,n)&&(t[e[n]]=n);return t},S.functions=S.methods=function(e){var t=[];for(var n in e)S.isFunction(e[n])&&t.push(n);return t.sort()},S.extend=function(e){return x(a.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},S.pick=function(e){var t={},n=l.apply(i,a.call(arguments,1));return x(n,function(n){n in e&&(t[n]=e[n])}),t},S.omit=function(e){var t={},n=l.apply(i,a.call(arguments,1));for(var s in e)S.contains(n,s)||(t[s]=e[s]);return t},S.defaults=function(e){return x(a.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e};var I=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof S&&(e=e._wrapped),t instanceof S&&(t=t._wrapped);var s=c.call(e);if(s!=c.call(t))return!1;switch(s){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var r=n.length;r--;)if(n[r]==e)return i[r]==t;n.push(e),i.push(t);var o=0,a=!0;if("[object Array]"==s){if(o=e.length,a=o==t.length)for(;o--&&(a=I(e[o],t[o],n,i)););}else{var l=e.constructor,h=t.constructor;if(l!==h&&!(S.isFunction(l)&&l instanceof l&&S.isFunction(h)&&h instanceof h))return!1;for(var u in e)if(S.has(e,u)&&(o++,!(a=S.has(t,u)&&I(e[u],t[u],n,i))))break;if(a){for(u in t)if(S.has(t,u)&&!o--)break;a=!o}}return n.pop(),i.pop(),a};S.isEqual=function(e,t){return I(e,t,[],[])},S.isEmpty=function(e){if(null==e)return!0;if(S.isArray(e)||S.isString(e))return 0===e.length;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!(!e||1!==e.nodeType)},S.isArray=_||function(e){return"[object Array]"==c.call(e)},S.isObject=function(e){return e===Object(e)},x(["Arguments","Function","String","Number","Date","RegExp"],function(e){S["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),S.isArguments(arguments)||(S.isArguments=function(e){return!(!e||!S.has(e,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(e){return"function"==typeof e}),S.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},S.isNaN=function(e){return S.isNumber(e)&&e!=+e},S.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},S.isNull=function(e){return null===e},S.isUndefined=function(e){return void 0===e},S.has=function(e,t){return h.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,n){for(var i=Array(e),s=0;e>s;s++)i[s]=t.call(n,s);return i},S.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};A.unescape=S.invert(A.escape);var M={escape:new RegExp("["+S.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys(A.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(e){S[e]=function(t){return null==t?"":(""+t).replace(M[e],function(t){return A[e][t]})}}),S.result=function(e,t){if(null==e)return null;var n=e[t];return S.isFunction(n)?n.call(e):n},S.mixin=function(e){x(S.functions(e),function(t){var n=S[t]=e[t];S.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),D.call(this,n.apply(S,e))}})};var O=0;S.uniqueId=function(e){var t=++O+"";return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(e,t,n){var i;n=S.defaults({},n,S.templateSettings);var s=new RegExp([(n.escape||L).source,(n.interpolate||L).source,(n.evaluate||L).source].join("|")+"|$","g"),r=0,o="__p+='";e.replace(s,function(t,n,i,s,a){return o+=e.slice(r,a).replace(R,function(e){return"\\"+$[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(o+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),s&&(o+="';\n"+s+"\n__p+='"),r=a+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(n.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(t)return i(t,S);var l=function(e){return i.call(this,e,S)};return l.source="function("+(n.variable||"obj")+"){\n"+o+"}",l},S.chain=function(e){return S(e).chain()};var D=function(e){return this._chain?S(e).chain():e};S.mixin(S),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];S.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],D.call(this,n)}}),x(["concat","join","slice"],function(e){var t=i[e];S.prototype[e]=function(){return D.call(this,t.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return S})}.call(this),function(e,t){"undefined"!=typeof exports?t(e,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(n,i,s){e.Backbone=t(e,s,n,i)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){var s=e.Backbone,r=[],o=r.push,a=r.slice,l=r.splice;t.VERSION="1.0.0",t.$=i,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var c=t.Events={on:function(e,t,n){if(!u(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!u(this,"once",e,[t,i])||!t)return this;var s=this,r=n.once(function(){s.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,i)},off:function(e,t,i){var s,r,o,a,l,c,h,d;if(!this._events||!u(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(a=e?[e]:n.keys(this._events),l=0,c=a.length;c>l;l++)if(e=a[l],o=this._events[e]){if(this._events[e]=s=[],t||i)for(h=0,d=o.length;d>h;h++)r=o[h],(t&&t!==r.callback&&t!==r.callback._callback||i&&i!==r.context)&&s.push(r);s.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!u(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&d(n,t),i&&d(i,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var s=!t&&!n;"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e);for(var r in i)i[r].off(t,n,this),s&&delete this._listeners[r];return this}},h=/\s+/,u=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var s in n)e[t].apply(e,[s,n[s]].concat(i));return!1}if(h.test(n)){for(var r=n.split(h),o=0,a=r.length;a>o;o++)e[t].apply(e,[r[o]].concat(i));return!1}return!0},d=function(e,t){var n,i=-1,s=e.length,r=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++i<s;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<s;)(n=e[i]).callback.call(n.ctx,r);return;case 2:for(;++i<s;)(n=e[i]).callback.call(n.ctx,r,o);return;case 3:for(;++i<s;)(n=e[i]).callback.call(n.ctx,r,o,a);return;default:for(;++i<s;)(n=e[i]).callback.apply(n.ctx,t)}},p={listenTo:"on",listenToOnce:"once"};n.each(p,function(e,t){c[t]=function(t,i,s){var r=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=n.uniqueId("l"));return r[o]=t,"object"==typeof i&&(s=this),t[e](i,s,this),this}}),c.bind=c.on,c.unbind=c.off,n.extend(t,c);var f=t.Model=function(e,t){var i,s=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},n.extend(this,n.pick(t,m)),t.parse&&(s=this.parse(s,t)||{}),(i=n.result(this,"defaults"))&&(s=n.defaults({},s,i)),this.set(s,t),this.changed={},this.initialize.apply(this,arguments)},m=["url","urlRoot","collection"];n.extend(f.prototype,c,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var s,r,o,a,l,c,h,u;if(null==e)return this;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;o=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),u=this.attributes,h=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(s in r)t=r[s],n.isEqual(u[s],t)||a.push(s),n.isEqual(h[s],t)?delete this.changed[s]:this.changed[s]=t,o?delete u[s]:u[s]=t;if(!l){a.length&&(this._pending=!0);for(var d=0,p=a.length;p>d;d++)this.trigger("change:"+a[d],this,u[a[d]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,i=!1,s=this._changing?this._previousAttributes:this.attributes;for(var r in e)n.isEqual(s[r],t=e[r])||((i||(i={}))[r]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),t.trigger("sync",t,n,e),void 0):!1},H(this,e),this.sync("read",this,e)},save:function(e,t,i){var s,r,o,a=this.attributes;if(null==e||"object"==typeof e?(s=e,i=t):(s={})[e]=t,!(!s||i&&i.wait||this.set(s,i)))return!1;if(i=n.extend({validate:!0},i),!this._validate(s,i))return!1;s&&i.wait&&(this.attributes=n.extend({},a,s)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=n.extend(s||{},t)),n.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),l.trigger("sync",l,e,i),void 0)},H(this,i),r=this.isNew()?"create":i.patch?"patch":"update","patch"===r&&(i.attrs=s),o=this.sync(r,this,i),s&&i.wait&&(this.attributes=a),o},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,s=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&s(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;H(this,e);var r=this.sync("delete",this,e);return e.wait||s(),r},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||D();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t||{},{validationError:i})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];n.each(g,function(e){f.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var v=t.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},b={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};n.extend(v.prototype,c,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.defaults(t||{},y))},remove:function(e,t){e=n.isArray(e)?e.slice():[e],t||(t={});var i,s,r,o;for(i=0,s=e.length;s>i;i++)o=this.get(e[i]),o&&(delete this._byId[o.id],delete this._byId[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,t.silent||(t.index=r,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){t=n.defaults(t||{},b),t.parse&&(e=this.parse(e,t)),n.isArray(e)||(e=e?[e]:[]);var i,s,r,a,c,h=t.at,u=this.comparator&&null==h&&t.sort!==!1,d=n.isString(this.comparator)?this.comparator:null,p=[],f=[],m={};for(i=0,s=e.length;s>i;i++)(r=this._prepareModel(e[i],t))&&((a=this.get(r))?(t.remove&&(m[a.cid]=!0),t.merge&&(a.set(r.attributes,t),u&&!c&&a.hasChanged(d)&&(c=!0))):t.add&&(p.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)));if(t.remove){for(i=0,s=this.length;s>i;++i)m[(r=this.models[i]).cid]||f.push(r);f.length&&this.remove(f,t)}if(p.length&&(u&&(c=!0),this.length+=p.length,null!=h?l.apply(this.models,[h,0].concat(p)):o.apply(this.models,p)),c&&this.sort({silent:!0}),t.silent)return this;for(i=0,s=p.length;s>i;i++)(r=p[i]).trigger("add",r,this,t);return c&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var i=0,s=this.models.length;s>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,n.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,n.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,i){t||(t=this.comparator);var s=n.isFunction(t)?t:function(e){return e.get(t)};return n.sortedIndex(this.models,e,s,i)},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var s=e.reset?"reset":"set";i[s](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},H(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,s=t.success;return t.success=function(n){t.wait&&i.add(e,t),s&&s(e,n,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof f)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var _=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];n.each(_,function(e){v.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy"];n.each(w,function(e){v.prototype[e]=function(t,i){var s=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,s,i)}});var k=t.View=function(e){this.cid=n.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(k.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var s=t.match(S),r=s[1],o=s[2];i=n.bind(i,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,i):this.$el.on(r,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=n.extend({},n.result(this,"options"),e)),n.extend(this,n.pick(e,x)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,s){var r=C[e];n.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:r,dataType:"json"};if(s.url||(o.url=n.result(i,"url")||D()),null!=s.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(s.attrs||i.toJSON(s))),s.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),s.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",s.emulateJSON&&(o.data._method=r);var a=s.beforeSend;s.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===o.type||s.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=s.xhr=t.ajax(n.extend(o,s));return i.trigger("request",i,l,s),l};var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var P=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,N=/\*\w+/g,I=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(P.prototype,c,{initialize:function(){},route:function(e,i,s){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(s=i,i=""),s||(s=this[i]);var r=this;return t.history.route(e,function(n){var o=r._extractParameters(e,n);s&&s.apply(r,o),r.trigger.apply(r,["route:"+i].concat(o)),r.trigger("route",i,o),t.history.trigger("route",r,i,o)}),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(I,"\\$&").replace(T,"(?:$1)?").replace(E,function(e,t){return t?e:"([^/]+)"}).replace(N,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e){return e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,O=/^\/+|\/+$/g,L=/msie [\w.]+/,$=/\/$/;A.started=!1,n.extend(A.prototype,c,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace($,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=n.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),s=document.documentMode,r=L.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);this.root=("/"+this.root+"/").replace(O,"/"),r&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())
},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),A.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(e){var t=this.fragment=this.getFragment(e),i=n.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return i},navigate:function(e,t){if(!A.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new A;var R=function(e,t){var i,s=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},n.extend(i,s,t);var r=function(){this.constructor=i};return r.prototype=s.prototype,i.prototype=new r,e&&n.extend(i.prototype,e),i.__super__=s.prototype,i};f.extend=v.extend=P.extend=k.extend=A.extend=R;var D=function(){throw new Error('A "url" property or function must be specified')},H=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),define("core/config",["underscore"],function(){var e,t;return t="core/config",e={appName:"TidePool",debug:!1,isDev:!1,googleAnalyticsKey:"UA-41751970-1",kissKey:"2cefe1d04ad90881f66a8540fcecf6db54de1fe4",apiServer:"",appSecret:"3e4da2177beee0d8ec458480526b3716047b3ff0df3362262183f6841253a706",appId:"3e372449d494eb6dc7d74cd3da1d6eedd50c7d98f3dedf1caf02960a9a260fb1",fbId:"470347313045508"},window.apiServerUrl=e.apiServer,e}),define("core/analytics/google",[],function(){var e;return e=function(e,t){return function(e,t,n,i,s,r,o){return e.GoogleAnalyticsObject=s,e[s]=e[s]||function(){return(e[s].q=e[s].q||[]).push(arguments)},e[s].l=1*new Date,r=t.createElement(n),o=t.getElementsByTagName(n)[0],r.async=1,r.src=i,o.parentNode.insertBefore(r,o)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),t?ga("create",e,"tide-dev.herokuapp.com"):ga("create",e)},e.prototype={trackPage:function(e){return ga("send","pageview",{location:document.URL,page:"/"+e})},trackEvent:function(e,t,n,i){return ga("send","event",{eventCategory:e,eventAction:t,eventLabel:n,eventValue:i})},setFirstVisit:function(){var e,t,n,i;return t=new Date,i=t.getFullYear(),n=t.getMonth()+1,e=t.getDate(),1===n.length&&(n="0"+n),1===e.length&&(e="0"+e),ga("set","dimension1",i+n+e)},setGamesPlayed:function(e){return ga("set","metric1",e)}},e}),define("core/analytics/kiss",[],function(){var e;return e=function(e){return window._kms=function(e){return setTimeout(function(){var t,n,i;return t=document,n=t.getElementsByTagName("script")[0],i=t.createElement("script"),i.type="text/javascript",i.async=!0,i.src=e,n.parentNode.insertBefore(i,n)},1)},window._kmq=window._kmq||[],window._kmk=window._kmk||e,window._kms("//i.kissmetrics.com/i.js"),window._kms("//doug1izaerwt3.cloudfront.net/"+window._kmk+".1.js"),this},e.prototype={track:function(e,t){return window._kmq.push(["record",e,t])}},e}),define("core/analytics/uservoice",[],function(){var e;return e={},e.start=function(){var e,t;return window.UserVoice=window.UserVoice||[],window.UserVoice.push(["showTab","classic_widget",{mode:"full",primary_color:"#eae8e5",link_color:"#188ff4",default_mode:"feedback",forum_id:212724,tab_label:"Feedback",tab_color:"#e43e45",tab_position:"bottom-left",tab_inverted:!1}]),t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src="//widget.uservoice.com/heZnlXOU7JHatuDLyXHqw.js",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)},e}),define("core/analytics",["./analytics/google","./analytics/kiss","./analytics/uservoice"],function(e,t,n){var i,s;return s="core/analytics",i=function(i){var s=this;return i.googleAnalyticsKey&&(this.google=new e(i.googleAnalyticsKey,i.isDev)),i.kissKey&&(this.kiss=new t(i.kissKey)),n.start(),window.onerror=function(e,t,n){return s.trackKeyMetric(s.CATEGORIES.jsErr,e,{url:n}),!1},this},i.prototype={CATEGORIES:{viewPage:"ViewPage",viewLightbox:"ViewLightbox",jsErr:"JS Error",serverError:"Server Error"},trackPage:function(e){var t;if(null!=e)return null!=(t=this.google)?t.trackPage(e):void 0},track:function(e,t){var n;if(null!=e&&null!=t)return null!=(n=this.google)?n.trackEvent(e,t):void 0},trackKeyMetric:function(e,t,n){var i,s;if(null!=e&&null!=t)return null!=(i=this.google)&&i.trackEvent(e,t),null!=(s=this.kiss)?s.track(""+e+":"+t,n):void 0},trackPerformance:function(e){var t,n,i,s,r;return null!=("undefined"!=typeof performance&&null!==performance?performance.timing:void 0)?(t={latency:performance.timing.responseEnd-performance.timing.fetchStart,pageLoad:performance.timing.loadEventEnd-performance.timing.responseEnd,totalLoadTime:performance.timing.loadEventEnd-performance.timing.navigationStart,jsLoadTime:e-performance.timing.navigationStart,entryPage:window.location.protocol+"//"+window.location.hostname+window.location.hash},null!=(n=this.kiss)&&n.track("performance",t),null!=(i=this.google)&&i.trackEvent("performance","log","latency",t.latency),null!=(s=this.google)&&s.trackEvent("performance","log","pageLoad",t.pageLoad),null!=(r=this.google)?r.trackEvent("performance","log","jsLoadTime",t.jsLoadTime):void 0):void 0}},i}),function(){var e={};!function(e){e.VERSION="1.0.rc.1",e.helpers={},e.partials={},e.registerHelper=function(e,t,n){n&&(t.not=n),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return void 0;throw new Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,n="[object Function]";e.registerHelper("blockHelperMissing",function(i,s){var r=s.inverse||function(){},o=s.fn,a=t.call(i);return a===n&&(i=i.call(this)),i===!0?o(this):i===!1||null==i?r(this):"[object Array]"===a?i.length>0?e.helpers.each(i,s):r(this):o(i)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.registerHelper("each",function(t,n){var i,s=n.fn,r=n.inverse,o="";if(n.data&&(i=e.createFrame(n.data)),t&&t.length>0)for(var a=0,l=t.length;l>a;a++)i&&(i.index=a),o+=s(t[a],{data:i});else o=r(this);return o}),e.registerHelper("if",function(i,s){var r=t.call(i);return r===n&&(i=i.call(this)),!i||e.Utils.isEmpty(i)?s.inverse(this):s.fn(this)}),e.registerHelper("unless",function(t,n){var i=n.fn,s=n.inverse;return n.fn=s,n.inverse=i,e.helpers["if"].call(this,t,n)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t){e.log(t)})}(e);var t=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,DATA:27,param:28,STRING:29,INTEGER:30,BOOLEAN:31,hashSegments:32,hashSegment:33,ID:34,EQUALS:35,pathSegments:36,SEP:37,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",27:"DATA",29:"STRING",30:"INTEGER",31:"BOOLEAN",34:"ID",35:"EQUALS",37:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[17,1],[25,2],[25,1],[28,1],[28,1],[28,1],[28,1],[28,1],[26,1],[32,2],[32,1],[33,3],[33,3],[33,3],[33,3],[33,3],[21,1],[36,3],[36,1]],performAction:function(e,t,n,i,s,r){var o=r.length-1;switch(s){case 1:return r[o-1];case 2:this.$=new i.ProgramNode(r[o-2],r[o]);break;case 3:this.$=new i.ProgramNode(r[o]);break;case 4:this.$=new i.ProgramNode([]);break;case 5:this.$=[r[o]];break;case 6:r[o-1].push(r[o]),this.$=r[o-1];break;case 7:this.$=new i.BlockNode(r[o-2],r[o-1].inverse,r[o-1],r[o]);break;case 8:this.$=new i.BlockNode(r[o-2],r[o-1],r[o-1].inverse,r[o]);break;case 9:this.$=r[o];break;case 10:this.$=r[o];break;case 11:this.$=new i.ContentNode(r[o]);break;case 12:this.$=new i.CommentNode(r[o]);break;case 13:this.$=new i.MustacheNode(r[o-1][0],r[o-1][1]);break;case 14:this.$=new i.MustacheNode(r[o-1][0],r[o-1][1]);break;case 15:this.$=r[o-1];break;case 16:this.$=new i.MustacheNode(r[o-1][0],r[o-1][1]);break;case 17:this.$=new i.MustacheNode(r[o-1][0],r[o-1][1],!0);break;case 18:this.$=new i.PartialNode(r[o-1]);break;case 19:this.$=new i.PartialNode(r[o-2],r[o-1]);break;case 20:break;case 21:this.$=[[r[o-2]].concat(r[o-1]),r[o]];break;case 22:this.$=[[r[o-1]].concat(r[o]),null];break;case 23:this.$=[[r[o-1]],r[o]];break;case 24:this.$=[[r[o]],null];break;case 25:this.$=[[new i.DataNode(r[o])],null];break;case 26:r[o-1].push(r[o]),this.$=r[o-1];break;case 27:this.$=[r[o]];break;case 28:this.$=r[o];break;case 29:this.$=new i.StringNode(r[o]);break;case 30:this.$=new i.IntegerNode(r[o]);break;case 31:this.$=new i.BooleanNode(r[o]);break;case 32:this.$=new i.DataNode(r[o]);break;case 33:this.$=new i.HashNode(r[o]);break;case 34:r[o-1].push(r[o]),this.$=r[o-1];break;case 35:this.$=[r[o]];break;case 36:this.$=[r[o-2],r[o]];break;case 37:this.$=[r[o-2],new i.StringNode(r[o])];break;case 38:this.$=[r[o-2],new i.IntegerNode(r[o])];break;case 39:this.$=[r[o-2],new i.BooleanNode(r[o])];break;case 40:this.$=[r[o-2],new i.DataNode(r[o])];break;case 41:this.$=new i.IdNode(r[o]);break;case 42:r[o-2].push(r[o]),this.$=r[o-2];break;case 43:this.$=[r[o]]}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,27:[1,24],34:[1,26],36:25},{17:27,21:23,27:[1,24],34:[1,26],36:25},{17:28,21:23,27:[1,24],34:[1,26],36:25},{17:29,21:23,27:[1,24],34:[1,26],36:25},{21:30,34:[1,26],36:25},{1:[2,1]},{6:31,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,32],21:23,27:[1,24],34:[1,26],36:25},{10:33,20:[1,34]},{10:35,20:[1,34]},{18:[1,36]},{18:[2,24],21:41,25:37,26:38,27:[1,45],28:39,29:[1,42],30:[1,43],31:[1,44],32:40,33:46,34:[1,47],36:25},{18:[2,25]},{18:[2,41],27:[2,41],29:[2,41],30:[2,41],31:[2,41],34:[2,41],37:[1,48]},{18:[2,43],27:[2,43],29:[2,43],30:[2,43],31:[2,43],34:[2,43],37:[2,43]},{18:[1,49]},{18:[1,50]},{18:[1,51]},{18:[1,52],21:53,34:[1,26],36:25},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:54,34:[1,26],36:25},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:41,26:55,27:[1,45],28:56,29:[1,42],30:[1,43],31:[1,44],32:40,33:46,34:[1,47],36:25},{18:[2,23]},{18:[2,27],27:[2,27],29:[2,27],30:[2,27],31:[2,27],34:[2,27]},{18:[2,33],33:57,34:[1,58]},{18:[2,28],27:[2,28],29:[2,28],30:[2,28],31:[2,28],34:[2,28]},{18:[2,29],27:[2,29],29:[2,29],30:[2,29],31:[2,29],34:[2,29]},{18:[2,30],27:[2,30],29:[2,30],30:[2,30],31:[2,30],34:[2,30]},{18:[2,31],27:[2,31],29:[2,31],30:[2,31],31:[2,31],34:[2,31]},{18:[2,32],27:[2,32],29:[2,32],30:[2,32],31:[2,32],34:[2,32]},{18:[2,35],34:[2,35]},{18:[2,43],27:[2,43],29:[2,43],30:[2,43],31:[2,43],34:[2,43],35:[1,59],37:[2,43]},{34:[1,60]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,61]},{18:[1,62]},{18:[2,21]},{18:[2,26],27:[2,26],29:[2,26],30:[2,26],31:[2,26],34:[2,26]},{18:[2,34],34:[2,34]},{35:[1,59]},{21:63,27:[1,67],29:[1,64],30:[1,65],31:[1,66],34:[1,26],36:25},{18:[2,42],27:[2,42],29:[2,42],30:[2,42],31:[2,42],34:[2,42],37:[2,42]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,36],34:[2,36]},{18:[2,37],34:[2,37]},{18:[2,38],34:[2,38]},{18:[2,39],34:[2,39]},{18:[2,40],34:[2,40]}],defaultActions:{16:[2,1],24:[2,25],38:[2,23],55:[2,21]},parseError:function(e){throw new Error(e)},parse:function(e){function t(){var e;return e=n.lexer.lex()||1,"number"!=typeof e&&(e=n.symbols_[e]||e),e}var n=this,i=[0],s=[null],r=[],o=this.table,a="",l=0,c=0,h=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;r.push(u);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,b,y,_,w,k={};;){if(m=i[i.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=t()),g=o[m]&&o[m][p]),"undefined"==typeof g||!g.length||!g[0]){var S="";if(!h){w=[];for(b in o[m])this.terminals_[b]&&b>2&&w.push("'"+this.terminals_[b]+"'");S=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(S,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:u,expected:w})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:i.push(p),s.push(this.lexer.yytext),r.push(this.lexer.yylloc),i.push(g[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,u=this.lexer.yylloc,h>0&&h--);break;case 2:if(y=this.productions_[g[1]][1],k.$=s[s.length-y],k._$={first_line:r[r.length-(y||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(y||1)].first_column,last_column:r[r.length-1].last_column},d&&(k._$.range=[r[r.length-(y||1)].range[0],r[r.length-1].range[1]]),v=this.performAction.call(k,a,c,l,this.yy,g[1],s,r),"undefined"!=typeof v)return v;y&&(i=i.slice(0,2*-1*y),s=s.slice(0,-1*y),r=r.slice(0,-1*y)),i.push(this.productions_[g[1]][0]),s.push(k.$),r.push(k._$),_=o[i[i.length-2]][i[i.length-1]],i.push(_);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,i,s;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),o=0;o<r.length&&(n=this._input.match(this.rules[r[o]]),!n||t&&!(n[0].length>t[0].length)||(t=n,i=o,this.options.flex));o++);return t?(s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,r[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,n,i){switch(n){case 0:if("\\"!==t.yytext.slice(-1)&&this.begin("mu"),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1),this.begin("emu")),t.yytext)return 14;break;case 1:return 14;case 2:return"\\"!==t.yytext.slice(-1)&&this.popState(),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1)),14;case 3:return 24;case 4:return 16;case 5:return 20;case 6:return 19;case 7:return 19;case 8:return 23;case 9:return 23;case 10:return t.yytext=t.yytext.substr(3,t.yyleng-5),this.popState(),15;case 11:return 22;case 12:return 35;case 13:return 34;case 14:return 34;case 15:return 37;case 16:break;case 17:return this.popState(),18;case 18:return this.popState(),18;case 19:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\"/g,'"'),29;case 20:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\"/g,'"'),29;case 21:return t.yytext=t.yytext.substr(1),27;case 22:return 31;case 23:return 31;case 24:return 30;case 25:return 34;case 26:return t.yytext=t.yytext.substr(1,t.yyleng-2),34;case 27:return"INVALID";case 28:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[} ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@[a-zA-Z]+)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:[0-9]+(?=[}\s]))/,/^(?:[a-zA-Z0-9_$-]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],inclusive:!1},emu:{rules:[2],inclusive:!1},INITIAL:{rules:[0,1,28],inclusive:!0}},e}();return t.lexer=n,e.prototype=t,t.Parser=e,new e}();e.Parser=t,e.parse=function(t){return e.Parser.yy=e.AST,e.Parser.parse(t)},e.print=function(t){return(new e.PrintVisitor).accept(t)},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(){}},e.log=function(t,n){e.logger.log(t,n)},function(){e.AST={},e.AST.ProgramNode=function(t,n){this.type="program",this.statements=t,n&&(this.inverse=new e.AST.ProgramNode(n))},e.AST.MustacheNode=function(e,t,n){this.type="mustache",this.escaped=!n,this.hash=t;var i=this.id=e[0],s=this.params=e.slice(1),r=this.eligibleHelper=i.isSimple;this.isHelper=r&&(s.length||t)},e.AST.PartialNode=function(e,t){this.type="partial",this.id=e,this.context=t};var t=function(t,n){if(t.original!==n.original)throw new e.Exception(t.original+" doesn't match "+n.original)};e.AST.BlockNode=function(e,n,i,s){t(e.id,s),this.type="block",this.mustache=e,this.program=n,this.inverse=i,this.inverse&&!this.program&&(this.isInverse=!0)},e.AST.ContentNode=function(e){this.type="content",this.string=e},e.AST.HashNode=function(e){this.type="hash",this.pairs=e},e.AST.IdNode=function(e){this.type="ID",this.original=e.join(".");for(var t=[],n=0,i=0,s=e.length;s>i;i++){var r=e[i];".."===r?n++:"."===r||"this"===r?this.isScoped=!0:t.push(r)}this.parts=t,this.string=t.join("."),this.depth=n,this.isSimple=1===e.length&&!this.isScoped&&0===n},e.AST.DataNode=function(e){this.type="DATA",this.id=e},e.AST.StringNode=function(e){this.type="STRING",this.string=e},e.AST.IntegerNode=function(e){this.type="INTEGER",this.integer=e},e.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e},e.AST.CommentNode=function(e){this.type="comment",this.comment=e}}(),e.Exception=function(){var e=Error.prototype.constructor.apply(this,arguments);for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.message=e.message},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()},function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=/[&<>"'`]/g,i=/[&<>"'`]/,s=function(e){return t[e]||"&amp;"};e.Utils={escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":i.test(t)?t.replace(n,s):t},isEmpty:function(e){return"undefined"==typeof e?!0:null===e?!0:e===!1?!0:"[object Array]"===Object.prototype.toString.call(e)&&0===e.length?!0:!1}}}(),e.Compiler=function(){},e.JavaScriptCompiler=function(){},function(t,n){t.prototype={compiler:t,disassemble:function(){for(var e,t,n,i=this.opcodes,s=[],r=0,o=i.length;o>r;r++)if(e=i[r],"DECLARE"===e.opcode)s.push("DECLARE "+e.name+"="+e.value);else{t=[];for(var a=0;a<e.args.length;a++)n=e.args[a],"string"==typeof n&&(n='"'+n.replace("\n","\\n")+'"'),t.push(n);s.push(e.opcode+" "+t.join(" "))}return s.join("\n")},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var n=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},n)for(var i in n)this.options.knownHelpers[i]=n[i];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t,n=e.statements;this.opcodes=[];for(var i=0,s=n.length;s>i;i++)t=n[i],this[t.type](t);return this.isSimple=1===s,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t,n=(new this.compiler).compile(e,this.options),i=this.guid++;this.usePartial=this.usePartial||n.usePartial,this.children[i]=n;for(var s=0,r=n.depths.list.length;r>s;s++)t=n.depths.list[s],2>t||this.addDepth(t-1);return i},block:function(e){var t=e.mustache,n=e.program,i=e.inverse;n&&(n=this.compileProgram(n)),i&&(i=this.compileProgram(i));var s=this.classifyMustache(t);"helper"===s?this.helperMustache(t,n,i):"simple"===s?(this.simpleMustache(t),this.opcode("pushProgram",n),this.opcode("pushProgram",i),this.opcode("pushLiteral","{}"),this.opcode("blockValue")):(this.ambiguousMustache(t,n,i),this.opcode("pushProgram",n),this.opcode("pushProgram",i),this.opcode("pushLiteral","{}"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t,n,i=e.pairs;this.opcode("push","{}");for(var s=0,r=i.length;r>s;s++)t=i[s],n=t[1],this.accept(n),this.opcode("assignToHash",t[0])},partial:function(e){var t=e.id;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.original),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,n=this.classifyMustache(e);"simple"===n?this.simpleMustache(e):"helper"===n?this.helperMustache(e):this.ambiguousMustache(e),e.escaped&&!t.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(e,t,n){var i=e.id,s=i.parts[0];this.opcode("getContext",i.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",s)},simpleMustache:function(e){var t=e.id;"DATA"===t.type?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,n){var i=this.setupFullMustacheParams(e,t,n),s=e.id.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",i.length,s);else{if(this.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+s);this.opcode("invokeHelper",i.length,s)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var n=1,i=e.parts.length;i>n;n++)this.opcode("lookup",e.parts[n])},DATA:function(e){this.options.data=!0,this.opcode("lookupData",e.id)},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");0!==e&&(this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e)))},classifyMustache:function(e){var t=e.isHelper,n=e.eligibleHelper,i=this.options;if(n&&!t){var s=e.id.parts[0];i.knownHelpers[s]?t=!0:i.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){for(var t,n=e.length;n--;)t=e[n],this.options.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.string)):this[t.type](t)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("pushLiteral","{}"),t},setupFullMustacheParams:function(e,t,n){var i=e.params;return this.pushParams(i),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("pushLiteral","{}"),i}};var i=function(e){this.value=e};n.prototype={nameLookup:function(e,t){return/^[0-9]+$/.test(t)?e+"["+t+"]":n.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":"buffer += "+e+";"},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,n,i,s){this.environment=t,this.options=n||{},e.log(e.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!i,this.context=i||{programs:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.compileChildren(t,n);var r,o=t.opcodes;for(this.i=0,a=o.length;this.i<a;this.i++)r=o[this.i],"DECLARE"===r.opcode?this[r.name]=r.value:this[r.opcode].apply(this,r.args);return this.createFunctionContext(s)},nextOpcode:function(){var e=this.environment.opcodes;return e[this.i+1],e[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var e=[];if(this.isChild)e.push("");else{var t=this.namespace,n="helpers = helpers || "+t+".helpers;";this.environment.usePartial&&(n=n+" partials = partials || "+t+".partials;"),this.options.data&&(n+=" data = data || {};"),e.push(n)}this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(t){var n=this.stackVars.concat(this.registers.list);if(n.length>0&&(this.source[1]=this.source[1]+", "+n.join(", ")),!this.isChild)for(var i in this.context.aliases)this.source[1]=this.source[1]+", "+i+"="+this.context.aliases[i];this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var s=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],r=0,o=this.environment.depths.list.length;o>r;r++)s.push("depth"+this.environment.depths.list[r]);if(t)return s.push(this.source.join("\n  ")),Function.apply(this,s);var a="function "+(this.name||"")+"("+s.join(",")+") {\n  "+this.source.join("\n  ")+"}";return e.log(e.logger.DEBUG,a+"\n\n"),a},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),t+" = blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),this.source.push("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){var e=this.nextOpcode(),t="";this.context.aliases.escapeExpression="this.escapeExpression",e&&"appendContent"===e.opcode&&(t=" + "+this.quotedString(e.args[0]),this.eat(e)),this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+t))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.pushStack(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+"() : "+e
})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(e){this.pushStack(this.nameLookup("data",e,"data"))},pushStringParam:function(e){this.pushStackLiteral("depth"+this.lastContext),this.pushString(e)},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){this.pushStack(e)},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){null!=e?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var n=this.lastHelper=this.setupHelper(e,t);this.register("foundHelper",n.name),this.pushStack("foundHelper ? foundHelper.call("+n.callParams+") "+": helperMissing.call("+n.helperMissingParams+")")},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.pushStack(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var t=this.setupHelper(0,e),n=this.lastHelper=this.nameLookup("helpers",e,"helper");this.register("foundHelper",n);var i=this.nameLookup("depth"+this.lastContext,e,"context"),s=this.nextStack();this.source.push("if (foundHelper) { "+s+" = foundHelper.call("+t.callParams+"); }"),this.source.push("else { "+s+" = "+i+"; "+s+" = typeof "+s+" === functionType ? "+s+"() : "+s+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.pushStack("self.invokePartial("+t.join(", ")+");")},assignToHash:function(e){var t=this.popStack(),n=this.topStack();this.source.push(n+"['"+e+"'] = "+t+";")},compiler:n,compileChildren:function(e,t){for(var n,i,s=e.children,r=0,o=s.length;o>r;r++){n=s[r],i=new this.compiler,this.context.programs.push("");var a=this.context.programs.length;n.index=a,n.name="program"+a,this.context.programs[a]=i.compile(n,t,this.context)}},programExpression:function(e){if(this.context.aliases.self="this",null==e)return"self.noop";for(var t,n=this.environment.children[e],i=n.depths.list,s=[n.index,n.name,"data"],r=0,o=i.length;o>r;r++)t=i[r],1===t?s.push("depth0"):s.push("depth"+(t-1));return 0===i.length?"self.program("+s.join(", ")+")":(s.shift(),"self.programWithDepth("+s.join(", ")+")")},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.compileStack.push(new i(e)),e},pushStack:function(e){return this.source.push(this.incrStack()+" = "+e+";"),this.compileStack.push("stack"+this.stackSlot),"stack"+this.stackSlot},replaceStack:function(e){var t=e.call(this,this.topStack());return this.source.push(this.topStack()+" = "+t+";"),"stack"+this.stackSlot},nextStack:function(){var e=this.incrStack();return this.compileStack.push("stack"+this.stackSlot),e},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),"stack"+this.stackSlot},popStack:function(){var e=this.compileStack.pop();return e instanceof i?e.value:(this.stackSlot--,e)},topStack:function(){var e=this.compileStack[this.compileStack.length-1];return e instanceof i?e.value:e},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'},setupHelper:function(e,t){var n=[];this.setupParams(e,n);var i=this.nameLookup("helpers",t,"helper");return{params:n,name:i,callParams:["depth0"].concat(n).join(", "),helperMissingParams:["depth0",this.quotedString(t)].concat(n).join(", ")}},setupParams:function(e,t){var n,i,s,r=[],o=[];r.push("hash:"+this.popStack()),i=this.popStack(),s=this.popStack(),(s||i)&&(s||(this.context.aliases.self="this",s="self.noop"),i||(this.context.aliases.self="this",i="self.noop"),r.push("inverse:"+i),r.push("fn:"+s));for(var a=0;e>a;a++)n=this.popStack(),t.push(n),this.options.stringParams&&o.push(this.popStack());return this.options.stringParams&&r.push("contexts:["+o.join(",")+"]"),this.options.data&&r.push("data:data"),t.push("{"+r.join(",")+"}"),t.join(", ")}};for(var s="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),r=n.RESERVED_WORDS={},o=0,a=s.length;a>o;o++)r[s[o]]=!0;n.isValidJavaScriptVariableName=function(e){return!n.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1}}(e.Compiler,e.JavaScriptCompiler),e.precompile=function(t,n){n=n||{};var i=e.parse(t),s=(new e.Compiler).compile(i,n);return(new e.JavaScriptCompiler).compile(s,n)},e.compile=function(t,n){function i(){var i=e.parse(t),s=(new e.Compiler).compile(i,n),r=(new e.JavaScriptCompiler).compile(s,n,void 0,!0);return e.template(r)}n=n||{};var s;return function(e,t){return s||(s=i()),s.call(this,e,t)}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,i){var s=this.programs[t];return i?e.VM.program(n,i):s?s:s=this.programs[t]=e.VM.program(n)},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop};return function(i,s){return s=s||{},t.call(n,e,i,s.helpers,s.partials,s.data)}},programWithDepth:function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(i,s){return s=s||{},e.apply(this,[i,s.data||t].concat(n))}},program:function(e,t){return function(n,i){return i=i||{},e(n,i.data||t)}},noop:function(){return""},invokePartial:function(t,n,i,s,r,o){var a={helpers:s,partials:r,data:o};if(void 0===t)throw new e.Exception("The partial "+n+" could not be found");if(t instanceof Function)return t(i,a);if(e.compile)return r[n]=e.compile(t,{data:void 0!==o}),r[n](i,a);throw new e.Exception("The partial "+n+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template,define("Handlebars",[],function(){return e})}(),define("text",["module"],function(e){var t,n,i,s,r,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,h=c&&location.protocol&&location.protocol.replace(/\:/,""),u=c&&location.hostname,d=c&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(i){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,i,s=!1,r=e.indexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!o||r>1)?(t=e.substring(0,r),n=e.substring(r+1,e.length)):t=e,i=n||t,r=i.indexOf("!"),-1!==r&&(s="strip"===i.substring(r+1),i=i.substring(0,r),n?n=i:t=i),{moduleName:t,ext:n,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,s){var r,o,a,l=t.xdRegExp.exec(e);return l?(r=l[2],o=l[3],o=o.split(":"),a=o[1],o=o[0],!(r&&r!==n||o&&o.toLowerCase()!==i.toLowerCase()||(a||o)&&a!==s)):!0},finishLoad:function(e,n,i,s){i=n?t.strip(i):i,f.isBuild&&(p[e]=i),s(i)},load:function(e,n,i,s){if(s.isBuild&&!s.inlineText)return i(),void 0;f.isBuild=s.isBuild;var r=t.parseName(e),o=r.moduleName+(r.ext?"."+r.ext:""),a=n.toUrl(o),l=f.useXhr||t.useXhr;return 0===a.indexOf("empty:")?(i(),void 0):(!c||l(a,h,u,d)?t.get(a,function(n){t.finishLoad(e,r.strip,n,i)},function(e){i.error&&i.error(e)}):n([o],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,i)}),void 0)},write:function(e,n,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);i.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,i,s,r){var o=t.parseName(n),a=o.ext?"."+o.ext:"",l=o.moduleName+a,c=i.toUrl(o.moduleName+a)+".js";t.load(l,i,function(){var n=function(e){return s(c,e)};n.asModule=function(e,t){return s.asModule(e,c,t)},t.write(e,l,n,r)},r)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var s=n.readFileSync(e,"utf8");0===s.indexOf("")&&(s=s.substring(1)),t(s)}catch(r){i(r)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,i,s){var r,o=t.createXhr();if(o.open("GET",e,!0),s)for(r in s)s.hasOwnProperty(r)&&o.setRequestHeader(r.toLowerCase(),s[r]);f.onXhr&&f.onXhr(o,e),o.onreadystatechange=function(){var t,s;4===o.readyState&&(t=o.status,t>399&&600>t?(s=new Error(e+" HTTP status: "+t),s.xhr=o,i(s)):n(o.responseText),f.onXhrComplete&&f.onXhrComplete(o,e))},o.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,s="utf-8",r=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),s)),l="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(o),n.append(i);l=String(n.toString())}finally{a.close()}t(l)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,o,a,l={};r&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),n.init(a,1,0,!1),o=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),o.init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),l),o.close(),n.close(),t(l.value)}catch(c){throw new Error((a&&a.path||"")+": "+c)}}),t}),define("text!composite_views/perch.hbs",[],function(){return'{{#if title}}\n    <div class="modal-header">\n        {{#unless mustUseButton}}\n            <button type="button" class="close" data-dismiss="modal"></button>\n        {{/unless}}\n        <h2>{{{title}}}</h2>\n    </div>\n{{/if}}\n\n<div class="modal-body" id="PerchBody">\n    {{{content}}}\n\n    {{#if btn1Text}}\n        <button id="PerchBtn1" tabindex="1" class="btn {{btn1ClassName}}">{{btn1Text}}</button>\n    {{/if}}\n</div>'}),define("composite_views/perch",["jquery","backbone","Handlebars","text!./perch.hbs"],function(e,t,n,i){var s,r,o,a,l,c,h;return h="composite_views/perch",c="body",l="perch modal",a="#PerchBody",r=t.Model.extend({defaults:{title:"",content:"This is the default message.",className:null,onClose:function(){},btn1Text:"Ok",btn1ClassName:"btn-large btn-primary",btn1Callback:function(){},mustUseButton:!1}}),s=t.View.extend({tmpl:n.compile(i),tagName:"aside",className:"perch modal hide fade",events:{"click #PerchBtn1":"_onBtn1Click"},initialize:function(){return e(c).append(this.el)},render:function(){return this.$el.html(this.tmpl(this.model.attributes)),this},_onBtn1Click:function(){var e;return"function"==typeof(e=this.model.attributes).btn1Callback&&e.btn1Callback(),this.hide()},_onBtn2Click:function(){return console.log(""+h+"._onBtn2Click()")},_onModalHidden:function(){var e;return"function"==typeof(e=this.model.attributes).onClose&&e.onClose(),this._viewCleanup()},_showSimpleMsg:function(e){return this._showOptionsObject({msg:e})},_showBackboneView:function(e){return this._childView=e.content,e.content=null,e.title=e.title||null,this._showOptionsObject(e),this._addChildView()},_showOptionsObject:function(e){var t;return e.msg&&(e.content="<p>"+e.msg+"</p>"),this.model.set(e),this._bindDomEvents(),t=e.mustUseButton?"static":!0,this.$el.modal({backdrop:t})},_addChildView:function(){var t;return e(a).prepend(null!=(t=this._childView)?t.render().el:void 0)},_viewCleanup:function(){var e;return this.$el.off("hidden"),null!=this._childView?("function"==typeof(e=this._childView).close&&e.close(),this._childView.remove()):void 0},_bindDomEvents:function(){return this.$el.on("hidden",_.bind(this._onModalHidden,this))},_trackLightbox:function(e){var t;if(!e.supressTracking&&null!=this.options.app){if("string"==typeof e)t=e;else{if(!e.title)return null;t=e.title}return this.options.app.analytics.track(this.options.app.analytics.CATEGORIES.viewLightbox,t,"options",e)}},show:function(e){return this.model=new r,this.$el.prop("class",l),e.large||(e.huge?this.$el.addClass("huge"):this.$el.addClass("small")),null!=e.className&&this.$el.addClass(e.className),this.listenTo(this.model,"change",this.render),"string"==typeof e?this._showSimpleMsg(e):(null!=e?e.content:void 0)instanceof t.View?this._showBackboneView(e):this._showOptionsObject(e),this._trackLightbox(e),this},hide:function(){return this.$el.modal("hide")}}),o=new s,o.Klass=s,o}),function(e,t){"function"==typeof define&&define.amd&&define("syphon",["underscore","jquery","backbone"],t)}(this,function(e,t,n){return n.Syphon=function(e,t,n){var i={};i.ignoredTypes=["button","submit","reset","fieldset"],i.serialize=function(e,i){var o={},c=a(i),h=s(e,c);return n.each(h,function(e){var n=t(e),i=r(n),s=c.keyExtractors.get(i),a=s(n),h=c.inputReaders.get(i),u=h(n),d=c.keyAssignmentValidators.get(i);if(d(n,a,u)){var p=c.keySplitter(a);o=l(o,p,u)}}),o},i.deserialize=function(e,i,o){var l=a(o),h=s(e,l),u=c(l,i);n.each(h,function(e){var n=t(e),i=r(n),s=l.keyExtractors.get(i),o=s(n),a=l.inputWriters.get(i),c=u[o];a(n,c)})};var s=function(e,i){var s=o(e),a=s.elements;return a=n.reject(a,function(e){var s,o=r(e),a=i.keyExtractors.get(o),l=a(t(e)),c=n.include(i.ignoredTypes,o),h=n.include(i.include,l),u=n.include(i.exclude,l);return s=h?!1:i.include?!0:u||c})},r=function(e){var n,i=t(e),s=i[0].tagName,r=s;return"input"===s.toLowerCase()&&(n=i.attr("type"),r=n?n:"text"),r.toLowerCase()},o=function(e){return n.isUndefined(e.$el)&&"form"===e.tagName.toLowerCase()?e:e.$el.is("form")?e.el:e.$("form")[0]},a=function(e){var t=n.clone(e)||{};return t.ignoredTypes=n.clone(i.ignoredTypes),t.inputReaders=t.inputReaders||i.InputReaders,t.inputWriters=t.inputWriters||i.InputWriters,t.keyExtractors=t.keyExtractors||i.KeyExtractors,t.keySplitter=t.keySplitter||i.KeySplitter,t.keyJoiner=t.keyJoiner||i.KeyJoiner,t.keyAssignmentValidators=t.keyAssignmentValidators||i.KeyAssignmentValidators,t},l=function(e,t,i){if(!t)return e;var s=t.shift();return e[s]||(e[s]=n.isArray(s)?[]:{}),0===t.length&&(n.isArray(e[s])?e[s].push(i):e[s]=i),t.length>0&&l(e[s],t,i),e},c=function(e,t,i){var s={};return n.each(t,function(t,r){var o={};i&&(r=e.keyJoiner(i,r)),n.isArray(t)?o[r]=t:n.isObject(t)?o=c(e,t,r):o[r]=t,n.extend(s,o)}),s};return i}(n,t,e),n.Syphon.TypeRegistry=function(){this.registeredTypes={}},n.Syphon.TypeRegistry.extend=n.Model.extend,e.extend(n.Syphon.TypeRegistry.prototype,{get:function(e){var t=this.registeredTypes[e];return t||(t=this.registeredTypes["default"]),t},register:function(e,t){this.registeredTypes[e]=t},registerDefault:function(e){this.registeredTypes["default"]=e},unregister:function(e){this.registeredTypes[e]&&delete this.registeredTypes[e]}}),n.Syphon.KeyExtractorSet=n.Syphon.TypeRegistry.extend(),n.Syphon.KeyExtractors=new n.Syphon.KeyExtractorSet,n.Syphon.KeyExtractors.registerDefault(function(e){return e.prop("name")}),n.Syphon.InputReaderSet=n.Syphon.TypeRegistry.extend(),n.Syphon.InputReaders=new n.Syphon.InputReaderSet,n.Syphon.InputReaders.registerDefault(function(e){return e.val()}),n.Syphon.InputReaders.register("checkbox",function(e){var t=e.prop("checked");return t}),n.Syphon.InputWriterSet=n.Syphon.TypeRegistry.extend(),n.Syphon.InputWriters=new n.Syphon.InputWriterSet,n.Syphon.InputWriters.registerDefault(function(e,t){e.val(t)}),n.Syphon.InputWriters.register("checkbox",function(e,t){e.prop("checked",t)}),n.Syphon.InputWriters.register("radio",function(e,t){e.prop("checked",e.val()===t)}),n.Syphon.KeyAssignmentValidatorSet=n.Syphon.TypeRegistry.extend(),n.Syphon.KeyAssignmentValidators=new n.Syphon.KeyAssignmentValidatorSet,n.Syphon.KeyAssignmentValidators.registerDefault(function(){return!0}),n.Syphon.KeyAssignmentValidators.register("radio",function(e){return e.prop("checked")}),n.Syphon.KeySplitter=function(e){var t=e.match(/[^\[\]]+/g);return e.indexOf("[]")===e.length-2&&(lastKey=t.pop(),t.push([lastKey])),t},n.Syphon.KeyJoiner=function(e,t){return e+"["+t+"]"},n.Syphon}),define("text!forms/user/login.hbs",[],function(){return'\n<button class="btn btn-block btn-primary btn-large facebook" id="SignInFacebook">\n  <i class="icon-facebook icon-large"></i>\n  Sign in <span class="muted">with</span> Facebook\n</button>\n\n<div class="divider">\n    <b class="rule"></b>\n    <p>Or</p>\n    <b class="rule"></b>\n</div>\n\n\n\n<form id="SigninForm">\n    <h3>\n        Use Your Email\n        <div class="btn-group btn-rocker" data-toggle="buttons-radio">\n            <button id="ActionSignIn" class="btn active" value="signIn" type="button">Sign In</button>\n            <button id="ActionRegister" class="btn" value="register" type="button">Register</button>\n            <input id="LoginType" type="hidden" name="loginType" value="signIn" />\n        </div>\n    </h3>\n\n    <input name="email" class="large input-block-level" type="email" placeholder="Email Address" />\n    <input name="password" class="large input-block-level" type="password" placeholder="Password" />\n    <input name="passwordConfirm" id="Login-confirm" class="large input-block-level" type="password" style="display:none;" placeholder="Confirm Password" />\n\n    <div id="LoginErrorHolder"></div>\n    <button id="Login-submit" class="btn btn-large btn-block" type="submit">Get Started</button>\n\n    <!--<label for="Login-remember" class="small inlineBlock">-->\n        <!--<input name="rememberMe" id="Login-remember" type="checkbox" checked />-->\n        <!--Remember Me-->\n    <!--</label>-->\n    <!--<a id="Login-forgot" class="pull-right small" href="">Forgot Your Password?</a>-->\n</form>\n\n'}),define("text!ui_widgets/hold_please.hbs",[],function(){return'\n<i class="icon-repeat {{iconSize}}"></i>\n<p class="msg muted"></p>'}),define("utils/numbers",[],function(){var e;return e={flipCoin:function(){return!!Math.floor(2*Math.random())},casino:function(e){return e=e||.5,!!(e>Math.random())},pickOneAnyOne:function(e){return e[Math.floor(Math.random()*e.length)]}}}),define("ui_widgets/hold_please",["jquery","backbone","Handlebars","text!./hold_please.hbs","utils/numbers"],function(e,t,n,i,s){var r,o,a,l;return a="ui_widgets/hold_please",l=".msg",o=["Powering up the Flux Capacitor...","Seeking the Keymaster...","Venturing in the jungle for the golden statue...","Seeking the lost ark...","Finding the secret plans...","Wax on, wax off...","Recieving signal from a galaxy far, far away...","Seeking the sourthern oracle...","Evading the nothing...","Microwaving the potato...","Getting on the highway to the danger zone...","Pulling baby out of the corner...","Phoning home...","Getting loose. Footloose...","Feeding Seymore...","Just a jump the the left and a step to the right. More to go..."],r=t.View.extend({tmpl:n.compile(i),tagName:"b",className:"holdPlease",events:{click:"_clicked"},initialize:function(){},render:function(e){return this.$el.html(this.tmpl({iconSize:e})),this},_clicked:function(e){return e.preventDefault(),e.stopPropagation()},_addMsg:function(t){return t?(t===!0&&(t=s.pickOneAnyOne(o)),e("."+this.className+" "+l).text(t)):void 0},_showOnSelector:function(t,n){return e(t).hasClass("btn-large")&&(n="icon-large"),e(t).addClass("onHold").css("position","relative").append(this.render(n).$el.clone(!0))},_showFullScreen:function(){return this._showOnSelector("body","icon-4x")},_hideInSelector:function(t){return e(t).removeClass("onHold").css("position","").find("."+this.className).remove()},_hideAll:function(){return e("."+this.className).parent().removeClass("onHold").css("position",""),e("."+this.className).remove()},show:function(e,t){return e?this._showOnSelector(e):this._showFullScreen(),this._addMsg(t)},hide:function(e){return e?this._hideInSelector(e):this._hideAll()}}),new r}),define("text!ui_widgets/psst.hbs",[],function(){return'\n<button type="button" class="close" data-dismiss="alert">&times;</button>\n\n{{#if title}}\n    <h4 class="title">{{title}}</h4>\n{{/if}}\n\n{{msg}}\n\n'}),define("ui_widgets/psst",["jquery","backbone","Handlebars","text!./psst.hbs"],function(e,t,n,i){var s,r,o,a,l,c;return c="ui_widgets/psst",o={good:"good",info:"info",question:"question",warn:"warn",error:"error"},l=o.info,a="psst",s=t.View.extend({tagName:"aside",className:""+a+" alert",initialize:function(){return this.tmpl=n.compile(i)},render:function(e){var t;if(!e.msg||!e.sel)throw new Error("Need .msg and .sel");return t={title:e.title||null,msg:e.msg,type:e.type||l,selector:e.sel},this.$el.html(this.tmpl(t)),this.$el.attr("class",""+this.className+" "+t.type),this.$el.clone().prependTo(t.selector),this},_hide:function(){return this.$el.is(":visible")?(this.$el.attr("class",this.className).remove(),this):void 0},_hideAll:function(){return e("."+a).remove()}}),r=new s,r.render=_.bind(r.render,r),r.render.hide=_.bind(r._hideAll,r),r.render.TYPES=o,r.render}),define("forms/user/login",["jquery","backbone","Handlebars","syphon","text!./login.hbs","ui_widgets/hold_please","ui_widgets/psst","composite_views/perch"],function(e,t,n,i,s,r,o,a){var l,c,h,u,d,p;return u="forms/user/login",c="#Login-confirm",p="#Login-submit",d="#ActionRegister",h="#LoginType",l=t.View.extend({className:"loginDialog",events:{"click #SignInFacebook":"_clickedSignInFacebook","click #ActionSignIn":"_modeSignIn","click #ActionRegister":"_modeRegister","click #Login-forgot":"_clickedForgotPass","focus input":"_jazzifySubmitBtn",submit:"_submittedForm"},initialize:function(){if(null==this.options.app||null==this.model)throw new Error("Need options.app and a model");return this.listenTo(this.model,"sync",this._onSync),this.listenTo(this.model,"invalid",this._onModelInvalid),this.listenTo(this.model,"error",this._onModelError)},render:function(){var e;return this.$el.html(s),null!=(e=this.options.app.analytics)&&e.track(this.className,"show"),this.options.register&&(this.$(d).trigger("click"),this.$(d).siblings().removeClass("active"),this.$(d).addClass("active")),this},_jazzifySubmitBtn:function(){return this.$(p).addClass("btn-inverse")},_showErr:function(e){return e=e||"Unknown Error",o.hide(),o({sel:"#LoginErrorHolder",msg:e,type:"error"})},_clickedSignInFacebook:function(t){var n;return this.options.app.session.loginUsingOauth("facebook",{width:1006,height:775}),r.show(e(t.target)),null!=(n=this.options.app.analytics)?n.track(this.className,"Pressed Facebook Sign In"):void 0},_clickedForgotPass:function(){},_modeSignIn:function(){var e;return this._isRegisterMode=!1,this.$(h).val("signIn"),this.$(c).hide(),this._jazzifySubmitBtn(),o.hide(),null!=(e=this.options.app.analytics)?e.track(this.className,"modeSignIn"):void 0},_modeRegister:function(){var e;return this._isRegisterMode=!0,this.$(h).val("register"),this.$(c).show(),this._jazzifySubmitBtn(),o.hide(),null!=(e=this.options.app.analytics)?e.track(this.className,"modeRegister"):void 0},_submittedForm:function(e){var t,n;return e.preventDefault(),o.hide(),r.show(p),t=i.serialize(e.target),"register"!==t.loginType&&(t.passwordConfirm=""),this.options.app.user.isGuest()||this.options.app.session.logOut(),"register"===t.loginType?(this.model.set(t,{silent:!0}),this.model.isValid({register:!0})&&this.options.app.session.register()):(this.model.set(t,{silent:!0}),this.model.isValid({login:!0})&&this.options.app.session.signIn()),null!=(n=this.options.app.analytics)?n.track(this.className,"Submitted Form",t.loginType):void 0},_onSync:function(){return a.hide()},_onModelInvalid:function(e,t){var n;return this._showErr(t),r.hide(p),null!=(n=this.options.app.analytics)?n.track(this.className,"Validation Issue"):void 0},_onModelError:function(e,t){return this._showErr(""+t.status+": "+t.statusText),r.hide(p)}})}),define("text!forms/user/profile.hbs",[],function(){return'\n\n\n{{#if image}}\n    <i class="avatar interactive">\n        <img src="{{image}}" alt="{{name}}\'s Profile Image" />\n    </i>\n{{else}}\n    <i class="avatar large interactive"></i>\n{{/if}}\n\n\n<!--<form title="{{city}}, {{state}}. {{country}}. DOB: {{date_of_birth}} timezone: {{timezone}}">-->\n    <!--<input type="text" name="name" placeholder="Name" class="input large input-block-level" value="{{name}}" >-->\n    <!--<input type="text" name="email" placeholder="email@address.com" class="input large input-block-level" value="{{email}}">-->\n    <!--<button class="btn btn-large btn-block btn-inverse" type="submit">Save</button>-->\n<!--</form>-->\n\n\n'}),define("classes/model",["underscore","backbone"],function(e,t){var n;return n=t.Model.extend({dewrap:function(t){return e.isObject(t.data)&&e.isObject(t.status)?t.data:t},parse:function(e,t){return e=this.dewrap(e,t)},increment:function(e){var t;return t=this.get(e),isNaN(t)?void 0:this.set(e,t+1)}})}),define("entities/properties",["backbone","classes/model"],function(e,t){var n,i,s,r,o;return o="entities/properities",s={selectByIcon:"select_by_icon",email:"email",password:"password",url:"url",tel:"tel",date:"date",text:"text",select:"select",rocker:"rocker",checkbox:"checkbox"},r=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},i=t.extend({defaults:{string_id:null,label:null,type:s.text,required:null,value:null,multiSelect:null},initialize:function(){}}),n=e.Collection.extend({model:i}),n.TYPES=s,n}),define("text!ui_widgets/formation/select_by_icon.hbs",[],function(){return'\n\n{{#if label}}\n    <label for="{{string_id}}">{{label}}</label>\n{{else}}\n    {{#if question}}\n        <label for="{{string_id}}">{{question}}</label>\n    {{/if}}\n{{/if}}\n\n\n<select name="{{string_id}}" {{#if multiselect}}multiple{{/if}}>\n    {{#unless multiselect}}\n        <option value="">Select...</option>\n    {{/unless}}\n    {{#options}}\n        <option value="{{value}}">{{value}}</option>\n    {{/options}}\n</select>\n\n\n<span class="purdyBts noDisplay">\n    {{#options}}\n        <button value="{{value}}" class="btn btn-large btn-link btn-tall" type="button">\n            <i class="\n                {{#if icon}}\n                    {{icon}}\n                {{else}}\n                    gfx-{{value}}\n                {{/if}}">\n            </i>\n            <small>\n                {{#if label}}\n                    {{label}}\n                {{else}}\n                    {{value}}\n                {{/if}}\n            </small>\n        </button>\n    {{/options}}\n</span>\n\n\n'}),define("ui_widgets/formation/select_by_icon",["jquery","backbone","Handlebars","text!./select_by_icon.hbs"],function(e,t,n,i){var s,r,o,a,l;return o="ui_widgets/formation/select_by_icon",l=n.compile(i),a="active",r=".purdyBts",s=t.View.extend({className:"field selectByIcon",events:{"click .btn":"onBtnClick","change select":"onSelectChange"},initialize:function(){return this.$el.addClass(this.model.attributes.string_id)},render:function(){return this.$el.html(l(this.model.attributes)),this.$(r).css({display:"inline-block"}),this.$("select").hide(),this},_syncSelectByBtn:function(){var t;return t=[],this.$("button").each(function(){return e(this).hasClass(a)?t.push(e(this).val()):void 0}),this.$("select").val(t),this.model.set("value",this.$("select").val()),this.$("select").trigger("change")},_syncBtnBySelect:function(){var t;return t=this.$("select").val(),this.$("button").each(function(){if(e(this).removeClass(a),_.isArray(t)){if(_.contains(t,e(this).val()))return e(this).addClass(a)}else if(e(this).val()===t)return e(this).addClass(a)})},onBtnClick:function(t){var n,i;return n=e(t.currentTarget),i=n.val(),n.toggleClass(a),n.hasClass(a)&&(this.model.attributes.multiselect||n.siblings("."+a).removeClass(a)),this._syncSelectByBtn()},onSelectChange:function(){return this._syncBtnBySelect(),this.trigger("change",{model:this.model,value:this.$("select").val()})}})}),define("text!ui_widgets/formation/standard_field.hbs",[],function(){return'\n<div class="field {{string_id}}">\n\n    {{#if label}}\n        <label for="{{string_id}}">{{label}}</label>\n    {{/if}}\n\n    <input\n       name="{{string_id}}"\n       class="{{className}}"\n       type="{{type}}"\n       value="{{value}}"\n        {{#if placeholder}}\n           placeholder="{{placeholder}}"\n        {{/if}}\n        {{#if required}}\n            required\n        {{/if}}\n\n\n    />\n\n</div>\n\n'}),define("text!ui_widgets/formation/select_field.hbs",[],function(){return'\n<div class="field {{string_id}}">\n\n    {{#if label}}\n        <label for="{{string_id}}">{{label}}</label>\n    {{/if}}\n\n    <select class="{{className}}" name="{{string_id}}" {{#if multiselect}}multiple{{/if}}>\n        {{#unless multiselect}}\n            {{#if defaultOption}}\n                <option value=\'\'>{{defaultOption}}</option>\n            {{else}}\n                <option value=\'\'>Select...</option>\n            {{/if}}\n        {{/unless}}\n        {{#options}}\n            <option value="{{this}}">{{this}}</option>\n        {{/options}}\n    </select>\n\n</div>\n\n\n\n\n\n'}),define("text!ui_widgets/formation/date_field.hbs",[],function(){return'\n<div class="field {{string_id}}">\n\n    {{#if label}}\n        <label for="{{string_id}}">{{label}}</label>\n    {{/if}}\n\n    <input\n        name="{{string_id}}"\n        type="date"\n        class="{{className}}"\n        value="{{value}}"\n        {{#if placeholder}}\n            placeholder="{{placeholder}}"\n        {{/if}}\n        {{#if required}}\n            required\n        {{/if}}\n        />\n\n</div>\n\n'}),define("text!ui_widgets/formation/button.hbs",[],function(){return'\n<div class="buttonArea">\n    <button type=\'submit\' class="btn {{className}}">\n        {{#if text}}\n            {{text}}\n        {{else}}\n            Save\n        {{/if}}\n    </button>\n</div>'}),define("text!ui_widgets/formation/rocker.hbs",[],function(){return'\n<div class="field {{string_id}}">\n\n    {{#if label}}\n        <label for="{{string_id}}">{{label}}</label>\n    {{/if}}\n\n    <div class="btn-group btn-rocker {{className}}">\n        {{#options}}\n            <button class="btn" type="button" value="{{this}}">{{this}}</button>\n        {{/options}}\n        <input\n            type="hidden"\n            name="{{string_id}}"\n            value="{{value}}"\n        />\n    </div>\n\n</div>\n\n'}),define("text!ui_widgets/formation/checkbox.hbs",[],function(){return'\n<div class="field {{name}}">\n\n    <input\n        id="field-{{name}}"\n        name="{{name}}"\n        class="{{className}}"\n        type="checkbox"\n        {{#if required}}\n            required\n        {{/if}}\n        {{#if value}}\n            checked\n        {{/if}}\n    />\n\n    {{#if label}}\n        <label class="forCheckbox" for="field-{{name}}">{{label}}</label>\n    {{/if}}\n    {{#if description}}\n        <label class="forCheckbox" for="field-{{name}}">{{description}}</label>\n    {{/if}}\n\n</div>\n\n'}),define("ui_widgets/formation/main",["backbone","Handlebars","entities/properties","syphon","./select_by_icon","text!./standard_field.hbs","text!./select_field.hbs","text!./date_field.hbs","text!./button.hbs","text!./rocker.hbs","text!./checkbox.hbs"],function(e,t,n,i,s,r,o,a,l,c,h){var u,d,p,f,m,g,v;
return v=t.compile(r),g=t.compile(o),f=t.compile(a),d=t.compile(l),m=t.compile(c),p=t.compile(h),u=e.View.extend({tagName:"form",className:"formation clearfix",initialize:function(){if(!this.options.data)throw new Error("Need options.data");return this.collection=new n(this.options.data)},render:function(){var e=this;return this.$el.empty(),this.collection.each(function(t){return e.$el.append(e._renderProperty(t))}),null!=this.options.submitBtn&&this.$el.append(d(this.options.submitBtn)),null!=this.options.values&&this.setVals(this.options.values),this},_renderProperty:function(e){var t,i;switch(t=n.TYPES,e.get("type")){case t.select:return g(e.attributes);case t.selectByIcon:return i=new s({model:e}),i.render().el;case t.date:return f(e.attributes);case t.rocker:return m(e.attributes);case t.checkbox:return p(e.attributes);default:return v(e.attributes)}},getVals:function(){var e,t,n;t=i.serialize(this.el);for(e in t)n=t[e],null==n&&delete t[e];return t},setVals:function(e){return i.deserialize(this.el,e),this.$("select").trigger("change"),this}})}),define("ui_widgets/formation",["ui_widgets/formation/main"],function(e){return e}),define("forms/user/profile-fields",[],function(){return[{string_id:"name",label:"Name",placeholder:"Captain Nemo",className:"large input-block-level"},{string_id:"email",label:"Email",type:"email",placeholder:"email@address.com",className:"large input-block-level"},{string_id:"dob",type:"date",label:"Birthdate",className:"large input-block-level"},{string_id:"education",label:"Education",type:"select",className:"large input-block-level",options:["High School - Freshman (9)","High School - Sophmore (10)","High School - Junior (11)","High School - Senior (12)","College - Less than 2 yrs","College - Associates","College - Bachelor's","College - Master's","College - Ph.D.","Prefer not to answer"]},{string_id:"handedness",type:"select_by_icon",label:"Handedness",options:[{value:"left",label:"Left",icon:"gfx-lefthand"},{value:"right",label:"Right",icon:"gfx-righthand"},{value:"mixed",label:"Mixed",icon:"gfx-bothhands"}]},{string_id:"gender",label:"",type:"select_by_icon",label:"Gender",options:[{value:"female",label:"Female",icon:"gfx-female"},{value:"male",label:"Male",icon:"gfx-male"}]}]}),define("forms/user/profile",["jquery","underscore","backbone","Handlebars","text!./profile.hbs","ui_widgets/formation","./profile-fields","ui_widgets/hold_please","ui_widgets/psst","composite_views/perch"],function(e,t,n,i,s,r,o,a,l,c){var h,u,d,p,f,m;return p="forms/profile/user_profile",f="[type=submit]",d=".formation .buttonArea",u="<div id='ProfileErrorHolder'></div>",m=i.compile(s),h=n.View.extend({className:"userProfile",events:{"submit form":"onSubmit","input change":"onInputChange"},initialize:function(){return this.listenTo(this.model,"error",this.onError),this.listenTo(this.model,"invalid",this.onInvalid),this.listenTo(this.model,"sync",this.onSync)},render:function(){return this.$el.html(m(this.model.attributes)),this.form=new r({data:o,values:this.model.attributes,submitBtn:{className:"btn-large btn-block btn-inverse"}}),this.$el.append(this.form.render().el),this},_showErr:function(e){return l.hide(),l({sel:d,msg:e,type:"error"}),a.hide(this.$(f))},onInputChange:function(){return l.hide()},onSubmit:function(e){var t;return e.preventDefault(),l.hide(),a.show(this.$(f)),t=this.form.getVals(),this.model.save(t,{wait:!0,profile:!0})},onSync:function(){return c.hide()},onError:function(e,t){var n;return n=0===t.status?"Unknown Server Error":""+t.status+": "+t.statusText,this._showErr(n)},onInvalid:function(e,t){return this._showErr(t)}})}),define("classes/collection",["underscore","backbone","classes/model"],function(e,t,n){var i;return i=t.Collection.extend({model:n,dewrap:n.prototype.dewrap,parse:n.prototype.parse,mixalot:function(){return this.reset(this.shuffle(),{silent:!0}),this}})}),define("entities/preferences/training-descriptions",["classes/collection"],function(e){var t;return t=e.extend({url:function(){return""+window.apiServerUrl+"/api/v1/preferences/training-preference/description"},setValues:function(e){var t,n,i;if(!e)return this;for(t in e)i=e[t],n=this.find(function(e){return e.attributes.name===t}),null!=n&&n.set({value:i});return this},getValues:function(){return console.warn("not implemented")}})}),define("entities/preferences/training",["underscore","classes/model"],function(e,t){var n,i;return i="entities/preferences/training",n=t.extend({url:function(){return""+window.apiServerUrl+"/api/v1/users/-/preferences?type=TrainingPreference"},defaults:{type:"TrainingPreference"},toJSON:function(){var t;return t=e.clone(this.attributes),delete t.description,t},parse:function(e){var t,n,i;if(e=this.dewrap(e),!e)return null;if(null!=e.data){i=e.data;for(t in i)n=i[t],e.data[t]="true"===n?!0:!1}return e},setValues:function(t){var n;return t?(n=this.get("data")||{},n=e.extend(n,t),this.set({data:n}),this):this}})}),define("text!preferences/personalization.hbs",[],function(){return'\n<ol class="stepsRemainingWizard steps-3 clearfix">\n    <li>Productivity</li>\n    <li>Mood</li>\n    <li>Complete</li>\n</ol>\n\n<div class="explanation"></div>\n\n<div class="content"></div>\n\n<div class="actionZone clearfix">\n    <button\n            id="ActionNext"\n            class="btn btn-large btn-link brandHappy pull-right" type="button">\n        Next\n        <span class="icon-stack">\n            <i class="icon-circle-blank icon-stack-base"></i>\n            <i class="icon-arrow-right"></i>\n        </span>\n    </button>\n</div>\n\n<div class="footer brandHappy small">\n\n</div>\n\n'}),define("text!preferences/personalization-games.hbs",[],function(){return'\n<p class="bling">\n    You will be guided with daily tasks based on your preferences and your personality. We recommend that you start with these games.\n</p>\n\n<div class="games">\n    <p><a class="btn btn-link" href="#game/emotions">The Emotions Game</a></p>\n    <p><a class="btn btn-link" href="#game/reaction_time">The Reaction Time Game</a></p>\n</div>\n\n'}),define("preferences/personalization",["jquery","underscore","backbone","Handlebars","entities/preferences/training-descriptions","entities/preferences/training","text!./personalization.hbs","text!./personalization-games.hbs","ui_widgets/formation","ui_widgets/hold_please","ui_widgets/psst","composite_views/perch"],function(e,t,n,i,s,r,o,a,l,c,h,u){var d,p,f,m,g,v,b,y,_,w,k,S,x,C;return p=".actionZone .btn",g=".content",S=".stepsRemainingWizard li",m="complete",C=i.compile(o),k=2,x=["1. Productivity","2. Mood"],f=["productivity","mood"],_=["TidePool's patented exercises are designed by top American psychologists.","Many TidePool users report positive results and also shared TidePool with friends and family.","TidePool games will improve your self-awareness and coach you to achieve your goals."],y=".footer",w=i.compile('<i class="icon-info-sign"></i> &nbsp; {{text}}'),v=".explanation",b=i.compile('<h3>{{title}}</h3><p class="small">{{subtitle}}</p>'),d=n.View.extend({className:"personalization",events:{"click #ActionNext":"onClickNext","submit form":"onSubmit","input change":"onInputChange","click .games a":"onGameClicked"},initialize:function(){var n;return this.data=new r,this.fields=new s,n=e.when(this.data.fetch(),this.fields.fetch()),n.done(t.bind(this.onSync,this)),n.fail(this.onError),this.curPage=0},render:function(){return c.show(this.$el),this},renderContents:function(){return c.hide(this.$el),this.$el.html(C),this._showFields(this.curPage)},onSync:function(){return this.data.attributes&&this.fields.setValues(this.data.attributes.data),this.renderContents()},onError:function(e,t){var n;return n=0===t.status?"Unknown Server Error":""+t.status+": "+t.statusText,u.hide()},_showFields:function(e){return this.options.app.analytics.track("Personalizations","Showing Step: "+e),this._indexActions(e),this.$(v).html(b({title:x[e],subtitle:"Select all options that you are interested to improve."})),this.form=new l({data:this.fields.where({category:f[e]})}),this.$(g).html(this.form.render().el),this},_indexActions:function(e){return this.$(S).eq(e).addClass(m),this.$(y).html(w({text:_[e]}))},_showComplete:function(e){return this.options.app.analytics.track("Personalizations","Completed"),this._indexActions(e),this.$(v).html(b({title:"Your Personalized Program is ready!",subtitle:"You can go back at any time and change your preferences."})),this.$(g).html(a),this.$(p).remove(),this},onClickNext:function(){var e;return this.curPage++,this.fields.setValues(this.form.getVals()),this.data.setValues(this.form.getVals()),null!=(e=this.form)&&e.remove(),this.curPage===k?(this.data.save(),this._showComplete(this.curPage)):this._showFields(this.curPage)},onGameClicked:function(){return u.hide()}})}),define("text!connections/connection_list.hbs",[],function(){return'\n\n\n<ul class="connections">\n\n</ul>\n\n\n\n\n'}),define("entities/progress/_base",["underscore","backbone"],function(e,t){var n,i;return i={pending:"pending",done:"done",error:"error"},n=t.Model.extend({maxPolls:10,pollWait:500,initialize:function(){return e.bindAll(this,"onGotStarted","onPromiseFail","_poll")},fetch:function(){var t,n;return n=e.result(this,"url"),n||console.error("Need a url"),t=$.get(n),t.done(this.onGotStarted),t.fail(this.onPromiseFail),this},onGotStarted:function(e){return null==e.status.link&&console.error("response doesn't include a link"),this.polls=0,this._poll(e)},onPromiseFail:function(e,t,n){return this.trigger("error",this,t,{jqXHR:e,textStatus:t,errorThrown:n})},_poll:function(e){var t,n=this;switch(e.status.state){case i.pending:return this.polls>=this.maxPolls?this.trigger("error",this,"Timed out polling for progress"):(this.polls++,t=$.get(e.status.link),t.done(function(e){return setTimeout(function(){return n._poll(e)},n.pollWait)}),t.fail(this.onPromiseFail));case i.done:return this.trigger("sync",this,"Progress completed");case i.error:return this.trigger("error",this,"Error polling for progress");default:return console.warn("unknown poll state")}}})}),define("entities/progress/connection",["./_base"],function(e){var t;return t=e.extend({url:function(){return""+window.apiServerUrl+"/api/v1/users/-/connections/"+this.attributes.provider+"/synchronize"}})}),define("entities/connection",["classes/model","entities/progress/connection"],function(e,t){var n,i,s;return s=""+window.apiServerUrl+"/auth/new?",i={fitbit:"Fitbit",nike:"Nike",facebook:"Facebook",twitter:"Twitter",instagram:"Instagram"},n=e.extend({defaults:function(){return{redirect_uri:document.URL,link:"javascript:void(0);"}},initialize:function(){return this.progress=new t({provider:this.attributes.provider}),this.listenTo(this.progress,"error",this.onProgressError),this.listenTo(this.progress,"sync",this.onProgressSync),this._setActivationLink(),this.set("display_name",i[this.attributes.provider]||this.attributes.provider)},_setActivationLink:function(){var e;return e=this.pick("provider","redirect_uri","user_id"),this.set({link:""+s+$.param(e)})},onProgressError:function(e,t){return console.warn("Error getting progress on the connection: "+t),this.unset("isPolling"),this.set({msg:"Error"})},onProgressSync:function(){return this.unset("msg"),this.unset("isPolling")},syncConnection:function(){return this.set({msg:"Syncing..."}),this.set({isPolling:!0}),this.progress.fetch()}})}),define("entities/my/connections",["classes/collection","entities/connection"],function(e,t){var n;return n=e.extend({model:t,url:""+window.apiServerUrl+"/api/v1/users/-/connections",initialize:function(e){return this.options=e},parse:function(e){var t,n,i;for(e=this.dewrap(e),n=0,i=e.length;i>n;n++)t=e[n],t.user_id=this.options.app.user.id;return e}})}),define("text!connections/connection_view.hbs",[],function(){return'\n\n\n    <p class="serviceName {{ provider }} {{#unless activated}}inactive{{/unless}}">\n        <i class="gfx-{{provider}} icon-fixed-width"></i>\n        <strong>{{display_name}}</strong>\n    </p>\n\n\n    {{#if activated}}\n\n        <!--<div class="error message">-->\n            <!--<a class="btn btn-link btn-large sync" href="{{link}}"-->\n               <!--title="Last Data Received: {{prettyDate last_accessed}} {{prettyTime last_accessed}}">-->\n                <!--Error, Try Again-->\n            <!--</a>-->\n        <!--</div>-->\n\n\n        {{#if msg}}\n            <div class="message">\n                <small class="muted">\n                    {{msg}}\n                </small>\n                <a class="btn btn-link {{#if isPolling}}onHold{{else}}sync{{/if}}" title="Refresh">\n                    <i class="icon-refresh"></i>\n                    {{#if isPolling}}\n                        <b class="holdPlease">\n                            <i class="icon-repeat icon-large"></i>\n                        </b>\n                    {{/if}}\n                </a>\n            </div>\n        {{else}}\n            <div class="message">\n                <small class="muted" title="Last Data Received: {{prettyDate last_accessed}} {{prettyTime last_accessed}}">\n                    {{prettyDate last_accessed}} {{prettyTime last_accessed}}\n                </small>\n                <a class="btn btn-link sync" title="Refresh">\n                    <i class="icon-refresh"></i>\n                </a>\n            </div>\n        {{/if}}\n\n    {{else}}\n        <a class="btn btn-link btn-large activate pull-right" href="{{link}}">\n            Activate\n        </a>\n    {{/if}}\n\n\n\n\n'}),define("connections/connection_view",["backbone","Handlebars","text!./connection_view.hbs"],function(e,t,n){var i,s;return t.registerHelper("prettyDate",function(e){var t;return t=new Date(e),t.toLocaleDateString()}),t.registerHelper("prettyTime",function(e){var t;return t=new Date(e),t.toLocaleTimeString()}),s=t.compile(n),i=e.View.extend({className:"connection clearfix",tagName:"li",events:{"click .sync":"onClickSync"},initialize:function(){return this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(s(this.model.attributes)),this},onClickSync:function(){return this.model.syncConnection()}})}),define("connections/connection_list",["backbone","text!./connection_list.hbs","entities/my/connections","./connection_view"],function(e,t,n,i){var s,r;return r=".connections",s=e.View.extend({className:"connectionList",events:{"click #ActionActiviateFitbit":"onClickFitbit"},initialize:function(){return this.collection=new n({app:this.options.app}),this.listenTo(this.collection,"sync",this.onSync),this.collection.fetch()},render:function(){return this.$el.html(t),this},_renderList:function(){return this.collection.each(function(e){return e.view=new i({model:e}),this.$(r).append(e.view.render().el)})},onSync:function(){return this._renderList()}})}),define("core/mediator",["underscore","backbone","composite_views/perch","forms/user/login","forms/user/profile","preferences/personalization","connections/connection_list"],function(e,t,n,i,s,r,o){var a,l;return l="core/mediator",a=t.View.extend({initialize:function(){if(null==this.options.app)throw new Error("Need options.app");return n.options.app=this.options.app,this._mediate()},_mediate:function(){return this.listenTo(this.options.app,"session:showLogin",this._showLogin),this.listenTo(this.options.app,"session:showRegister",this._showRegister),this.listenTo(this.options.app,"session:showProfile",this._showProfile),this.listenTo(this.options.app,"session:logOut",this._actionLogOut),this.listenTo(this.options.app,"action:showPersonalizations",this._showPersonalizations),this.listenTo(this.options.app,"action:showConnections",this._showConnections)},_showLogin:function(){return n.show({btn1Text:null,supressTracking:!0,content:new i({model:this.options.app.user,app:this.options.app})})},_showRegister:function(){return n.show({btn1Text:null,supressTracking:!0,content:new i({model:this.options.app.user,app:this.options.app,register:!0})})},_showProfile:function(){return n.show({title:"Profile",btn1Text:null,content:new s({model:this.options.app.user})})},_showPersonalizations:function(){return n.show({title:'<i class="icon-cog"></i> Your Preferences',className:"brandHappy",btn1Text:null,huge:!0,content:new r({app:this.options.app})})},_showConnections:function(){return n.show({title:"Connections",btn1Text:null,content:new o({app:this.options.app})})},_actionLogOut:function(){return this.options.app.analytics.track("session","Pressed Log Out"),this.options.app.router.navigate("home",{trigger:!0}),this.options.app.session.logOut()}})}),define("text!core/layouts/layout.hbs",[],function(){return'\n\n\n\n\n<header class="header">\n    <div class="inner" id="HeaderRegion"></div>\n</header>\n<div class="content clearfix" id="ContentRegion"></div>\n<div class="noDisplay" id="StagingRegion"></div>\n\n\n\n'}),define("text!ui_widgets/site_logo.hbs",[],function(){return'\n<a class="siteLogo interactive" href="#">\n    <h1>TidePool</h1>\n</a>'}),define("text!ui_widgets/site_logo_nolink.hbs",[],function(){return'\n<div class="siteLogo">\n    <h1>TidePool</h1>\n</div>\n'}),define("core/layouts/layout",["underscore","backbone","Handlebars","text!./layout.hbs","text!ui_widgets/site_logo.hbs","text!ui_widgets/site_logo_nolink.hbs"],function(e,t,n,i,s,r){var o,a,l,c;return c="core/layouts/layout",a=".siteLogo",l="flirt",o=t.View.extend({tmpl:n.compile(i),initialize:function(){return $("body").prop("class","background-"+this.className+" route-"+location.hash.split("#").join(""))},_cleanupChildren:function(){var e,t;return null!=(e=this._curView)&&"function"==typeof e.close&&e.close(),null!=(t=this._curView)?t.remove():void 0},show:function(e){return this._cleanupChildren(),e.layout=this,this._curView=e,this.$("#ContentRegion").html(this._curView.render().el)},close:function(){return this._cleanupChildren()},resetHeader:function(e){return(null!=e?e.nolink:void 0)?this.$("#HeaderRegion").html(r):this.$("#HeaderRegion").html(s)},shimmerLogo:function(){return this.$(a).removeClass(l).addClass(l)}})}),define("text!ui_widgets/main_nav.hbs",[],function(){return'\n<nav class="mainNav nav">\n    <ul>\n        <li><a href="#about" class="pages-about">About</a></li>\n        <li><a href="#team" class="pages-team">Team</a></li>\n    </ul>\n</nav>\n'}),define("text!ui_widgets/user_menu.hbs",[],function(){return'\n\n\n\n{{#if nickname}}\n\n    <div class="btn btn-clear btn-large dropdown-toggle">\n        <ul class="dropdown-menu">\n            <li><a id="ActionShowProfile">\n                <i class="icon-fixed-width icon-user"></i>\n                Profile\n            </a></li>\n            <li><a href="#dashboard">\n                <i class="icon-fixed-width icon-th-large"></i>\n                Dashboard\n            </a></li>\n            <li><a id="ActionShowPersonalizations">\n                <i class="icon-fixed-width icon-cog"></i>\n                Personalize\n            </a></li>\n            <li><a id="ActionShowConnections">\n                <i class="icon-fixed-width icon-lightbulb"></i>\n                Connections\n            </a></li>\n            <li><a id="ActionLogOut">\n                <i class="icon-fixed-width icon-unlink"></i>\n                Log Out\n            </a></li>\n        </ul>\n        <i class="avatar">\n            {{#if image}}\n                <img src="{{image}}" alt="{{nickname}}\'s Profile Image" />\n            {{/if}}\n        </i>\n        <span class="nickname" title="{{name}}: {{email}}">{{nickname}}</span>\n        <i class="arrow icon-chevron-sign-down muted"></i>\n    </div>\n\n{{else}}\n\n    <button id="ActionShowLogin" class="btn btn-link btn-large" href="">\n        <i class="icon-lock icon-large"></i>\n        Log In\n    </button>\n\n{{/if}}\n\n\n\n'}),define("ui_widgets/user_menu",["jquery","underscore","backbone","Handlebars","text!./user_menu.hbs"],function(e,t,n,i,s){var r,o;return o="ui_widgets/user_menu",r=n.View.extend({className:"userMenu",tmpl:i.compile(s),events:{"click #ActionShowLogin":"_clickedLogIn","click #ActionLogOut":"_clickedLogOut","click #ActionShowProfile":"_clickedProfile","click #ActionShowPersonalizations":"_clickedPersonalizations","click #ActionShowConnections":"_clickedConnections"},start:function(e){if(!e.user)throw new Error("Need an options.user to start");return this.app=e,this.model=this.app.user,this.listenTo(this.model,"change",this.render),this.render(),this},stop:function(){return this.stopListening(),delete this.app,delete this.model},render:function(){var e;return e=this._parseModel(this.model),this.$el.html(this.tmpl(e)),this},_parseModel:function(e){return t.pick(e.attributes,"nickname","email","name","city","image","guest")},_clickedLogIn:function(){var e;return null!=(e=this.app)?e.trigger("session:showLogin"):void 0},_clickedLogOut:function(){var e;return null!=(e=this.app)?e.trigger("session:logOut"):void 0},_clickedProfile:function(){var e;return null!=(e=this.app)?e.trigger("session:showProfile"):void 0},_clickedPersonalizations:function(){var e;return null!=(e=this.app)?e.trigger("action:showPersonalizations"):void 0},_clickedConnections:function(){var e;return null!=(e=this.app)?e.trigger("action:showConnections"):void 0}}),new r}),define("core/layouts/layout-site",["underscore","backbone","Handlebars","./layout","text!ui_widgets/main_nav.hbs","ui_widgets/user_menu"],function(e,t,n,i,s,r){var o,a;return a="core/layouts/layout-site",o=i.extend({className:"siteLayout",initialize:function(){return o.__super__.initialize.call(this),this.render()},render:function(){return this.$el.html(this.tmpl()),o.__super__.resetHeader.call(this),r.delegateEvents(),this.$("#HeaderRegion").append(r.el),this}})}),define("core/layouts/layout-game",["underscore","backbone","Handlebars","./layout","ui_widgets/user_menu"],function(e,t,n,i){var s,r;return r="core/layouts/layout-game",s=i.extend({className:"gameLayout",initialize:function(){return s.__super__.initialize.call(this),this.render()},render:function(){return this.$el.html(this.tmpl()),s.__super__.resetHeader.call(this,{nolink:!0}),this}})}),define("text!dashboard/action_items.hbs",[],function(){return'\n\n<div class="inner">\n    <hgroup class="welcome">\n        <h2>\n            {{pickOne greetings }}!\n        </h2>\n        <h5>\n            Wow, there\'s lots to do here. <br/>\n            Here\'s something to get you started.\n        </h5>\n    </hgroup>\n\n\n    <ul class="items">\n        <li class="item {{link_type}}"><a href="{{link}}">\n            <i class="{{icon}}"></i>\n            <p class="small">\n                <span class="uppercase">TidePool Recommends:</span> <strong>"{{title}}"</strong><br/>\n                {{sentence}}\n            </p>\n            <!--<p>-->\n            <!--Based on your personality, TidePool recommends this <em>{{link_type}}</em>.-->\n            <!--</p>-->\n        </a></li>\n    </ul>\n</div>\n\n\n'}),define("entities/my/actions",["classes/collection"],function(e){var t;return t=e.extend({url:""+window.apiServerUrl+"/api/v1/users/-/recommendations/actions"})}),define("dashboard/action_items",["underscore","backbone","Handlebars","text!./action_items.hbs","entities/my/actions"],function(e,t,n,i,s){var r,o,a,l;return a=["Hello","Hi","Aloha","Bonjour","Hola","Hallo","Ahoy","G'Day","Howdy","Hiya"],n.registerHelper("pickOne",function(e){return e[Math.floor(Math.random()*e.length)]}),l=n.compile(i),r={Website:"gfx-recommend_website",Video:"gfx-recommend_video",Course:"gfx-recommend_course",Comic:"gfx-recommend_comic",Book:"gfx-recommend_book",App:"gfx-recommend_app",Activity:"gfx-recommend_activity",ReactionTime:"gfx-reactiontime",Emotions:"gfx-emotiongame",Preferences:"icon-cog"},o=t.View.extend({className:"actionItems",events:{"click a":"onClick"},initialize:function(){return this.collection=new s,this.listenTo(this.collection,"sync",this.onSync),this.collection.fetch()},render:function(){var t,n;return n=this.collection.at(0),t=e.extend(n.attributes,{greetings:a}),t.icon=r[t.link_type],this.$el.html(l(t)),this},onSync:function(){return this.render()},onClick:function(e){var t,n;return t=$(e.currentTarget),n=t.prop("href"),n&&this.options.app?this.options.app.analytics.track("Action Items","Clicked "+n):void 0}})}),define("text!dashboard/dash_picker.hbs",[],function(){return'\n\n<nav class="dashPicker">\n    <ul>\n        <li><a class="summary" href="#dashboard">\n            <i class="icon-dashboard"></i>\n            <label>Summary</label>\n        </a></li>\n        <li><a class="personality" href="#dashboard-personality">\n            <i class="icon-user"></i>\n            <label>Personality</label>\n        </a></li>\n        <li><a class="productivity" href="#dashboard-productivity">\n            <i class="icon-briefcase"></i>\n            <label>Productivity</label>\n        </a></li>\n        <li><a class="mood" href="#dashboard-mood">\n            <i class="icon-smile"></i>\n            <label>Mood</label>\n        </a></li>\n    </ul>\n</nav>\n\n\n\n\n\n'}),define("core/layouts/layout-dashboard",["underscore","backbone","Handlebars","./layout","ui_widgets/user_menu","dashboard/action_items","text!dashboard/dash_picker.hbs"],function(e,t,n,i,s,r,o){var a,l;return l="core/layouts/layout-dashboard",a=i.extend({className:"dashboardLayout",initialize:function(){return a.__super__.initialize.call(this),this.render()},render:function(){var e;return this.$el.html(this.tmpl()),a.__super__.resetHeader.call(this),s.delegateEvents(),this.$("#HeaderRegion").append(s.el),e=new r({app:this.options.app}),this.$(".content").before(e.el),this.$(".content").before(o)}})}),define("core/view",["underscore","backbone","./layouts/layout-site","./layouts/layout-game","./layouts/layout-dashboard","ui_widgets/user_menu","composite_views/perch","bootstrap"],function(e,t,n,i,s,r,o){var a,l,c,h;return c="core/view",l="TidePool",h=".mainNav",a=t.View.extend({initialize:function(){return $("body").append(this.el),r.start(this.options.app)},render:function(){return this._curLayout.show(this._curView),this.$el.html(this._curLayout.el),this},_cleanupOldView:function(){var e,t;return o.hide(),null!=(e=this._curView)&&"function"==typeof e.close&&e.close(),null!=(t=this._curView)?t.remove():void 0},_loadView:function(t,n){var i=this;return this._cleanupOldView(),require([t],function(s){var r;return i._curView=(null!=n?n.model:void 0)?new s({model:n.model}):new s({params:n}),i.render(),"function"==typeof(r=i._curView).onDomInsert&&r.onDomInsert(),document.title=i._curView.title?""+e.result(i._curView,"title")+" - "+l:l,("function"==typeof window.matchMedia?window.matchMedia("(max-width: 603px)").matches:void 0)&&setTimeout(function(){return window.scrollTo(0,1)},0),i.options.app.analytics.trackPage(t)})},asSite:function(e,t){return this._curLayout=new n({app:this.options.app}),$("body").addClass(e.split("/").join("-")),this._loadView(e,t)},asGame:function(e,t){return this._curLayout=new i({app:this.options.app}),this._loadView(e,t)},asDash:function(e,t){return this._curLayout=new s({app:this.options.app}),this._loadView(e,t)}})}),define("core/router",["jquery","backbone"],function(e,t){var n,i,s;return i="routers/main_router",s="/welcome/",n=t.Router.extend({routes:{"":"showHome",home:"showHome",about:"showAbout",team:"showTeam",getStarted:"getStarted",startGame:"getStarted",demographics:"showDemographics","game/:def_id":"createGame",game:"createDefaultGame","gameForUser/:token":"createGameForUser","gameResults/:id":"showGameResults",dashboard:"showDashboard","dashboard-mood":"showDashMood","dashboard-personality":"showDashPersonality","dashboard-productivity":"showDashProductivity","referrer/:refId":"recordReferrer","preferences-training":"showTrainingPreferences","friendHelper/:uid/:gid":"showFriendHelper","friendResults/:gid":"showFriendResults"},initialize:function(e){return this.app=e},showHome:function(){return null!=this.app.user.attributes.referred_by?window.location.href=s+this.app.user.attributes.referred_by:this.app.view.asSite("pages/home")},getStarted:function(){return null!=this.app.user.attributes.personality?this.navigate("dashboard",{trigger:!0,replace:!0}):this.createDefaultGame()},showAbout:function(){return this.app.view.asSite("pages/about")},showTeam:function(){return this.app.view.asSite("pages/team")},showDemographics:function(){return this.app.view.asGame("pages/demographics")},createDefaultGame:function(){return this.createGame("baseline")},createGame:function(e){return this.app.view.asGame("pages/play_game",{def_id:e})},createGameForUser:function(e){return this.listenToOnce(this.app.user,"sync",function(){return this.createGame("baseline")}),this.listenToOnce(this.app.user,"error",function(e,t){return this.showError(t.responseJSON.status.message,e)}),this.app.user.reset(e).fetch()},showGameResults:function(e){return this.app.view.asGame("pages/game_results",{game_id:e})},showDashboard:function(){return this.app.view.asDash("pages/dashboard/summary")},showDashProductivity:function(){return this.app.view.asDash("pages/dashboard/productivity")},showDashMood:function(){return this.app.view.asDash("pages/dashboard/mood")},showDashPersonality:function(){return this.app.view.asDash("pages/dashboard/personality")},showFriendHelper:function(e,t){return this.app.view.asGame("pages/friend_survey",{user_id:e,game_id:t})},showFriendResults:function(e){return this.app.view.asGame("pages/social_results",{game_id:e})},recordReferrer:function(e){return this.app.analytics.track("Referral",e),this.app.user.set({referred_by:e}),this.showDemographics(),this.navigate("startGame",{replace:!0})},showTrainingPreferences:function(){return this.navigate("dashboard"),this.app.trigger("action:showPersonalizations")},showError:function(e,t){return this.app.view.asSite("pages/error",{message:e,object:t})}})}),define("entities/my/games",["jquery","classes/model"],function(e,t){var n;return n=t.extend({urlRoot:""+window.apiServerUrl+"/api/v1/users/-/games",initialize:function(){return this._levelsSeen=[],this},toJSON:function(){return _.pick(this.attributes,"stage_completed","def_id")},getLatestWithProfile:function(){var t;return t=e.Deferred(),this.fetch({url:""+this.url()+"/latest_with_profile"}).done(function(){return console.log("Got the latest game"),t.resolve()}).fail(function(){return t.reject()}),t.promise()},create:function(e){return e?this.save({def_id:e}):this.save(),this},nextStage:function(){var e;return e=this.get("stage_completed"),this.save({stage_completed:e+1})},setLevelSeen:function(e){return this._levelsSeen.push(e),this._levelsSeen=_.uniq(this._levelsSeen),this},isFirstTimeSeeingLevel:function(e){return e?_.contains(this._levelsSeen,e)?!1:!0:null}})}),define("entities/user",["underscore","classes/model","entities/my/games"],function(e,t,n){var i,s;return s="entities/user",i=t.extend({urlRoot:""+window.apiServerUrl+"/api/v1/users",defaults:function(){return{id:"-",accessToken:sessionStorage.access_token}},initialize:function(){return this.on("change:name",this._calculateNickname),this.on("change:email",this._calculateNickname),this.on("change:guest",this._calculateNickname),this.on("error",this._onModelError),this.on("invalid",this._onModelInvalid)},validate:function(e,t){if(e.guest===!0)return null;if(t.login||t.register){if(!e.email)return"The email address cannot be blank.";if(!e.password)return"The password cannot be blank.";if(!(e.password.length>=8))return"The password should be 8 or more characters."}if(t.register){if(!e.passwordConfirm)return"The confirm password field cannot be blank";if(e.password!==e.passwordConfirm)return"The passwords should match"}return t.profile&&!e.email?"The email address cannot be blank.":null},_calculateNickname:function(){var e;return this.isGuest()||(e=this.get("name")||this.get("email")),this.set({nickname:e},{silent:!0})},_nuke:function(){return delete sessionStorage.access_token,delete sessionStorage.expires_in,delete sessionStorage.token_received,delete sessionStorage.refresh_token,delete sessionStorage.guest,this
},_tokenGutCheck:function(){var e,t;return 10<(e=null!=(t=this.get("accessToken"))?t.length:void 0)&&9999>e},_onModelError:function(e,t){var n,i,s;return console.error(null!=(n=t.responseJSON)?null!=(i=n.status)?i.message:void 0:void 0),console.log({model:e,xhr:t}),401===t.status?null!=(s=this.session)?s.logOut():void 0:void 0},_onModelInvalid:function(e,t){return console.log(""+s+"._onModelInvalid(): "+t)},parseHash:function(e){var t,n,i,s;for(n={},i=e.substring(1),s=/([^&=]+)=([^&]*)/g;t=s.exec(i);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return n},addAuthentication:function(t,n){var i,s,r,o;return s=window.screenLeft+50,r=window.screenTop+50,o=n.width,i=n.height,window.addAuthRedirect=e.bind(this.onAddAuthRedirect,this),window.open(this.setupAddAuthUrl(t),"Login","width="+o+", height="+i+", left="+s+", top="+r+", menubar=no")},setupAddAuthUrl:function(e){var t,n,i;return t=""+window.apiServerUrl+"/auth/additional",i=""+window.location.protocol+"//"+window.location.host+"/additional_redirect.html#",i=encodeURIComponent(i),n="provider="+e+"&",""+t+"?redirect_uri="+i+"&user_id="+this.get("id")+"&provider="+e},onAddAuthRedirect:function(e,t){var n;return console.log("onAddAuthRedirect called with "+t+" and hash "+e),n=this.parseHash(e),console.log("params are: "+n.user_id+" and "+n.provider),this.trigger("user:authentication_added",n.provider)},isNew:function(){return!this.get("accessToken")},createGame:function(e){var t,i=this;return t=new n,this.isLoggedIn()?t.create(e):this.session.logInAsGuest().done(function(){return t.create(e)}).fail(function(){return i.trigger("error:createGame"),console.log(""+s+".createGame.fail()")}),t},isGuest:function(){return!!this.get("guest")},hasCurrentToken:function(){var e,t,n,i;return e=!1,this._tokenGutCheck()&&(t=(new Date).getTime(),n=parseInt(sessionStorage.expires_in),i=parseInt(sessionStorage.token_received),null!=n&&null!=i&&i+n>t?e=!0:n?this._nuke():e=!0),e},isLoggedIn:function(){return this.hasCurrentToken()},reset:function(e){return null!=e&&this.session.nuke().persistToken(e),this.clear().set(this.defaults()),this}})}),define("controllers/session_controller",["jquery","underscore","backbone","Handlebars"],function(e,t){var n,i,s;return s="controllers/session_controller",i="/oauth/authorize",n=function(n){var s=this;return this.options=n,this.user=this.options.app.user,this.cfg=this.options.app.cfg,t.bindAll(this,"onUserSync"),this.user.on("sync",this.onUserSync),this._authUrl=""+this.cfg.apiServer+i,e.ajaxSetup({type:"POST",timeout:5e3,headers:{"X-CSRF-Token":e('meta[name="csrf-token"]').attr("content"),Accept:"application/json"},dataType:"json",beforeSend:function(e){var t;return s.user.hasCurrentToken()?(t="Bearer "+s.user.get("accessToken"),e.setRequestHeader("Authorization",t)):void 0}}),this.user.hasCurrentToken()&&this.user.fetch(),this},n.prototype={signIn:function(){var t,n=this;return t=e.Deferred(),this.user.hasCurrentToken()&&!this.user.isGuest()?this.user.fetch().done(function(e){return t.resolve("Success",e)}).fail(function(e,n){return t.reject(n)}):e.ajax({url:this._authUrl,type:"POST",data:{grant_type:"password",response_type:"password",email:this.user.get("email"),password:this.user.get("password"),client_id:this.cfg.appId,client_secret:this.cfg.appSecret}}).done(function(e){return n._persistLocally(e),n.user.reset().fetch().done(function(e){return n.options.app.analytics.track("session","Successful Sign In"),t.resolve("Success",e)}).fail(function(e,i){return n.options.app.analytics.track("session","Failed Sign In"),t.reject(i)})}).fail(function(e,i){return n.user.trigger("error",n.user,e),t.reject(i)}),t.promise()},register:function(){var t,n=this;return t=e.Deferred(),this.user.save().done(function(){return n.signIn().done(function(e,i){return i.data.guest?n.options.app.analytics.track("session","Successful Guest Registration"):n.options.app.analytics.trackKeyMetric("session","Successful User Registration"),t.resolve("Success")}).fail(function(){return n.options.app.analytics.track("session","Failed Registration"),t.reject("Fail")})}),t.promise()},onUserSync:function(){},_buildExternalServiceUrl:function(e){var t,n,i,s;return i=encodeURIComponent(""+window.location.protocol+"//"+window.location.host+"/redirect.html"),t="provider="+e+"&",n=this.user.get("guest")?"guest_id="+this.user.get("id")+"&":"",s=""+this._authUrl+"?"+t+n+"client_id="+this.cfg.appId+"&redirect_uri="+i+"&response_type=token"},_parseHash:function(e){var t,n,i,s;for(n={},i=e.substring(1),s=/([^&=]+)=([^&]*)/g;t=s.exec(i);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return n},_persistLocally:function(e){return sessionStorage.access_token=e.access_token,sessionStorage.expires_in=null!=e.expires_in?1e3*e.expires_in:null,sessionStorage.token_received=(new Date).getTime(),sessionStorage.refresh_token=null!=e.refresh_token?e.refresh_token:null,this},logInAsGuest:function(){var t;return t=e.Deferred(),this.user.set({guest:!0}),this.register().done(function(){return t.resolve("Success")}).fail(function(){return t.reject("Fail")}),t.promise()},loginUsingOauth:function(e,n){var i,s,r,o;return s=window.screenLeft+50,r=window.screenTop+50,o=n.width,i=n.height,window.OAuthRedirect=t.bind(this.externalAuthServiceCallback,this),window.open(this._buildExternalServiceUrl(e),"Login","width="+o+", height="+i+", left="+s+", top="+r+", menubar=no")},nuke:function(){return delete sessionStorage.access_token,delete sessionStorage.expires_in,delete sessionStorage.token_received,delete sessionStorage.refresh_token,delete sessionStorage.guest,this},logOut:function(){return this.nuke(),this.user.reset(),this},persistToken:function(e){return this._persistLocally({access_token:e}),this},externalAuthServiceCallback:function(e){var t;return t=this._parseHash(e),t.access_token?(this.logOut(),this._persistLocally(t),this.user.reset(),this.user.fetch()):console.log("Odd Error, no token received but redirected"),this.options.app.analytics.track("session","Successful External Auth Login")}},n}),FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),FastClick.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(this.deviceIsIOS&&"file"===e.type||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},FastClick.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},FastClick.prototype.sendClick=function(e,t){var n,i;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),i=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},FastClick.prototype.focus=function(e){var t;this.deviceIsIOS&&e.setSelectionRange?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},FastClick.prototype.updateScrollParent=function(e){var t,n;if(t=e.fastClickScrollParent,!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},FastClick.prototype.onTouchStart=function(e){var t,n,i;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0],this.deviceIsIOS){if(i=window.getSelection(),i.rangeCount&&!i.isCollapsed)return!0;if(!this.deviceIsIOS4){if(n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<200&&e.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},FastClick.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(e){var t,n,i,s,r,o=this.targetElement;if(this.touchHasMoved(e)&&(this.trackingClick=!1,this.targetElement=null),!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;if(this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,this.deviceIsIOSWithBadTarget&&(r=e.changedTouches[0],o=document.elementFromPoint(r.pageX-window.pageXOffset,r.pageY-window.pageYOffset)||o,o.fastClickScrollParent=this.targetElement.fastClickScrollParent),i=o.tagName.toLowerCase(),"label"===i){if(t=this.findControl(o)){if(this.focus(o),this.deviceIsAndroid)return!1;o=t}}else if(this.needsFocus(o))return e.timeStamp-n>100||this.deviceIsIOS&&window.top!==window&&"input"===i?(this.targetElement=null,!1):(this.focus(o),this.deviceIsIOS4&&"select"===i||(this.targetElement=null,e.preventDefault()),!1);return this.deviceIsIOS&&!this.deviceIsIOS4&&(s=o.fastClickScrollParent,s&&s.fastClickLastScrollTop!==s.scrollTop)?!0:(this.needsClick(o)||(e.preventDefault(),this.sendClick(o,e)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(e){return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0:!0},FastClick.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},FastClick.prototype.destroy=function(){var e=this.layer;this.deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(e){var t;if("undefined"==typeof window.ontouchstart)return!0;if(/Chrome\/[0-9]+/.test(navigator.userAgent)){if(!FastClick.prototype.deviceIsAndroid)return!0;if(t=document.querySelector("meta[name=viewport]"),t&&-1!==t.content.indexOf("user-scalable=no"))return!0}return"none"===e.style.msTouchAction?!0:!1},FastClick.attach=function(e){return new FastClick(e)},"undefined"!=typeof define&&define.amd?define("fastclick",[],function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,define("core/main",["underscore","backbone","./config","./analytics","./mediator","./view","./router","entities/user","controllers/session_controller","fastclick"],function(e,t,n,i,s,r,o,a,l,c){var h,u;return u="core/main",h=function(){return this.cfg=n,e.extend(this,t.Events),this.user=new a,this},h.prototype={start:function(){return c.attach(document.body),this.analytics=new i(this.cfg),this.session=new l({app:this}),this.user.session=this.session,this.view=new r({app:this}),this.mediator=new s({app:this}),this.router=new o(this),t.history.start(),this}},new h}),define("core",["core/main"],function(e){return e}),define("text!dashboard/personality/core.hbs",[],function(){return'\n\n<div class="widget pressable">\n    <div class="hero clearfix">\n        {{#if logo_url}}\n            <img class="personalityBadge" src="/images/badges/{{logo_url}}" alt="{{name}}">\n        {{/if}}\n        {{{one_liner}}}\n    </div>\n    <ul>\n        {{#each bullet_description}}\n            <li>\n                <i class="icon-bookmark icon-2x"></i>\n                {{{ this }}}\n            </li>\n        {{/each}}\n    </ul>\n</div>\n\n\n'}),define("text!dashboard/widgets/base/loading.hbs",[],function(){return'\n\n<div class="widget loading">\n    <b class="holdPlease">\n        <i class="icon-repeat icon-large"></i>\n    </b>\n</div>\n\n\n'}),define("text!dashboard/widgets/base/base.hbs",[],function(){return'\n\n<div class="widget {{className}}">\n    {{#if title}}\n        <h3>{{title}}</h3>\n    {{/if}}\n</div>\n\n\n'}),define("dashboard/widgets/base/main",["backbone","Handlebars","text!./loading.hbs","text!./base.hbs"],function(e,t,n,i){var s,r,o;return o="dashboard/widget",r="holder",s=e.View.extend({className:r,tagName:"section",tmplBase:t.compile(i),initialize:function(){return this.model?(this.renderLoading(),this.listenTo(this.model,"sync",this.onSync),this.listenTo(this.model,"error",this.onErr)):this.collection?(this.renderLoading(),this.listenTo(this.collection,"sync",this.onSync),this.listenTo(this.collection,"error",this.onErr)):this.render(),this.$el.addClass(r),"function"==typeof this.start?this.start():void 0},render:function(){return this.tmpl?this.$el.html(this.tmpl):this.$el.html(i),this},onSync:function(){return this.collection&&0===this.collection.length?("function"==typeof this.close&&this.close(),this.remove()):this.model&&_.isEmpty(this.model.attributes)?("function"==typeof this.close&&this.close(),this.remove()):this.render()},onErr:function(){return console.warn(""+o+" Error with the widget's model, hiding the widget."),this.remove()},renderLoading:function(){return this.$el.html(n),this}})}),define("dashboard/widgets/base",["dashboard/widgets/base/main"],function(e){return e}),function(e){function t(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function n(){var e=require("util");return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}function i(e){for(var t=0,n=-1;-1!==(n=e.indexOf("\n",n+1));)t++;return t}function s(e,t){function n(e){this.len_after=e,this.name="close_"+t}var i=e+"_state",s="strong"==e?"em_state":"strong_state";return function(r){if(this[i][0]==t)return this[i].shift(),[r.length,new n(r.length-t.length)];var o=this[s].slice(),a=this[i].slice();this[i].unshift(t);var l=this.processInline(r.substr(t.length)),c=l[l.length-1];if(this[i].shift(),c instanceof n){l.pop();var h=r.length-c.len_after;return[h,[e].concat(l)]}return this[s]=o,this[i]=a,[t.length,t]}}function r(e){for(var t=e.split(""),n=[""],i=!1;t.length;){var s=t.shift();switch(s){case" ":i?n[n.length-1]+=s:n.push("");break;case"'":case'"':i=!i;break;case"\\":s=t.shift();default:n[n.length-1]+=s}}return n}function o(e){return g(e)&&e.length>1&&"object"==typeof e[1]&&!g(e[1])?e[1]:void 0}function l(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(e){if("string"==typeof e)return l(e);var t=e.shift(),n={},i=[];for(!e.length||"object"!=typeof e[0]||e[0]instanceof Array||(n=e.shift());e.length;)i.push(arguments.callee(e.shift()));var s="";for(var r in n)s+=" "+r+'="'+l(n[r])+'"';return"img"==t||"br"==t||"hr"==t?"<"+t+s+"/>":"<"+t+s+">"+i.join("")+"</"+t+">"}function h(e,t,n){var i;n=n||{};var s=e.slice(0);"function"==typeof n.preprocessTreeNode&&(s=n.preprocessTreeNode(s,t));var r=o(s);if(r){s[1]={};for(i in r)s[1][i]=r[i];r=s[1]}if("string"==typeof s)return s;switch(s[0]){case"header":s[0]="h"+s[1].level,delete s[1].level;break;case"bulletlist":s[0]="ul";break;case"numberlist":s[0]="ol";break;case"listitem":s[0]="li";break;case"para":s[0]="p";break;case"markdown":s[0]="html",r&&delete r.references;break;case"code_block":s[0]="pre",i=r?2:1;var a=["code"];a.push.apply(a,s.splice(i)),s[i]=a;break;case"inlinecode":s[0]="code";break;case"img":s[1].src=s[1].href,delete s[1].href;break;case"linebreak":s[0]="br";break;case"link":s[0]="a";break;case"link_ref":s[0]="a";var l=t[r.ref];if(!l)return r.original;delete r.ref,r.href=l.href,l.title&&(r.title=l.title),delete r.original;break;case"img_ref":s[0]="img";var l=t[r.ref];if(!l)return r.original;delete r.ref,r.src=l.href,l.title&&(r.title=l.title),delete r.original}if(i=1,r){for(var c in s[1])i=2;1===i&&s.splice(i,1)}for(;i<s.length;++i)s[i]=arguments.callee(s[i],t,n);return s}function u(e){for(var t=o(e)?2:1;t<e.length;)"string"==typeof e[t]?t+1<e.length&&"string"==typeof e[t+1]?e[t]+=e.splice(t+1,1)[0]:++t:(arguments.callee(e[t]),++t)}var d=e.Markdown=function v(e){switch(typeof e){case"undefined":this.dialect=v.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in v.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=v.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};e.parse=function(e,t){var n=new d(t);return n.toTree(e)},e.toHTML=function(t,n,i){var s=e.toHTMLTree(t,n,i);return e.renderJsonML(s)},e.toHTMLTree=function(e,t,n){"string"==typeof e&&(e=this.parse(e,t));var i=o(e),s={};i&&i.references&&(s=i.references);var r=h(e,s,n);return u(r),r};var f=d.mk_block=function(e,i,s){1==arguments.length&&(i="\n\n");var r=new String(e);return r.trailing=i,r.inspect=n,r.toSource=t,void 0!=s&&(r.lineNumber=s),r};d.prototype.split_blocks=function(e){var t,n=/([\s\S]+?)($|\n(?:\s*\n|$)+)/g,s=[],r=1;for(null!=(t=/^(\s*\n)/.exec(e))&&(r+=i(t[0]),n.lastIndex=t[0].length);null!==(t=n.exec(e));)s.push(f(t[1],t[2],r)),r+=i(t[0]);return s},d.prototype.processBlock=function(e,t){var n=this.dialect.block,i=n.__order__;if("__call__"in n)return n.__call__.call(this,e,t);for(var s=0;s<i.length;s++){var r=n[i[s]].call(this,e,t);if(r)return(!g(r)||r.length>0&&!g(r[0]))&&this.debug(i[s],"didn't return a proper array"),r}return[]},d.prototype.processInline=function(e){return this.dialect.inline.__call__.call(this,String(e))},d.prototype.toTree=function(e,t){var n=e instanceof Array?e:this.split_blocks(e),i=this.tree;try{for(this.tree=t||this.tree||["markdown"];n.length;){var s=this.processBlock(n.shift(),n);s.length&&this.tree.push.apply(this.tree,s)}return this.tree}finally{t&&(this.tree=i)}},d.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,e),"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(null,e)},d.prototype.loop_re_over_block=function(e,t,n){for(var i,s=t.valueOf();s.length&&null!=(i=e.exec(s));)s=s.substr(i[0].length),n.call(this,i);return s},d.dialects={},d.dialects.Gruber={block:{atxHeader:function(e,t){var n=e.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!n)return void 0;var i=["header",{level:n[1].length}];return Array.prototype.push.apply(i,this.processInline(n[2])),n[0].length<e.length&&t.unshift(f(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[i]},setextHeader:function(e,t){var n=e.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!n)return void 0;var i="="===n[2]?1:2,s=["header",{level:i},n[1]];return n[0].length<e.length&&t.unshift(f(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[s]},code:function(e,t){var n=[],i=/^(?: {0,3}\t| {4})(.*)\n?/;if(!e.match(i))return void 0;e:for(;;){var s=this.loop_re_over_block(i,e.valueOf(),function(e){n.push(e[1])});if(s.length){t.unshift(f(s,e.trailing));break e}if(!t.length)break e;if(!t[0].match(i))break e;n.push(e.trailing.replace(/[^\n]/g,"").substring(2)),e=t.shift()}return[["code_block",n.join("\n")]]},horizRule:function(e,t){var n=e.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!n)return void 0;var i=[["hr"]];return n[1]&&i.unshift.apply(i,this.processBlock(n[1],[])),n[3]&&t.unshift(f(n[3])),i},lists:function(){function e(e){return new RegExp("(?:^("+l+"{0,"+e+"} {0,3})("+r+")\\s+)|"+"(^"+l+"{0,"+(e-1)+"}[ ]{0,4})")}function t(e){return e.replace(/ {0,3}\t/g,"    ")}function n(e,t,n,i){if(t)return e.push(["para"].concat(n)),void 0;var s=e[e.length-1]instanceof Array&&"para"==e[e.length-1][0]?e[e.length-1]:e;i&&e.length>1&&n.unshift(i);for(var r=0;r<n.length;r++){var o=n[r],a="string"==typeof o;a&&s.length>1&&"string"==typeof s[s.length-1]?s[s.length-1]+=o:s.push(o)}}function i(e,t){for(var n=new RegExp("^("+l+"{"+e+"}.*?\\n?)*$"),i=new RegExp("^"+l+"{"+e+"}","gm"),s=[];t.length>0;){if(n.exec(t[0])){var r=t.shift(),o=r.replace(i,"");s.push(f(o,r.trailing,r.lineNumber))}break}return s}function s(e,t,n){var i=e.list,s=i[i.length-1];if(!(s[1]instanceof Array&&"para"==s[1][0]))if(t+1==n.length)s.push(["para"].concat(s.splice(1)));else{var r=s.pop();s.push(["para"].concat(s.splice(1)),r)}}var r="[*+-]|\\d+\\.",o=/[*+-]/,a=new RegExp("^( {0,3})("+r+")[ 	]+"),l="(?: {0,3}\\t| {4})";return function(r,l){function c(e){var t=o.exec(e[2])?["bulletlist"]:["numberlist"];return p.push({list:t,indent:e[1]}),t}var h=r.match(a);if(!h)return void 0;for(var u,d,p=[],f=c(h),g=!1,v=[p[0].list];;){for(var b=r.split(/(?=\n)/),y="",_=0;_<b.length;_++){var w="",k=b[_].replace(/^\n/,function(e){return w=e,""}),S=e(p.length);if(h=k.match(S),void 0!==h[1]){y.length&&(n(u,g,this.processInline(y),w),g=!1,y=""),h[1]=t(h[1]);var x=Math.floor(h[1].length/4)+1;if(x>p.length)f=c(h),u.push(f),u=f[1]=["listitem"];else{var C=!1;for(d=0;d<p.length;d++)if(p[d].indent==h[1]){f=p[d].list,p.splice(d+1),C=!0;break}C||(x++,x<=p.length?(p.splice(x),f=p[x-1].list):(f=c(h),u.push(f))),u=["listitem"],f.push(u)}w=""}k.length>h[0].length&&(y+=w+k.substr(h[0].length))}y.length&&(n(u,g,this.processInline(y),w),g=!1,y="");var P=i(p.length,l);P.length>0&&(m(p,s,this),u.push.apply(u,this.toTree(P,[])));var T=l[0]&&l[0].valueOf()||"";if(!T.match(a)&&!T.match(/^ /))break;r=l.shift();var E=this.dialect.block.horizRule(r,l);if(E){v.push.apply(v,E);break}m(p,s,this),g=!0}return v}}(),blockquote:function(e,t){if(!e.match(/^>/m))return void 0;var n=[];if(">"!=e[0]){for(var i=e.split(/\n/),s=[];i.length&&">"!=i[0][0];)s.push(i.shift());e=i.join("\n"),n.push.apply(n,this.processBlock(s.join("\n"),[]))}for(;t.length&&">"==t[0][0];){var r=t.shift();e=new String(e+e.trailing+r),e.trailing=r.trailing}var o=e.replace(/^> ?/gm,"");return this.tree,n.push(this.toTree(o,["blockquote"])),n},referenceDefn:function(e,t){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!e.match(n))return void 0;o(this.tree)||this.tree.splice(1,0,{});var i=o(this.tree);void 0===i.references&&(i.references={});var s=this.loop_re_over_block(n,e,function(e){e[2]&&"<"==e[2][0]&&">"==e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1));var t=i.references[e[1].toLowerCase()]={href:e[2]};void 0!==e[4]?t.title=e[4]:void 0!==e[5]&&(t.title=e[5])});return s.length&&t.unshift(f(s,e.trailing)),[]},para:function(e){return[["para"].concat(this.processInline(e))]}}},d.dialects.Gruber.inline={__oneElement__:function(e,t,n){var i,s;t=t||this.dialect.inline.__patterns__;var r=new RegExp("([\\s\\S]*?)("+(t.source||t)+")");if(i=r.exec(e),!i)return[e.length,e];if(i[1])return[i[1].length,i[1]];var s;return i[2]in this.dialect.inline&&(s=this.dialect.inline[i[2]].call(this,e.substr(i.index),i,n||[])),s=s||[i[2].length,i[2]]},__call__:function(e,t){function n(e){"string"==typeof e&&"string"==typeof s[s.length-1]?s[s.length-1]+=e:s.push(e)}for(var i,s=[];e.length>0;)i=this.dialect.inline.__oneElement__.call(this,e,t,s),e=e.substr(i.shift()),m(i,n);return s},"]":function(){},"}":function(){},"\\":function(e){return e.match(/^\\[\\`\*_{}\[\]()#\+.!\-]/)?[2,e[1]]:[1,"\\"]},"![":function(e){var t=e.match(/^!\[(.*?)\][ \t]*\([ \t]*(\S*)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(t){t[2]&&"<"==t[2][0]&&">"==t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.dialect.inline.__call__.call(this,t[2],/\\/)[0];var n={alt:t[1],href:t[2]||""};return void 0!==t[4]&&(n.title=t[4]),[t[0].length,["img",n]]}return t=e.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),t?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]},"[":function b(e){var t=String(e),n=d.DialectHelpers.inline_until_char.call(this,e.substr(1),"]");if(!n)return[1,"["];var b,i,s=1+n[0],r=n[1];e=e.substr(s);var o=e.match(/^\s*\([ \t]*(\S+)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(o){var a=o[1];if(s+=o[0].length,a&&"<"==a[0]&&">"==a[a.length-1]&&(a=a.substring(1,a.length-1)),!o[3])for(var l=1,c=0;c<a.length;c++)switch(a[c]){case"(":l++;break;case")":0==--l&&(s-=a.length-c,a=a.substring(0,c))}return a=this.dialect.inline.__call__.call(this,a,/\\/)[0],i={href:a||""},void 0!==o[3]&&(i.title=o[3]),b=["link",i].concat(r),[s,b]}return o=e.match(/^\s*\[(.*?)\]/),o?(s+=o[0].length,i={ref:(o[1]||String(r)).toLowerCase(),original:t.substr(0,s)},b=["link_ref",i].concat(r),[s,b]):1==r.length&&"string"==typeof r[0]?(i={ref:r[0].toLowerCase(),original:t.substr(0,s)},b=["link_ref",i,r[0]],[s,b]):[1,"["]},"<":function(e){var t;return null!=(t=e.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:"mailto"==t[2]?[t[0].length,["link",{href:t[1]},t[1].substr("mailto:".length)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function(e){var t=e.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",t[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}},d.dialects.Gruber.inline["**"]=s("strong","**"),d.dialects.Gruber.inline.__=s("strong","__"),d.dialects.Gruber.inline["*"]=s("em","*"),d.dialects.Gruber.inline._=s("em","_"),d.buildBlockOrder=function(e){var t=[];for(var n in e)"__order__"!=n&&"__call__"!=n&&t.push(n);e.__order__=t},d.buildInlinePatterns=function(e){var t=[];for(var n in e)if(!n.match(/^__.*__$/)){var i=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");t.push(1==n.length?i:"(?:"+i+")")}t=t.join("|"),e.__patterns__=t;var s=e.__call__;e.__call__=function(e,n){return void 0!=n?s.call(this,e,n):s.call(this,e,t)}},d.DialectHelpers={},d.DialectHelpers.inline_until_char=function(e,t){for(var n=0,i=[];;){if(e[n]==t)return n++,[n,i];if(n>=e.length)return null;res=this.dialect.inline.__oneElement__.call(this,e.substr(n)),n+=res[0],i.push.apply(i,res.slice(1))}},d.subclassDialect=function(e){function t(){}function n(){}return t.prototype=e.block,n.prototype=e.inline,{block:new t,inline:new n}},d.buildBlockOrder(d.dialects.Gruber.block),d.buildInlinePatterns(d.dialects.Gruber.inline),d.dialects.Maruku=d.subclassDialect(d.dialects.Gruber),d.dialects.Maruku.processMetaHash=function(e){for(var t=r(e),n={},i=0;i<t.length;++i)if(/^#/.test(t[i]))n.id=t[i].substring(1);else if(/^\./.test(t[i]))n["class"]=n["class"]?n["class"]+t[i].replace(/./," "):t[i].substring(1);else if(/\=/.test(t[i])){var s=t[i].split(/\=/);n[s[0]]=s[1]}return n},d.dialects.Maruku.block.document_meta=function(e){if(e.lineNumber>1)return void 0;if(!e.match(/^(?:\w+:.*\n)*\w+:.*$/))return void 0;o(this.tree)||this.tree.splice(1,0,{});var t=e.split(/\n/);for(p in t){var n=t[p].match(/(\w+):\s*(.*)$/),i=n[1].toLowerCase(),s=n[2];this.tree[1][i]=s}return[]},d.dialects.Maruku.block.block_meta=function(e){var t=e.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!t)return void 0;var n,i=this.dialect.processMetaHash(t[2]);if(""===t[1]){var s=this.tree[this.tree.length-1];if(n=o(s),"string"==typeof s)return void 0;n||(n={},s.splice(1,0,n));for(a in i)n[a]=i[a];return[]}var r=e.replace(/\n.*$/,""),l=this.processBlock(r,[]);n=o(l[0]),n||(n={},l[0].splice(1,0,n));for(a in i)n[a]=i[a];return l},d.dialects.Maruku.block.definition_list=function(e,t){var n,i=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,s=["dl"];if(!(a=e.match(i)))return void 0;for(var r=[e];t.length&&i.exec(t[0]);)r.push(t.shift());for(var o=0;o<r.length;++o){var a=r[o].match(i),l=a[1].replace(/\n$/,"").split(/\n/),c=a[2].split(/\n:\s+/);for(n=0;n<l.length;++n)s.push(["dt",l[n]]);for(n=0;n<c.length;++n)s.push(["dd"].concat(this.processInline(c[n].replace(/(\n)\s+/,"$1"))))}return[s]},d.dialects.Maruku.inline["{:"]=function(e,t,n){if(!n.length)return[2,"{:"];var i=n[n.length-1];if("string"==typeof i)return[2,"{:"];var s=e.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!s)return[2,"{:"];var r=this.dialect.processMetaHash(s[1]),a=o(i);a||(a={},i.splice(1,0,a));for(var l in r)a[l]=r[l];return[s[0].length,""]},d.buildBlockOrder(d.dialects.Maruku.block),d.buildInlinePatterns(d.dialects.Maruku.inline);var m,g=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};m=Array.prototype.forEach?function(e,t,n){return e.forEach(t,n)}:function(e,t,n){for(var i=0;i<e.length;i++)t.call(n||e,e[i],i,e)},e.renderJsonML=function(e,t){t=t||{},t.root=t.root||!1;var n=[];if(t.root)n.push(c(e));else for(e.shift(),!e.length||"object"!=typeof e[0]||e[0]instanceof Array||e.shift();e.length;)n.push(c(e.shift()));return n.join("\n\n")}}(function(){return"undefined"==typeof exports?(window.markdown={},window.markdown):exports}()),define("markdown",function(e){return function(){var t;return t||e.markdown}}(this)),define("text!ui_widgets/share.hbs",[],function(){return'\n\n\n<!--<button class="btn" type="button">-->\n    <!--Share-->\n    <!--<i class="icon-plus"></i>-->\n<!--</button>-->\n\n<!--<nav class="noDisplay">-->\n    <!--<b class="fluff arrowBottom"></b>-->\n    <i class="action-email icon-envelope" title="Share by Email"></i>\n    <i class="action-twitter icon-twitter" title="Share on Twitter"></i>\n    <i class="action-facebook icon-facebook" title="Share using Facebook"></i>\n<!--</nav>-->\n\n'}),define("entities/careBears/careBear",["classes/model"],function(e){var t,n;return n="entities/careBears/careBear",t=e.extend({initialize:function(){return this.on("error",this.onErr),this.on("invalid",this.onInvalid)},sync:function(){var e;if(this.url)return e=""+this.url+"?"+$.param(this.attributes),window.open(e)},onErr:function(){return console.error(""+n+": Trouble sharing")},onInvalid:function(e,t){return console.error(""+n+": Invalid: "+t)}})}),define("entities/careBears/facebook",["backbone","./careBear","core"],function(e,t,n){var i,s;return s="entities/careBears/facebook",i=t.extend({defaults:{app_id:n.cfg.fbId,redirect_uri:"https://alpha.tidepool.co/"+window.location.hash},url:"https://www.facebook.com/dialog/feed/",validate:function(e){return e.name?e.caption?e.link?(e.picture||console.warn("Facebook is better with .pictures"),null):"Need a link":"Need a caption":"Need a name"}})}),define("entities/careBears/twitter",["backbone","./careBear"],function(e,t){var n,i;return i="entities/careBears/twitter",n=t.extend({defaults:{related:"TidePoolInc"},url:"http://twitter.com/share",validate:function(e){return e.text?e.url?void 0:"Need url":"Need text"}})}),define("entities/careBears/mailto",["backbone","./careBear"],function(e,t){var n,i;return i="entities/careBears/mailto",n=t.extend({url:"mailto:",validate:function(e){return e.subject?e.body?void 0:"Need body":"Need subject"}})}),define("ui_widgets/share",["backbone","Handlebars","text!./share.hbs","entities/careBears/facebook","entities/careBears/twitter","entities/careBears/mailto","core"],function(e,t,n,i,s,r,o){var a,l,c,h;return c="ui_widgets/share",h="nav",l=".btn",a=e.View.extend({tagName:"aside",className:"share",events:{"click .action-facebook":"onClickFacebook","click .action-twitter":"onClickTwitter","click .action-email":"onClickMailto"},render:function(){return this.$el.html(n),this},onClickFacebook:function(e){var t;
return e.stopPropagation(),t=new i({picture:this.options.data.image,link:this.options.data.link,name:this.options.data.title,caption:this.options.data.text}),t.save(),o.analytics.trackKeyMetric(this.className,"clicked facebook")},onClickTwitter:function(e){var t;return e.stopPropagation(),t=new s({text:""+this.options.data.title+" -- ",url:this.options.data.link}),t.save(),o.analytics.trackKeyMetric(this.className,"clicked twitter")},onClickMailto:function(e){var t;return e.stopPropagation(),t=new r({subject:this.options.data.title,body:this.options.data.text}),t.save(),o.analytics.trackKeyMetric(this.className,"clicked mailto")}})}),define("dashboard/personality/core",["backbone","Handlebars","text!./core.hbs","dashboard/widgets/base","composite_views/perch","markdown","core","ui_widgets/share"],function(e,t,n,i,s,r,o,a){var l,c,h,u;return u=".widget",c="corePersonality",h=t.compile(n),l=i.extend({className:"doubleWide tall "+c,events:{"click .widget":"onClick"},render:function(){var e;return this.$el.html(h(this.model.attributes.profile_description)),e=new a({data:{title:"My personality is '"+this.model.attributes.profile_description.name+"'",text:"You can find out your personality, too, at https://alpha.tidepool.co",link:"https://alpha.tidepool.co",image:"https://alpha.tidepool.co/images/badges/"+this.model.attributes.profile_description.logo_url}}),this.$el.append(e.render().el),this},onClick:function(){var e;return e=r.toHTML(this.model.attributes.profile_description.description),s.show({large:!0,title:this.model.attributes.profile_description.name,msg:e,btn1Text:"Ok"})}}),l.dependsOn="entities/my/personality",l}),define("charts/chart_colors",[],function(){return["#35a589","#73829d","#e96267","#4c576a","#FABB3D","#b7b7b7"]}),define("charts/chart",["underscore","classes/model","Handlebars","./chart_colors"],function(e,t,n,i){var s;return s=t.extend({defaults:{name:"Default Chart Name",width:150,height:150,chartValues:[],colors:e.clone(i),options:{}},_prepareData:function(t){var n,s,r,o,a,l;for(s=[],n=0,r=e.map(t,function(e,t){return[t,e]}),r=e.sortBy(r,function(e){return e[0]}),a=0,l=r.length;l>a;a++)o=r[a],s.push({label:o[0],color:i[n],value:o[1]}),n++;return s},parse:function(e){return e=this.dewrap(e),e.chartValues=this._prepareData(e.chartValues),e}})}),define("text!charts/chart_with_swatches.hbs",[],function(){return'\n\n<canvas width="{{width}}" height="{{height}}"></canvas>\n<ul class="key">\n    {{#each chartValues}}\n        <li title="{{value}}">\n            <i class="swatch" style="background-color:{{color}}"></i>\n            {{label}}\n        </li>\n    {{/each}}\n </ul>\n\n'});var Chart=function(e){function t(e,t,n){return e=r((e-t.graphMin)/(t.steps*t.stepValue),1,0),n*t.steps*e}function n(e,t,n,i){function s(){l+=o;var c=e.animation?r(a(l),null,0):1;i.clearRect(0,0,h,u),e.scaleOverlay?(n(c),t()):(t(),n(c)),1>=l?b(s):"function"==typeof e.onAnimationComplete&&e.onAnimationComplete()}var o=e.animation?1/r(e.animationSteps,Number.MAX_VALUE,1):1,a=c[e.animationEasing],l=e.animation?0:1;"function"!=typeof t&&(t=function(){}),b(s)}function i(e,t,n,i,r,o){var a;for(e=Math.floor(Math.log(i-r)/Math.LN10),r=Math.floor(r/(1*Math.pow(10,e)))*Math.pow(10,e),i=Math.ceil(i/(1*Math.pow(10,e)))*Math.pow(10,e)-r,e=Math.pow(10,e),a=Math.round(i/e);n>a||a>t;)e=n>a?e/2:2*e,a=Math.round(i/e);return t=[],s(o,t,a,r,e),{steps:a,stepValue:e,graphMin:r,labels:t}}function s(e,t,n,i,s){if(e)for(var r=1;n+1>r;r++)t.push(a(e,{value:(i+s*r).toFixed(0!=s%1?s.toString().split(".")[1].length:0)}))}function r(e,t,n){return!isNaN(parseFloat(t))&&isFinite(t)&&e>t?t:!isNaN(parseFloat(n))&&isFinite(n)&&n>e?n:e}function o(e,t){var n,i={};for(n in e)i[n]=e[n];for(n in t)i[n]=t[n];return i}function a(e,t){var n=/\W/.test(e)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):y[e]=y[e]||a(document.getElementById(e).innerHTML);return t?n(t):n}var l=this,c={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-1*e*(e-2)},easeInOutQuad:function(e){return 1>(e/=.5)?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1*((e=e/1-1)*e*e+1)},easeInOutCubic:function(e){return 1>(e/=.5)?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-1*((e=e/1-1)*e*e*e-1)},easeInOutQuart:function(e){return 1>(e/=.5)?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return 1*(e/=1)*e*e*e*e},easeOutQuint:function(e){return 1*((e=e/1-1)*e*e*e*e+1)},easeInOutQuint:function(e){return 1>(e/=.5)?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return-1*Math.cos(e/1*(Math.PI/2))+1},easeOutSine:function(e){return 1*Math.sin(e/1*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e/1)-1)},easeInExpo:function(e){return 0==e?1:1*Math.pow(2,10*(e/1-1))},easeOutExpo:function(e){return 1==e?1:1*(-Math.pow(2,-10*e/1)+1)},easeInOutExpo:function(e){return 0==e?0:1==e?1:1>(e/=.5)?.5*Math.pow(2,10*(e-1)):.5*(-Math.pow(2,-10*--e)+2)},easeInCirc:function(e){return e>=1?e:-1*(Math.sqrt(1-(e/=1)*e)-1)},easeOutCirc:function(e){return 1*Math.sqrt(1-(e=e/1-1)*e)},easeInOutCirc:function(e){return 1>(e/=.5)?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){var t=1.70158,n=0,i=1;return 0==e?0:1==(e/=1)?1:(n||(n=.3),i<Math.abs(1)?(i=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(e-=1))*Math.sin(2*(1*e-t)*Math.PI/n)))},easeOutElastic:function(e){var t=1.70158,n=0,i=1;return 0==e?0:1==(e/=1)?1:(n||(n=.3),i<Math.abs(1)?(i=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*e)*Math.sin(2*(1*e-t)*Math.PI/n)+1)},easeInOutElastic:function(e){var t=1.70158,n=0,i=1;return 0==e?0:2==(e/=.5)?1:(n||(n=.3*1.5),i<Math.abs(1)?(i=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/i),1>e?-.5*i*Math.pow(2,10*(e-=1))*Math.sin(2*(1*e-t)*Math.PI/n):.5*i*Math.pow(2,-10*(e-=1))*Math.sin(2*(1*e-t)*Math.PI/n)+1)},easeInBack:function(e){return 1*(e/=1)*e*(2.70158*e-1.70158)},easeOutBack:function(e){return 1*((e=e/1-1)*e*(2.70158*e+1.70158)+1)},easeInOutBack:function(e){var t=1.70158;return 1>(e/=.5)?.5*e*e*(((t*=1.525)+1)*e-t):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:function(e){return 1-c.easeOutBounce(1-e)},easeOutBounce:function(e){return(e/=1)<1/2.75?7.5625*e*e:2/2.75>e?1*(7.5625*(e-=1.5/2.75)*e+.75):2.5/2.75>e?1*(7.5625*(e-=2.25/2.75)*e+.9375):1*(7.5625*(e-=2.625/2.75)*e+.984375)},easeInOutBounce:function(e){return.5>e?.5*c.easeInBounce(2*e):.5*c.easeOutBounce(2*e-1)+.5}},h=e.canvas.width,u=e.canvas.height;window.devicePixelRatio&&(e.canvas.style.width=h+"px",e.canvas.style.height=u+"px",e.canvas.height=u*window.devicePixelRatio,e.canvas.width=h*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio)),this.PolarArea=function(t,n){l.PolarArea.defaults={scaleOverlay:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleShowLine:!0,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animation:!0,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,onAnimationComplete:null};var i=n?o(l.PolarArea.defaults,n):l.PolarArea.defaults;return new d(t,i,e)},this.Radar=function(t,n){l.Radar.defaults={scaleOverlay:!1,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleShowLine:!0,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!1,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,angleShowLineOut:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:12,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,animation:!0,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null};var i=n?o(l.Radar.defaults,n):l.Radar.defaults;return new p(t,i,e)},this.Pie=function(t,n){l.Pie.defaults={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animation:!0,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,onAnimationComplete:null};var i=n?o(l.Pie.defaults,n):l.Pie.defaults;return new f(t,i,e)},this.Doughnut=function(t,n){l.Doughnut.defaults={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animation:!0,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,onAnimationComplete:null};var i=n?o(l.Doughnut.defaults,n):l.Doughnut.defaults;return new m(t,i,e)},this.Line=function(t,n){l.Line.defaults={scaleOverlay:!1,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:!0,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:2,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,animation:!0,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null};var i=n?o(l.Line.defaults,n):l.Line.defaults;return new g(t,i,e)},this.Bar=function(t,n){l.Bar.defaults={scaleOverlay:!1,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,animation:!0,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null};var i=n?o(l.Bar.defaults,n):l.Bar.defaults;return new v(t,i,e)};var d=function(e,r,o){var a,l,c,d,p,f,m,g,v;for(p=Math.min.apply(Math,[h,u])/2,p-=Math.max.apply(Math,[.5*r.scaleFontSize,.5*r.scaleLineWidth]),d=2*r.scaleFontSize,r.scaleShowLabelBackdrop&&(d+=2*r.scaleBackdropPaddingY,p-=1.5*r.scaleBackdropPaddingY),g=p,d=d?d:5,a=Number.MIN_VALUE,l=Number.MAX_VALUE,c=0;c<e.length;c++)e[c].value>a&&(a=e[c].value),e[c].value<l&&(l=e[c].value);c=Math.floor(g/(.66*d)),d=Math.floor(.5*(g/d)),v=r.scaleShowLabels?r.scaleLabel:null,r.scaleOverride?(m={steps:r.scaleSteps,stepValue:r.scaleStepWidth,graphMin:r.scaleStartValue,labels:[]},s(v,m.labels,m.steps,r.scaleStartValue,r.scaleStepWidth)):m=i(g,c,d,a,l,v),f=p/m.steps,n(r,function(){for(var e=0;e<m.steps;e++)if(r.scaleShowLine&&(o.beginPath(),o.arc(h/2,u/2,f*(e+1),0,2*Math.PI,!0),o.strokeStyle=r.scaleLineColor,o.lineWidth=r.scaleLineWidth,o.stroke()),r.scaleShowLabels){o.textAlign="center",o.font=r.scaleFontStyle+" "+r.scaleFontSize+"px "+r.scaleFontFamily;var t=m.labels[e];if(r.scaleShowLabelBackdrop){var n=o.measureText(t).width;o.fillStyle=r.scaleBackdropColor,o.beginPath(),o.rect(Math.round(h/2-n/2-r.scaleBackdropPaddingX),Math.round(u/2-f*(e+1)-.5*r.scaleFontSize-r.scaleBackdropPaddingY),Math.round(n+2*r.scaleBackdropPaddingX),Math.round(r.scaleFontSize+2*r.scaleBackdropPaddingY)),o.fill()}o.textBaseline="middle",o.fillStyle=r.scaleFontColor,o.fillText(t,h/2,u/2-f*(e+1))}},function(n){var i=-Math.PI/2,s=2*Math.PI/e.length,a=1,l=1;for(r.animation&&(r.animateScale&&(a=n),r.animateRotate&&(l=n)),n=0;n<e.length;n++)o.beginPath(),o.arc(h/2,u/2,a*t(e[n].value,m,f),i,i+l*s,!1),o.lineTo(h/2,u/2),o.closePath(),o.fillStyle=e[n].color,o.fill(),r.segmentShowStroke&&(o.strokeStyle=r.segmentStrokeColor,o.lineWidth=r.segmentStrokeWidth,o.stroke()),i+=l*s},o)},p=function(e,o,a){var l,c,d,p,f,m,g,v,b;for(e.labels||(e.labels=[]),f=Math.min.apply(Math,[h,u])/2,p=2*o.scaleFontSize,l=v=0;l<e.labels.length;l++)a.font=o.pointLabelFontStyle+" "+o.pointLabelFontSize+"px "+o.pointLabelFontFamily,c=a.measureText(e.labels[l]).width,c>v&&(v=c);for(f-=Math.max.apply(Math,[v,1.5*(o.pointLabelFontSize/2)]),f-=o.pointLabelFontSize,v=f=r(f,null,0),p=p?p:5,l=Number.MIN_VALUE,c=Number.MAX_VALUE,d=0;d<e.datasets.length;d++)for(b=0;b<e.datasets[d].data.length;b++)e.datasets[d].data[b]>l&&(l=e.datasets[d].data[b]),e.datasets[d].data[b]<c&&(c=e.datasets[d].data[b]);d=Math.floor(v/(.66*p)),p=Math.floor(.5*(v/p)),b=o.scaleShowLabels?o.scaleLabel:null,o.scaleOverride?(g={steps:o.scaleSteps,stepValue:o.scaleStepWidth,graphMin:o.scaleStartValue,labels:[]},s(b,g.labels,g.steps,o.scaleStartValue,o.scaleStepWidth)):g=i(v,d,p,l,c,b),m=f/g.steps,n(o,function(){var t=2*Math.PI/e.datasets[0].data.length;if(a.save(),a.translate(h/2,u/2),o.angleShowLineOut){a.strokeStyle=o.angleLineColor,a.lineWidth=o.angleLineWidth;for(var n=0;n<e.datasets[0].data.length;n++)a.rotate(t),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-f),a.stroke()}for(n=0;n<g.steps;n++){if(a.beginPath(),o.scaleShowLine){a.strokeStyle=o.scaleLineColor,a.lineWidth=o.scaleLineWidth,a.moveTo(0,-m*(n+1));for(var i=0;i<e.datasets[0].data.length;i++)a.rotate(t),a.lineTo(0,-m*(n+1));a.closePath(),a.stroke()}o.scaleShowLabels&&(a.textAlign="center",a.font=o.scaleFontStyle+" "+o.scaleFontSize+"px "+o.scaleFontFamily,a.textBaseline="middle",o.scaleShowLabelBackdrop&&(i=a.measureText(g.labels[n]).width,a.fillStyle=o.scaleBackdropColor,a.beginPath(),a.rect(Math.round(-i/2-o.scaleBackdropPaddingX),Math.round(-m*(n+1)-.5*o.scaleFontSize-o.scaleBackdropPaddingY),Math.round(i+2*o.scaleBackdropPaddingX),Math.round(o.scaleFontSize+2*o.scaleBackdropPaddingY)),a.fill()),a.fillStyle=o.scaleFontColor,a.fillText(g.labels[n],0,-m*(n+1)))}for(n=0;n<e.labels.length;n++){a.font=o.pointLabelFontStyle+" "+o.pointLabelFontSize+"px "+o.pointLabelFontFamily,a.fillStyle=o.pointLabelFontColor;var i=Math.sin(t*n)*(f+o.pointLabelFontSize),s=Math.cos(t*n)*(f+o.pointLabelFontSize);a.textAlign=t*n==Math.PI||0==t*n?"center":t*n>Math.PI?"right":"left",a.textBaseline="middle",a.fillText(e.labels[n],i,-s)}a.restore()},function(n){var i=2*Math.PI/e.datasets[0].data.length;a.save(),a.translate(h/2,u/2);for(var s=0;s<e.datasets.length;s++){a.beginPath(),a.moveTo(0,-1*n*t(e.datasets[s].data[0],g,m));for(var r=1;r<e.datasets[s].data.length;r++)a.rotate(i),a.lineTo(0,-1*n*t(e.datasets[s].data[r],g,m));if(a.closePath(),a.fillStyle=e.datasets[s].fillColor,a.strokeStyle=e.datasets[s].strokeColor,a.lineWidth=o.datasetStrokeWidth,a.fill(),a.stroke(),o.pointDot)for(a.fillStyle=e.datasets[s].pointColor,a.strokeStyle=e.datasets[s].pointStrokeColor,a.lineWidth=o.pointDotStrokeWidth,r=0;r<e.datasets[s].data.length;r++)a.rotate(i),a.beginPath(),a.arc(0,-1*n*t(e.datasets[s].data[r],g,m),o.pointDotRadius,2*Math.PI,!1),a.fill(),a.stroke();a.rotate(i)}a.restore()},a)},f=function(e,t,i){for(var s=0,r=Math.min.apply(Math,[u/2,h/2])-5,o=0;o<e.length;o++)s+=e[o].value;n(t,null,function(n){var o=-Math.PI/2,a=1,l=1;for(t.animation&&(t.animateScale&&(a=n),t.animateRotate&&(l=n)),n=0;n<e.length;n++){var c=2*(l*e[n].value/s)*Math.PI;i.beginPath(),i.arc(h/2,u/2,a*r,o,o+c),i.lineTo(h/2,u/2),i.closePath(),i.fillStyle=e[n].color,i.fill(),t.segmentShowStroke&&(i.lineWidth=t.segmentStrokeWidth,i.strokeStyle=t.segmentStrokeColor,i.stroke()),o+=c}},i)},m=function(e,t,i){for(var s=0,r=Math.min.apply(Math,[u/2,h/2])-5,o=r*(t.percentageInnerCutout/100),a=0;a<e.length;a++)s+=e[a].value;n(t,null,function(n){var a=-Math.PI/2,l=1,c=1;for(t.animation&&(t.animateScale&&(l=n),t.animateRotate&&(c=n)),n=0;n<e.length;n++){var d=2*(c*e[n].value/s)*Math.PI;i.beginPath(),i.arc(h/2,u/2,l*r,a,a+d,!1),i.arc(h/2,u/2,l*o,a+d,a,!0),i.closePath(),i.fillStyle=e[n].color,i.fill(),t.segmentShowStroke&&(i.lineWidth=t.segmentStrokeWidth,i.strokeStyle=t.segmentStrokeColor,i.stroke()),a+=d}},i)},g=function(e,r,o){var a,l,c,d,p,f,m,g,v,b,y,_,w,k=0;for(p=u,o.font=r.scaleFontStyle+" "+r.scaleFontSize+"px "+r.scaleFontFamily,b=1,d=0;d<e.labels.length;d++)a=o.measureText(e.labels[d]).width,b=a>b?a:b;for(h/e.labels.length<b?(k=45,h/e.labels.length<Math.cos(k)*b?(k=90,p-=b):p-=Math.sin(k)*b):p-=r.scaleFontSize,d=r.scaleFontSize,p=p-5-d,a=Number.MIN_VALUE,l=Number.MAX_VALUE,c=0;c<e.datasets.length;c++)for(g=0;g<e.datasets[c].data.length;g++)e.datasets[c].data[g]>a&&(a=e.datasets[c].data[g]),e.datasets[c].data[g]<l&&(l=e.datasets[c].data[g]);if(c=Math.floor(p/(.66*d)),d=Math.floor(.5*(p/d)),g=r.scaleShowLabels?r.scaleLabel:"",r.scaleOverride?(m={steps:r.scaleSteps,stepValue:r.scaleStepWidth,graphMin:r.scaleStartValue,labels:[]},s(g,m.labels,m.steps,r.scaleStartValue,r.scaleStepWidth)):m=i(p,c,d,a,l,g),f=Math.floor(p/m.steps),d=1,r.scaleShowLabels){for(o.font=r.scaleFontStyle+" "+r.scaleFontSize+"px "+r.scaleFontFamily,a=0;a<m.labels.length;a++)l=o.measureText(m.labels[a]).width,d=l>d?l:d;d+=10}y=h-d-b,v=Math.floor(y/(e.labels.length-1)),_=h-b/2-y,w=p+r.scaleFontSize/2,n(r,function(){o.lineWidth=r.scaleLineWidth,o.strokeStyle=r.scaleLineColor,o.beginPath(),o.moveTo(h-b/2+5,w),o.lineTo(h-b/2-y-5,w),o.stroke(),k>0?(o.save(),o.textAlign="right"):o.textAlign="center",o.fillStyle=r.scaleFontColor;for(var t=0;t<e.labels.length;t++)o.save(),k>0?(o.translate(_+t*v,w+r.scaleFontSize),o.rotate(-(k*(Math.PI/180))),o.fillText(e.labels[t],0,0),o.restore()):o.fillText(e.labels[t],_+t*v,w+r.scaleFontSize+3),o.beginPath(),o.moveTo(_+t*v,w+3),r.scaleShowGridLines&&t>0?(o.lineWidth=r.scaleGridLineWidth,o.strokeStyle=r.scaleGridLineColor,o.lineTo(_+t*v,5)):o.lineTo(_+t*v,w+3),o.stroke();for(o.lineWidth=r.scaleLineWidth,o.strokeStyle=r.scaleLineColor,o.beginPath(),o.moveTo(_,w+5),o.lineTo(_,5),o.stroke(),o.textAlign="right",o.textBaseline="middle",t=0;t<m.steps;t++)o.beginPath(),o.moveTo(_-3,w-(t+1)*f),r.scaleShowGridLines?(o.lineWidth=r.scaleGridLineWidth,o.strokeStyle=r.scaleGridLineColor,o.lineTo(_+y+5,w-(t+1)*f)):o.lineTo(_-.5,w-(t+1)*f),o.stroke(),r.scaleShowLabels&&o.fillText(m.labels[t],_-8,w-(t+1)*f)},function(n){function i(i,s){return w-n*t(e.datasets[i].data[s],m,f)}for(var s=0;s<e.datasets.length;s++){o.strokeStyle=e.datasets[s].strokeColor,o.lineWidth=r.datasetStrokeWidth,o.beginPath(),o.moveTo(_,w-n*t(e.datasets[s].data[0],m,f));for(var a=1;a<e.datasets[s].data.length;a++)r.bezierCurve?o.bezierCurveTo(_+v*(a-.5),i(s,a-1),_+v*(a-.5),i(s,a),_+v*a,i(s,a)):o.lineTo(_+v*a,i(s,a));if(o.stroke(),r.datasetFill?(o.lineTo(_+v*(e.datasets[s].data.length-1),w),o.lineTo(_,w),o.closePath(),o.fillStyle=e.datasets[s].fillColor,o.fill()):o.closePath(),r.pointDot)for(o.fillStyle=e.datasets[s].pointColor,o.strokeStyle=e.datasets[s].pointStrokeColor,o.lineWidth=r.pointDotStrokeWidth,a=0;a<e.datasets[s].data.length;a++)o.beginPath(),o.arc(_+v*a,w-n*t(e.datasets[s].data[a],m,f),r.pointDotRadius,0,2*Math.PI,!0),o.fill(),o.stroke()}},o)},v=function(e,r,o){var a,l,c,d,p,f,m,g,v,b,y,_,w,k,S=0;for(p=u,o.font=r.scaleFontStyle+" "+r.scaleFontSize+"px "+r.scaleFontFamily,b=1,d=0;d<e.labels.length;d++)a=o.measureText(e.labels[d]).width,b=a>b?a:b;for(h/e.labels.length<b?(S=45,h/e.labels.length<Math.cos(S)*b?(S=90,p-=b):p-=Math.sin(S)*b):p-=r.scaleFontSize,d=r.scaleFontSize,p=p-5-d,a=Number.MIN_VALUE,l=Number.MAX_VALUE,c=0;c<e.datasets.length;c++)for(g=0;g<e.datasets[c].data.length;g++)e.datasets[c].data[g]>a&&(a=e.datasets[c].data[g]),e.datasets[c].data[g]<l&&(l=e.datasets[c].data[g]);if(c=Math.floor(p/(.66*d)),d=Math.floor(.5*(p/d)),g=r.scaleShowLabels?r.scaleLabel:"",r.scaleOverride?(m={steps:r.scaleSteps,stepValue:r.scaleStepWidth,graphMin:r.scaleStartValue,labels:[]},s(g,m.labels,m.steps,r.scaleStartValue,r.scaleStepWidth)):m=i(p,c,d,a,l,g),f=Math.floor(p/m.steps),d=1,r.scaleShowLabels){for(o.font=r.scaleFontStyle+" "+r.scaleFontSize+"px "+r.scaleFontFamily,a=0;a<m.labels.length;a++)l=o.measureText(m.labels[a]).width,d=l>d?l:d;d+=10}y=h-d-b,v=Math.floor(y/e.labels.length),k=(v-2*r.scaleGridLineWidth-2*r.barValueSpacing-(r.barDatasetSpacing*e.datasets.length-1)-(r.barStrokeWidth/2*e.datasets.length-1))/e.datasets.length,_=h-b/2-y,w=p+r.scaleFontSize/2,n(r,function(){o.lineWidth=r.scaleLineWidth,o.strokeStyle=r.scaleLineColor,o.beginPath(),o.moveTo(h-b/2+5,w),o.lineTo(h-b/2-y-5,w),o.stroke(),S>0?(o.save(),o.textAlign="right"):o.textAlign="center",o.fillStyle=r.scaleFontColor;for(var t=0;t<e.labels.length;t++)o.save(),S>0?(o.translate(_+t*v,w+r.scaleFontSize),o.rotate(-(S*(Math.PI/180))),o.fillText(e.labels[t],0,0),o.restore()):o.fillText(e.labels[t],_+t*v+v/2,w+r.scaleFontSize+3),o.beginPath(),o.moveTo(_+(t+1)*v,w+3),o.lineWidth=r.scaleGridLineWidth,o.strokeStyle=r.scaleGridLineColor,o.lineTo(_+(t+1)*v,5),o.stroke();for(o.lineWidth=r.scaleLineWidth,o.strokeStyle=r.scaleLineColor,o.beginPath(),o.moveTo(_,w+5),o.lineTo(_,5),o.stroke(),o.textAlign="right",o.textBaseline="middle",t=0;t<m.steps;t++)o.beginPath(),o.moveTo(_-3,w-(t+1)*f),r.scaleShowGridLines?(o.lineWidth=r.scaleGridLineWidth,o.strokeStyle=r.scaleGridLineColor,o.lineTo(_+y+5,w-(t+1)*f)):o.lineTo(_-.5,w-(t+1)*f),o.stroke(),r.scaleShowLabels&&o.fillText(m.labels[t],_-8,w-(t+1)*f)},function(n){o.lineWidth=r.barStrokeWidth;for(var i=0;i<e.datasets.length;i++){o.fillStyle=e.datasets[i].fillColor,o.strokeStyle=e.datasets[i].strokeColor;for(var s=0;s<e.datasets[i].data.length;s++){var a=_+r.barValueSpacing+v*s+k*i+r.barDatasetSpacing*i+r.barStrokeWidth*i;o.beginPath(),o.moveTo(a,w),o.lineTo(a,w-n*t(e.datasets[i].data[s],m,f)+r.barStrokeWidth/2),o.lineTo(a+k,w-n*t(e.datasets[i].data[s],m,f)+r.barStrokeWidth/2),o.lineTo(a+k,w),r.barShowStroke&&o.stroke(),o.closePath(),o.fill()}}},o)},b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},y={}};define("chart",function(e){return function(){var t;return t||e.Chart}}(this)),define("charts/polar_area",["backbone","Handlebars","./chart","text!./chart_with_swatches.hbs","chart"],function(e,t,n,i){var s,r;return r="canvas",s=e.View.extend({tmpl:t.compile(i),className:"chart polarArea",initialize:function(){return this.model=new n(this.options.data,{parse:!0})},render:function(){return this.$el.html(this.tmpl(this.model.attributes)),this._renderChart(this.model.attributes.chartValues),this},_renderChart:function(e){var t,n,i,s,o;return(t=this.$(r))?(s=_.max(e,function(e){return e.value}),s=Math.ceil(s.value),o=_.extend(this.model.attributes.options,{scaleShowLine:!1,scaleShowLabels:!1,scaleOverride:!0,scaleSteps:s,scaleStepWidth:1,scaleStartValue:0}),i=t[0].getContext("2d"),n=new Chart(i).PolarArea(e,o)):void 0}})}),define("dashboard/personality/big5",["backbone","dashboard/widgets/base","composite_views/perch","charts/polar_area"],function(e,t,n,i){var s,r,o;return o=".widget",r="Personality",s=t.extend({events:{"click .widget":"onClick"},className:"chart-big5",render:function(){return this.$el.html(this.tmplBase({title:r,className:"pressable"})),this.chart=new i({data:{name:r,chartValues:this.model.attributes.big5_score,options:{animation:!1}}}),this.$(o).append(this.chart.render().el),this},onClick:function(){return n.show({title:r,large:!0,btn1Text:null,content:new i({data:{name:r,chartValues:this.model.attributes.big5_score,width:450,height:300}})})}}),s.dependsOn="entities/my/personality",s}),define("charts/doughnut",["backbone","Handlebars","./chart","text!./chart_with_swatches.hbs","chart"],function(e,t,n,i){var s,r;return r="canvas",s=e.View.extend({tmpl:t.compile(i),className:"chart doughnut",initialize:function(){if(!this.options.data)throw new Error("Need options.data");return this.model=new n(this.options.data,{parse:!0})},render:function(){return this.$el.html(this.tmpl(this.model.attributes)),this._renderChart(this.model.attributes.chartValues),this},_renderChart:function(e){var t,n,i,s;return(t=this.$(r))?(s=_.extend(this.model.attributes.options,{percentageInnerCutout:33}),i=t[0].getContext("2d"),n=new Chart(i).Doughnut(e,s)):void 0}})}),define("dashboard/personality/holland6",["backbone","dashboard/widgets/base","composite_views/perch","charts/doughnut"],function(e,t,n,i){var s,r,o;return o=".widget",r="Interests",s=t.extend({events:{"click .widget":"onClick"},className:"chart-holland6",render:function(){return this.$el.html(this.tmplBase({title:r,className:"pressable"})),this.chart=new i({data:{name:r,chartValues:this.model.attributes.holland6_score,options:{animation:!1}}}),this.$(o).append(this.chart.render().el),this},onClick:function(){return n.show({title:r,large:!0,btn1Text:null,content:new i({data:{name:r,chartValues:this.model.attributes.holland6_score,width:450,height:300}})})}}),s.dependsOn="entities/my/personality",s}),define("text!dashboard/personality/detailed_report.hbs",[],function(){return'\n\n<div class="widget hasFooter pressable">\n    <h3>Personality Report</h3>\n    <!--<b class="dogEar"></b>-->\n    <br/>\n    <p class="small">\n        Seize control of your unconscious cognitive stengths with a personality report today!\n    </p>\n    <i class="icon icon-documents-circle"></i>\n    <div class="footer">Pre-Order Now</div>\n</div>\n\n'}),define("composite_views/perch-psst",["jquery","backbone","Handlebars","./perch"],function(e,t,n,i){var s,r,o,a;return a="composite_views/perch-psst",r="#PerchBody",o=n.compile('    <p class="row">      <i class="icon-2x {{icon}}"></i>    </p>  '),s=i.Klass.extend({_showOptionsObject:function(e){var t;return e.btn1Text=null,e.content="",e.icon&&(e.content+=o(e)),e.msg&&(e.content+="<p class='large'>"+e.msg+"</p>"),e.content="<div class='highlight'>"+e.content+"</div>",this.model.set(e),this._bindDomEvents(),t=e.mustUseButton?"static":!0,this.$el.modal({backdrop:t})}}),new s}),define("dashboard/personality/detailed_report",["backbone","dashboard/widgets/base","text!./detailed_report.hbs","composite_views/perch-psst","core"],function(e,t,n,i,s){var r,o;return o="detailedReport",r=t.extend({className:o,events:{"click .widget":"onClick"},render:function(){return this.$el.html(n),this},onClick:function(){var e;return e=s.user.attributes.email?"Thanks for your interest, we'll notify you at <strong>"+s.user.attributes.email+"</strong> when your report is available":"Thanks for your interest, we'll notify you when your report is available",i.show({msg:e,icon:"icon-ok"}),$.ajax({url:""+s.cfg.apiServer+"/api/v1/users/-/preorders",type:"POST"}).fail(function(){throw new Error("Failed to send preorder for "+s.user.attributes.email)})}})}),define("text!dashboard/personality/recommendation.hbs",[],function(){return'\n<div class="widget featured pressable">\n    <h3>Daily Recomendations</h3>\n    <br/>\n    <p>Today\'s recommendation has been specifically selected for your personality type!</p>\n    <i class="icon icon-bulb-circle"></i>\n</div>\n\n\n'}),define("text!dashboard/personality/recommendation-details.hbs",[],function(){return'\n<div class="dailyReccDetails">\n\n    <hgroup>\n        <i class="icon icon-bulb-circle pull-left"></i>\n        <h2 class="title">Daily Recommendation</h2>\n        <p class="strong">\n            Based on your personality, TidePool recommends this <em>{{link_type}}</em>.\n        </p>\n    </hgroup>\n\n    <p>{{sentence}}</p>\n    {{#if link}}\n        <a href="{{link}}" id="ActionRecommendationLink" class="footer" target="_blank">\n            <i class="linkType {{icon}}"></i>\n            <span class="icon-stack pull-right">\n                <i class="icon-circle-blank icon-stack-base"></i>\n                <i class="icon-arrow-right"></i>\n            </span>\n            {{link_title}}\n        </a>\n    {{/if}}\n\n</div>\n\n\n\n'}),define("dashboard/personality/recommendation",["backbone","Handlebars","dashboard/widgets/base","text!./recommendation.hbs","text!./recommendation-details.hbs","composite_views/perch","core"],function(e,t,n,i,s,r,o){var a,l,c,h;return l="recommendation",c="#ActionRecommendationLink",h=t.compile(s),a=n.extend({className:l,events:{"click .widget":"onClick"},render:function(){var e;switch(this.$el.html(i),e=this.model.attributes,e.link_type){case"Book":e.icon="icon-book";break;case"App":e.icon="icon-cloud-download";break;case"Video":e.icon="icon-youtube-play";break;case"Comic":e.icon="icon-smile";break;case"Lecture":e.icon="icon-bullhorn"}return this._detailsMarkup=h(e),this},onSync:function(e){return e.attributes.sentence?this.render():void 0},onClick:function(){return this._detailsMarkup?(r.show({content:this._detailsMarkup,btn1Text:null,supressTracking:!0,large:!0}),o.analytics.track(l,"Shown"),$(c).one("click",this.onReccClick)):void 0},onReccClick:function(){return o.analytics.track(l,"External Link Clicked")}}),a.dependsOn="entities/my/recommendations",a}),define("text!dashboard/career/jobs.hbs",[],function(){return'\n\n<div class="widget">\n    <h3>Career Recommendations</h3>\n\n\n    <p class="intro fullWidth">\n        <i class="bottomIcon icon-briefcase"></i>\n        Based on your personality and interests, you are best suited for careers such as:\n    </p>\n\n    <hr>\n\n    <p class="large recommendation">\n        {{commaList careers}}\n    </p>\n\n</div>\n\n\n'}),define("dashboard/career/jobs",["backbone","Handlebars","text!./jobs.hbs","dashboard/widgets/base","ui_widgets/share"],function(e,t,n,i,s){var r,o;return t.registerHelper("commaList",function(e){var t,n,i,s;for(n="",i=0,s=e.length;s>i;i++)t=e[i],n+=""+t+", ";return n.slice(0,-2)}),o=t.compile(n),r=i.extend({className:"holder doubleWide coolTones career-jobs",events:{"click .icon-briefcase":"onClickBriefcase"},render:function(){var e;return this.$el.html(o(this.model.attributes)),e=new s({data:{title:"My recommended careers are: '"+t.helpers.commaList(this.model.attributes.careers)+"'",text:"You can find out your recommended careers, too, at https://alpha.tidepool.co",link:"https://alpha.tidepool.co"}}),this.$el.append(e.render().el),this},onClickBriefcase:function(){return console.log("Magical briefcase clicked")}}),r.dependsOn="entities/my/career",r}),define("text!dashboard/widgets/lister/lister.hbs",[],function(){return'\n\n<div class="widget lister">\n    <h3>{{title}}</h3>\n\n    <ul {{#icon}}class="icons-ul"{{/icon}}>\n        {{#list}}\n            <li>\n                {{#../icon}}<i class="icon-li icon-ok {{../icon}}"></i>{{/../icon}}{{this}}\n            </li>\n        {{/list}}\n    </ul>\n</div>\n\n\n'}),define("dashboard/widgets/lister/main",["backbone","Handlebars","text!./lister.hbs","dashboard/widgets/base"],function(e,t,n,i){var s,r;return r=t.compile(n),s=i.extend({tagName:"section",renderList:function(e){return e.list&&e.title||console.error("Need data.list and data.title"),this.$el.html(r(e)),this}})}),define("dashboard/widgets/lister",["dashboard/widgets/lister/main"],function(e){return e}),define("dashboard/career/skills",["backbone","dashboard/widgets/lister"],function(e,t){var n;return n=t.extend({className:"coolTones",render:function(){return this.renderList({title:"Skills to Work On",icon:"icon-ok",list:this.model.attributes.skills}),this}}),n.dependsOn="entities/my/career",n}),define("dashboard/career/tools",["backbone","dashboard/widgets/lister"],function(e,t){var n,i;return i=n=t.extend({className:"coolTones",render:function(){return this.renderList({title:"Tools of the Trade",list:this.model.attributes.tools}),this}}),n.dependsOn="entities/my/career",n}),define("text!dashboard/career/reaction_results.hbs",[],function(){return'\n\n<a class="widget hasFooter" href="#game/reaction_time">\n    <h3>Latest Results</h3>\n    <div class="contents"></div>\n    <div class="footer">Play Again</div>\n</a>\n\n\n'
}),define("game/results/base",["backbone","Handlebars"],function(e,t){var n,i,s;return s="game/results/base",i="result",t.registerHelper("prettyDate",function(e){var t;return t=new Date(e),t.toLocaleDateString()}),t.registerHelper("prettyTime",function(e){var t;return t=new Date(e),t.toLocaleTimeString()}),n=e.View.extend({className:i,initialize:function(){return this.$el.addClass(i),"function"==typeof this.start?this.start():void 0},render:function(){return null==this.model?this:(this.$el.html(this.tmpl(this.model.attributes)),this)}})}),define("text!game/results/reaction_time.hbs",[],function(){return'\n{{#if showTime}}\n    <p class="subTitle">\n        {{prettyTime time_played}}\n        {{prettyDate time_played}}\n    </p>\n{{/if}}\n\n<div class="metricHolder {{#if showTime}}showingTimeAndTitle{{/if}}">\n    <div class="colHalves">\n        <div class="metric good up" title="Fastest: {{score.fastest_time}}ms">\n            <div class="holder">\n                <small>Fastest</small>\n                <label>\n                    {{score.fastest_time}}\n                </label>\n                <small>Milliseconds</small>\n            </div>\n        </div>\n    </div>\n    <div class="colHalves">\n        <div class="metric bad down" title="Slowest: {{score.slowest_time}}ms">\n            <div class="holder">\n                <small>Slowest</small>\n                <label>\n                    {{score.slowest_time}}\n                </label>\n                <small>Milliseconds</small>\n            </div>\n        </div>\n    </div>\n\n</div>\n\n\n\n'}),define("game/results/reaction_time",["backbone","Handlebars","game/results/base","text!./reaction_time.hbs"],function(e,t,n,i){var s;return s=n.extend({className:"reactionTime",tmpl:t.compile(i)})}),define("dashboard/career/reaction_results",["backbone","Handlebars","text!./reaction_results.hbs","dashboard/widgets/base","game/results/reaction_time"],function(e,t,n,i,s){var r,o,a;return a=t.compile(n),o=".contents",r=i.extend({className:"coolTones reaction-results",render:function(){var e,t;return this.$el.html(a),e=this.collection.at(this.collection.length-1),e.set("showTime",!0),t=new s({model:e}),this.$(o).html(t.render().el),this}}),r.dependsOn="entities/results/results",r.fetchOptions={data:{type:"ReactionTimeResult"}},r}),define("text!dashboard/career/reaction_history.hbs",[],function(){return'\n\n<div class="widget">\n    <h3>Reaction Time History</h3>\n\n</div>\n\n\n'}),define("text!game/results/reaction_time_history.hbs",[],function(){return'\n\n<div class="chartHolder">\n    <ul class="results barChart">\n        {{#results}}\n            <li class="bar fastest"\n                style="height: {{normalizeReactionTime score.fastest_time}}%"\n                title="<span class=\'score\'>{{score.fastest_time}}ms</span>\n                        <span class=\'date\'>{{prettyTime time_played}}<br/>{{prettyDate time_played}}</span>">\n            </li>\n        {{/results}}\n    </ul>\n</div>\n<div class="divider">\n    <b class="rule"></b>\n    <p>Time</p>\n    <b class="rule"></b>\n</div>\n\n'}),define("game/results/reaction_time_history",["backbone","Handlebars","game/results/base","text!./reaction_time_history.hbs"],function(e,t,n,i){var s,r,o,a,l,c;return o=".chartHolder",r=".bar",c=50,a="game/results/reaction_time_history",l=190,s=n.extend({className:"reactionTimeHistory",render:function(){return null==this.collection&&console.error("Need a collection"),this.listenTo(this.collection,"sync",this.renderChart),this},renderChart:function(){var e=this;return this.collection.length?(this._compileTemplateForData(),this.$el.html(this.tmpl({max:this.collection.max,min:this.collection.min,results:this.collection.toJSON()})),this._addCallbackToTooltipShow(),this.$(r).tooltip({placement:"right",container:"body",html:!0,animation:!1,afterShow:_.bind(this.onTooltipShow,this)}),setTimeout(function(){return e.$(o).scrollLeft(9999)},c)):(this.remove(),void 0)},_addCallbackToTooltipShow:function(){var e;return e=$.fn.tooltip.Constructor.prototype.show,$.fn.tooltip.Constructor.prototype.show=function(){var t;return e.call(this),"function"==typeof(t=this.options).afterShow?t.afterShow(this.$tip,this.$element):void 0}},_compileTemplateForData:function(){var e;return null!=this.collection.at(0).attributes.score?(e=this.collection.max(function(e){return e.attributes.score.fastest_time}),e=e.attributes.score.fastest_time):e=9999,this.collection.max=e,this.collection.min=l,t.registerHelper("normalizeReactionTime",function(t){var n,i,s;return n=e,i=l,s=100*((t-i)/(n-i)),s=s>95?95:s,Math.round(s)}),this.tmpl=t.compile(i)},onTooltipShow:function(e,t){return e.addClass(t.prop("class"))}})}),define("dashboard/career/reaction_history",["backbone","Handlebars","text!./reaction_history.hbs","dashboard/widgets/base","game/results/reaction_time_history"],function(e,t,n,i,s){var r,o;return o=".widget",r=i.extend({className:"coolTones doubleWide reaction-history",render:function(){var e;return this.$el.html(n),e=new s({collection:this.collection}),this.$(o).append(e.render().el),e.renderChart(),this}}),r.dependsOn="entities/results/results",r.fetchOptions={data:{type:"ReactionTimeResult"}},r}),define("text!game/results/emotions.hbs",[],function(){return'\n\n<i class="emoticon" title="{{ score.display_emotion_friendly }}" />\n<h3>\n    {{{ score.display_emotion_title }}}\n</h3>\n<div class="description">\n    {{{ score.display_emotion_description }}}\n</div>\n\n'}),define("game/results/emotions",["backbone","Handlebars","game/results/base","text!./emotions.hbs","markdown"],function(e,t,n,i,s){var r,o,a;return o=".emoticon",a=200,r=n.extend({className:"emotions",tmpl:t.compile(i),render:function(){var e,t,n=this;return t=_.clone(this.model.attributes.score),t.display_emotion_title&&(t.display_emotion_title=s.toHTML(t.display_emotion_title)),t.display_emotion_description&&(t.display_emotion_description=s.toHTML(t.display_emotion_description)),e=this.model.toJSON(),e.score=t,this.$el.html(this.tmpl(e)),setTimeout(function(){return n.$(o).addClass(n.model.attributes.score.display_emotion_name)},a),this}})}),define("text!dashboard/emotions/highest_emotion.hbs",[],function(){return'\n\n<div class="widget {{className}} hasFooter">\n\n\n    <a class="footer muted" href="#game/emotions">Play Again</a>\n</div>\n'}),define("dashboard/emotions/highest_emotion",["backbone","Handlebars","dashboard/widgets/base","game/results/emotions","text!./highest_emotion.hbs"],function(e,t,n,i,s){var r,o;return o=".widget",r=n.extend({className:"doubleWide tall highestEmotion",render:function(){var e,t;return this.$el.html(s),e=this.collection.at(this.collection.length-1),t=new i({model:e}),this.$(o).append(t.render().el),this}}),r.dependsOn="entities/results/results",r.fetchOptions={data:{type:"EmoResult"}},r}),define("text!game/results/emotions_history.hbs",[],function(){return'\n<legend>\n    <i class="gfx-sun" title="Early Morning"></i>\n    <i class="gfx-moon" title="Late Night"></i>\n</legend>\n<div class="chartHolder">\n    <div class="chart">\n        {{#results}}\n            {{#if score.display_emotion_name }}\n                <div class="slice">\n                    <i class="emoticon small {{ score.display_emotion_name }} {{ timeClass }}"\n                       data-id="{{id}}"\n                       title="<div class=\'emotionsHistory\'>{{prettyDate time_played}} {{prettyTime time_played}} <h3 class=\'emoName\'>{{ score.display_emotion_friendly }}</h3></div>">\n                    </i>\n                </div>\n            {{/if}}\n        {{/results}}\n    </div>\n</div>\n\n'}),define("game/results/emotions_history",["backbone","Handlebars","game/results/base","text!./emotions_history.hbs","composite_views/perch","game/results/emotions"],function(e,t,n,i,s,r){var o,a,l,c,h,u,d,p,f;return u=".chartHolder",p=200,h=".emoticon",d="game/results/emotions_history",f=t.compile(i),o=["time1-morning","time2-earlyDay","time3-lateDay","time4-evening","time5-night","time6-lateNight"],a=["Morning","Early Day","Day","Evening","Night","Late Night"],c=function(e,t){var n,i;switch(n=new Date(e),i=n.getHours()+1){case 5:case 6:case 7:case 8:return t[0];case 9:case 10:case 11:case 12:return t[1];case 13:case 14:case 15:case 16:return t[2];case 17:case 18:case 19:case 20:return t[3];case 21:case 22:case 23:case 24:return t[4];case 1:case 2:case 3:case 4:return t[5];default:return null}},l=n.extend({className:"emotionsHistory",events:{"click .emoticon":"onClickEmoticon"},render:function(){var e=this;return null==this.collection&&console.error("Need a collection"),this.listenTo(this.collection,"sync",this.renderChart),this.$el.append(i),setTimeout(function(){return e.$(u).scrollLeft(9999)},p),this},renderChart:function(){return this.collection.length?(this.collection.each(function(e){return e.set("timeClass",c(e.attributes.time_played,o)),e.set("timeString",c(e.attributes.time_played,a))}),this.$el.html(f({results:this.collection.toJSON()})),this.$(h).tooltip({placement:"right",container:"body",html:!0,animation:!1})):(this.remove(),void 0)},onClickEmoticon:function(t){var n;return n=$(t.target).data("id"),s.show({title:"Emotion Details",btn1Text:null,large:!0,content:new r({model:new e.Model(this.collection.get(n).attributes)})})}})}),define("dashboard/emotions/historical_highest",["backbone","Handlebars","dashboard/widgets/base","game/results/emotions_history"],function(e,t,n,i){var s,r;return r=".widget",s=n.extend({className:"doubleWide historicalHighestEmotion",render:function(){var e;return this.$el.html(this.tmplBase({title:"Your Emotional Timeline"})),e=new i({collection:this.collection}),this.$(r).append(e.render().el),e.renderChart(),this}}),s.dependsOn="entities/results/results",s.fetchOptions={data:{type:"EmoResult"}},s}),define("charts/pie",["backbone","Handlebars","./chart","text!./chart_with_swatches.hbs","chart"],function(e,t,n,i){var s,r;return r="canvas",s=e.View.extend({tmpl:t.compile(i),className:"chart pie",initialize:function(){return this.model=new n(this.options.data,{parse:!0})},render:function(){return this.$el.html(this.tmpl(this.model.attributes)),this._renderChart(this.model.attributes.chartValues),this},_renderChart:function(e){var t,n,i,s,o;return(t=this.$(r))?(s=_.max(e,function(e){return e.value}),s=Math.ceil(s.value),o=_.extend(this.model.attributes.options,{scaleShowLine:!1,scaleShowLabels:!1,scaleOverride:!0,scaleSteps:s,scaleStepWidth:1,scaleStartValue:0}),i=t[0].getContext("2d"),n=new Chart(i).Pie(e,o)):void 0}})}),define("game/results/emotions_overview",["backbone","Handlebars","game/results/base","text!./emotions.hbs","markdown","charts/pie","composite_views/perch"],function(e,t,n,i,s,r,o){var a,l,c,h;return l="Primary Emotions",h=.2,c=5,a=n.extend({className:"emotionsOverview",events:{click:"onClick"},render:function(){return null==this.collection&&console.error("Need a collection"),this.listenTo(this.collection,"sync",this.renderChart),this},renderChart:function(){return this.chart=new r({data:{name:l,chartValues:this._prepareData(this.collection),options:{animation:!1}}}),this.$el.html(this.chart.render().el),this},_prepareData:function(){var e,t,n,i,s,r,o;i=this.collection.at(this.collection.length-1),t=i.attributes.calculations.emo_distances,r=_.map(t,function(e,t){return[t,e]}),r=_.sortBy(r,function(e){return e[1]}),e={},e[r[0][0]]=r[0][1],e[r[1][0]]=r[1][1],e[r[r.length-1][0]]=r[r.length-1][1],e[r[r.length-2][0]]=r[r.length-2][1],e[r[r.length-3][0]]=r[r.length-3][1];for(n in e)o=e[n],s=c-o,s=h>s?h:s+h,e[n]=s;return e},onClick:function(e){return e.stopPropagation(),o.show({title:l,large:!0,btn1Text:null,content:new r({data:{name:l,chartValues:this._prepareData(this.collection),width:450,height:300}})})}})}),define("dashboard/emotions/strongest_emotions",["backbone","dashboard/widgets/base","game/results/emotions_overview"],function(e,t,n){var i,s,r;return r=".widget",s="Primary Emotions",i=t.extend({events:{"click .widget":"onClick"},className:"chart-primaryEmotions",render:function(){return this.$el.html(this.tmplBase({title:s,className:"pressable"})),this.emotionsOverviewResult=new n({collection:this.collection}),this.$(r).append(this.emotionsOverviewResult.el),this.emotionsOverviewResult.renderChart(),this},onClick:function(){return this.emotionsOverviewResult.$el.trigger("click")},close:function(){var e;return null!=(e=this.emotionsOverviewResult)&&e.remove(),this.remove()}}),i.dependsOn="entities/results/results",i.fetchOptions={data:{type:"EmoResult"}},i}),define("text!dashboard/teasers/reaction_time.hbs",[],function(){return'\n\n<a class="widget hasFooter" href="#game/reaction_time">\n\n    <hgroup class="fancyTitle">\n        <p>The</p>\n        <p><strong>Reaction Time</strong></p>\n        <p>Game</p>\n    </hgroup>\n\n    <img src="images/game/teasers/reaction_time_disc.jpg" alt="3 partially transparent circles"/>\n\n    <p>Think quick, react fast.</p>\n\n    <div class="footer">Play Now</div>\n</a>\n\n\n'}),define("dashboard/teasers/reaction_time",["backbone","Handlebars","text!./reaction_time.hbs","dashboard/widgets/base"],function(e,t,n,i){return i.extend({tmpl:n,className:"teaser-reactionTime"})}),define("text!dashboard/teasers/emotions.hbs",[],function(){return'\n\n<a class="widget hasFooter" href="#game/emotions">\n\n    <hgroup class="fancyTitle">\n        <p>The</p>\n        <p><strong>Emotions</strong></p>\n        <p>Game</p>\n    </hgroup>\n\n    <img src="images/game/teasers/emotions.jpg" alt="Flower made up of pastel colored circles"/>\n\n    <p>Track your daily emotions.</p>\n\n    <div class="footer">Play Now</div>\n</a>\n\n\n'}),define("dashboard/teasers/emotions",["backbone","Handlebars","text!./emotions.hbs","dashboard/widgets/base"],function(e,t,n,i){return i.extend({tmpl:n,className:"teaser-emotions"})}),define("text!dashboard/teasers/personalizations.hbs",[],function(){return'\n\n<div class="widget hasFooter pressable">\n\n    <h2>Let\'s Get Personal-ized.</h2>\n\n    <p>\n        Your productivity, mood, and how you handle stress are all tied to your personality.\n    </p>\n    <p>\n        Set up your prefernces and Tidepool will guide you daily. Your self-improvement starts with your choices.\n    </p>\n\n    <div class="footer">\n        Set Preferences Now\n        <i class="icon-cog"></i>\n    </div>\n</div>\n\n\n'}),define("dashboard/teasers/personalizations",["backbone","Handlebars","text!./personalizations.hbs","dashboard/widgets/base","core"],function(e,t,n,i,s){var r;return r=i.extend({tmpl:n,className:"twilight doubleWide teaser-personalizations",events:{click:"onClick"},onSync:function(){return this.model&&!this.model.attributes.data?this.render():this.remove()},onClick:function(){return s.analytics.track("Personalizations","Teaser Pressed"),s.trigger("action:showPersonalizations")}}),r.dependsOn="entities/preferences/training",r}),define("text!dashboard/teasers/snoozer.hbs",[],function(){return'\n\n<a class="widget colorBrand2" href="#game/snoozer">\n\n    <hgroup class="fancyTitle">\n        <p><strong class="gfx-logo-snoozer"></strong></p>\n        <p>Game</p>\n    </hgroup>\n\n\n    <p class="snoozer inlineBlock">\n        <span class="clock"></span>\n    </p>\n</a>\n\n\n'}),define("dashboard/teasers/snoozer",["text!./snoozer.hbs","dashboard/widgets/base"],function(e,t){return t.extend({tmpl:e,className:"teaser-snoozer"})}),define("text!dashboard/fitness/steps_and_emotions.hbs",[],function(){return'<div class="widget">\n    Yo\n\n</div>'}),define("dashboard/fitness/steps_and_emotions",["backbone","dashboard/widgets/base","text!./steps_and_emotions.hbs"],function(e,t){var n,i;return i=".widget",n=t.extend({className:"doubleWide stepsAndEmotions",render:function(){return this.emotions=this.options.emotions,console.log({collection:this.collection.toJSON(),emotions:this.emotions.toJSON()}),this.emotions.length?this.renderChart():this.remove(),this},renderChart:function(){return console.log("renderChart")}}),n.dependsOn={collection:{klass:"entities/my/activities"},emotions:{klass:"entities/results/results",fetchOptions:{data:{type:"EmoResult"}}}},n}),define("entities/my/career",["classes/model","core"],function(e,t){var n;return n=e.extend({url:""+t.cfg.apiServer+"/api/v1/users/-/recommendations/career",initialize:function(){return this.on("sync",this.onSync),this.on("error",this.onErr)},onSync:function(){},onErr:function(){return console.error("Trouble getting model data")}})}),define("entities/my/recommendations",["classes/model","core"],function(e,t){var n;return n=e.extend({urlRoot:""+t.cfg.apiServer+"/api/v1/users/-/recommendations",id:"latest"})}),define("entities/my/personality",["classes/model","core","markdown"],function(e,t,n){var i;return i=e.extend({url:""+t.cfg.apiServer+"/api/v1/users/-/personality",initialize:function(){return this.on("sync",this.onSync),this.on("error",this.onErr)},parse:function(e){var t,i,s,r,o,a,l;if(e=this.dewrap(e),i=[],null!=(null!=e?null!=(o=e.profile_description)?o.one_liner:void 0:void 0)&&(e.profile_description.one_liner=n.toHTML(e.profile_description.one_liner)),null!=(null!=e?null!=(a=e.profile_description)?a.bullet_description:void 0:void 0)){for(l=e.profile_description.bullet_description,s=0,r=l.length;r>s;s++)t=l[s],i.push(n.toHTML(t));e.profile_description.bullet_description=i}return e},onSync:function(){},onErr:function(){return console.error(""+_me+": Trouble getting the User Personality Model")}})}),define("entities/results/result",["classes/model"],function(e){var t,n;return n="entities/results/result",t=e.extend({defaults:{game_id:null,user_id:null,time_played:null}}),t.STATES={pending:"pending",error:"error",done:"done"},t}),define("entities/results/results",["classes/collection","entities/results/result","core"],function(e,t,n){var i,s;return s="entities/results/results",i=e.extend({url:function(){return""+n.cfg.apiServer+"/api/v1/users/-/results"},model:t,initialize:function(){return this.on("error",this.onErr)},onErr:function(){return console.error(""+s+": error")}}),i.STATES=t.STATES,i}),define("entities/my/activities",["classes/collection"],function(e){var t;return t=e.extend({url:""+window.apiServerUrl+"/api/v1/users/-/activities"})}),define("dashboard/widgetmaster",["jquery","underscore","backbone","core","dashboard/personality/core","dashboard/personality/big5","dashboard/personality/holland6","dashboard/personality/detailed_report","dashboard/personality/recommendation","dashboard/career/jobs","dashboard/career/skills","dashboard/career/tools","dashboard/career/reaction_results","dashboard/career/reaction_history","dashboard/emotions/highest_emotion","dashboard/emotions/historical_highest","dashboard/emotions/strongest_emotions","dashboard/teasers/reaction_time","dashboard/teasers/emotions","dashboard/teasers/personalizations","dashboard/teasers/snoozer","dashboard/fitness/steps_and_emotions","entities/my/career","entities/my/recommendations","entities/my/personality","entities/results/results","entities/preferences/training","entities/my/activities"],function(e,t,n,i,s,r,o,a,l,c,h,u,d,p,f,m,g,v,b,y,_,w,k,S,x,C,P,T){var E,N,I,A,M,O,L;return L={"dashboard/career/jobs":c,"dashboard/career/skills":h,"dashboard/career/tools":u,"dashboard/career/reaction_results":d,"dashboard/career/reaction_history":p,"dashboard/personality/core":s,"dashboard/personality/big5":r,"dashboard/personality/holland6":o,"dashboard/personality/detailed_report":a,"dashboard/personality/recommendation":l,"dashboard/emotions/highest_emotion":f,"dashboard/emotions/historical_highest":m,"dashboard/emotions/strongest_emotions":g,"dashboard/teasers/reaction_time":v,"dashboard/teasers/emotions":b,"dashboard/teasers/personalizations":y,"dashboard/teasers/snoozer":_,"dashboard/fitness/steps_and_emotions":w},N={"entities/my/career":k,"entities/my/recommendations":S,"entities/my/personality":x,"entities/results/results":C,"entities/preferences/training":P,"entities/my/activities":T},I=function(e,t){var n;return n=t?""+e+"?fetchOptions="+JSON.stringify(t):e},O=".holder",M=["holder","tall","doubleWide","coolTones"],A="dashboard/widgetmaster",E=n.View.extend({className:"widgetmaster",id:"Widgetmaster",events:{"click .widget.pressable":"onClick","click a.widget":"onClick"},initialize:function(){var t,n,i,s;if(!this.options.widgets)throw new Error("Need @options.widgets");this.dataSources=this._setUpDataSources(this.options.widgets),this.widgets=this._makeWidgets(this.options.widgets,this.dataSources),n=[],s=this.dataSources;for(i in s)t=s[i],n.push(t.fetch(t.fetchOptions));return e.when.apply(e,n).done(this._countResults)},render:function(){var e,t,n,i;for(this.$el.empty(),i=this.widgets,t=0,n=i.length;n>t;t++)e=i[t],this.$el.append(e.el);return this},_setUpDataSources:function(e){var n,i,s,r,o,a,l;for(i={},o=0,a=e.length;a>o;o++)if(r=e[o],L[r])if(n=L[r],n.dependsOn)if(t.isObject(n.dependsOn)){l=n.dependsOn;for(r in l)s=l[r],this._setUpDataSource(i,s.klass,s.fetchOptions)}else this._setUpDataSource(i,n.dependsOn,n.fetchOptions);else;else console.error(""+A+": no widget available called `"+r+"`");return i},_setUpDataSource:function(e,t,n){var i,s;return N[t]?(s=I(t,n),i=N[t],e[s]=new i,e[s].fetchOptions=n):console.error("Looking for `"+t+"`, but there is no model loaded with that name")},_makeWidgets:function(e,i){var s,r,o,a,l,c,h,u,d,p;for(h=[],u=0,d=e.length;d>u;u++)if(l=e[u],L[l])if(s=L[l],t.isObject(s.dependsOn)){c={},p=s.dependsOn;for(l in p)o=p[l],a=I(o.klass,o.fetchOptions),c[l]=i[a];console.log({opts:c}),h.push(new s(c))}else s.dependsOn?(a=I(s.dependsOn,s.fetchOptions),r=i[a],r instanceof n.Model?h.push(new s({model:r})):r instanceof n.Collection?h.push(new s({collection:r})):(console.error(""+A+": This object is neither a collection nor a model: "),console.log({dependsOn:s.dependsOn}))):h.push(new s);else console.error(""+A+": no widget available called `"+l+"`");return h},_countResults:function(){var e,n,s,r,o,a;if(e=0,"success"===arguments[1])n=arguments[0],t.isArray(n)&&(e+=n.length);else for(o=0,a=arguments.length;a>o;o++)r=arguments[o],n=r[0],t.isArray(n)&&(e+=n.length);return s=i.user.get("gamesPlayed")||0,i.user.set({gamesPlayed:Math.max(e,s)}),e},onClick:function(t){var n,s,r,o,a,l;for(n=e(t.currentTarget),s=n.closest(O).prop("class"),a=0,l=M.length;l>a;a++)o=M[a],s=s.replace(o,"");return r=s.trim(),r?i.analytics.track("Widget","Clicked "+r):void 0}})}),define("pages/dashboard/_base",["backbone","core","dashboard/widgetmaster"],function(e,t,n){var i;return i=e.View.extend({title:null,className:null,initialize:function(){return this.listenTo(t.user,"sync",this.render),t.user.isLoggedIn()?void 0:t.trigger("session:showLogin")},renderWidgets:function(e){return this.widgetmaster=new n({widgets:e}),this.$el.html(this.widgetmaster.render().el),this}})}),define("pages/dashboard/mood",["./_base"],function(e){var t;return t=e.extend({title:"Mood Dashboard",className:"dashboard-mood",render:function(){return this.renderWidgets(["dashboard/emotions/highest_emotion","dashboard/emotions/historical_highest","dashboard/emotions/strongest_emotions","dashboard/teasers/reaction_time"])}})}),define("pages/dashboard/personality",["./_base"],function(e){var t;return t=e.extend({title:"Personality Dashboard",className:"dashboard-personality",render:function(){return this.renderWidgets(["dashboard/personality/core","dashboard/personality/big5","dashboard/personality/holland6","dashboard/personality/detailed_report"])}})}),define("pages/dashboard/productivity",["./_base"],function(e){var t;return t=e.extend({title:"Productivity Dashboard",className:"dashboard-productivity",render:function(){return this.renderWidgets(["dashboard/career/reaction_history","dashboard/career/reaction_results","dashboard/teasers/emotions","dashboard/career/jobs","dashboard/career/skills","dashboard/career/tools"])}})}),define("pages/dashboard/summary",["./_base"],function(e){var t;return t=e.extend({title:"Summary Dashboard",className:"dashboard-summary",render:function(){return this.renderWidgets(["dashboard/career/reaction_history","dashboard/emotions/historical_highest","dashboard/personality/big5","dashboard/teasers/personalizations","dashboard/teasers/reaction_time"])}})}),define("text!pages/about.hbs",[],function(){return'\n<section class="col3rds">\n    <p>\n        All you have to do is play games.\n        <br/>\n        It\'s just that simple.\n    </p>\n    <img src="images/home_page/about-graphics_01.png" alt="Game being played"/>\n</section>\n\n<section class="col3rds">\n    <p>Our patented technology will decode your dominant personality traits, short-term cognitive processes, and your emotions.</p>\n    <img src="images/home_page/about-graphics_02.png" alt="Personality Badges"/>\n</section>\n\n<section class="col3rds">\n    <p>Based on your results, we can help empower your self-improvement.</p>\n    <img src="images/home_page/about-graphics_03.png" alt="Self Improvement Map"/>\n</section>\n\n\n<hr>\n\n\n<span class="shadowWarrior">\n    <a href="#startGame" class="btn btn-large btn-primary">Get Started</a>\n</span>\n\n\n\n\n\n'}),define("pages/about",["backbone","Handlebars","text!./about.hbs"],function(e,t,n){var i;return i=e.View.extend({title:"About Us",className:"aboutPage",initialize:function(){},render:function(){return this.$el.html(n),this}})}),define("text!pages/demographics.hbs",[],function(){return'\n\n<p>Before you start the game, wanna tell us a little about yourself?</p>\n\n<div id="FormRegion"></div>\n\n\n<a id="ActionStartGame" class="btn btn-link btn-large pull-right" href="#game">No thanks, I\'ll do this later.</a>\n\n\n'}),define("pages/demographics-fields",[],function(){return[{string_id:"dob",type:"date",label:"Birthdate"},{string_id:"education",type:"select",label:"Education",options:["High School - Freshman (9)","High School - Sophmore (10)","High School - Junior (11)","High School - Senior (12)","College - Less than 2 yrs","College - Associates","College - Bachelor's","College - Master's","College - Ph.D.","Prefer not to answer"]},{string_id:"handedness",type:"select_by_icon",label:"Handedness",options:[{value:"left",label:"Left",icon:"gfx-lefthand"},{value:"right",label:"Right",icon:"gfx-righthand"},{value:"mixed",label:"Mixed",icon:"gfx-bothhands"}]},{string_id:"gender",type:"select_by_icon",label:"Sex",options:[{value:"female",label:"Female",icon:"gfx-female"},{value:"male",label:"Male",icon:"gfx-male"}]}]}),define("pages/demographics",["backbone","Handlebars","text!./demographics.hbs","ui_widgets/formation","./demographics-fields","core"],function(e,t,n,i,s,r){var o,a,l,c,h,u;return a="#FormRegion",h="#ActionStartGame",c='    <a id="ActionStartGame" class="btn btn-large btn-primary btn-alt pull-right" href="#game">Save My Info and Let\'s Go</a>  ',u='<div class="col3rds"></div>',l=[".dob, .education",".handedness",".gender"],o=e.View.extend({title:"Demographics",className:"demographicsPage",events:{"change input":"onChangeInput","change select":"onChangeInput","click #ActionStartGame":"onClickContinue"},initialize:function(){return this.formation=new i({data:s,values:r.user.attributes})},render:function(){return this.$el.html(n),this.$(a).html(this.formation.render().el),this},onDomInsert:function(){return this._wrapGroups()},_wrapGroups:function(){var e,t,n,i;for(i=[],t=0,n=l.length;n>t;t++)e=l[t],i.push($(e).wrapAll(u));return i},onChangeInput:function(){return this._alreadyChanged?void 0:(this.$(h).replaceWith(c),this._alreadyChanged=!0)},onClickContinue:function(){var e,t;return e=this.formation.getVals(),_.isEmpty(e)||(r.user.set(e),r.user.isNew())?void 0:t=r.user.save}})}),define("text!pages/error.hbs",[],function(){return'<h2>Error</h2>\n<p class="large">\n    {{message}}\n</p>\n<pre>\n    {{objectString}}\n</pre>'}),define("pages/error",["backbone","Handlebars","text!./error.hbs"],function(e,t,n){var i,s;return s=t.compile(n),i=e.View.extend({title:"Error",className:"errorPage",initialize:function(){return this.error=this.options.params,this.error.objectString=JSON.stringify(this.error.object),console.warn({error:this.error})},render:function(){return this.$el.html(s(this.error)),this}})}),define("text!pages/friend_survey.hbs",[],function(){return'\n\n<div class="intro">\n    <h1>Introduction</h1>\n    <p>Your friend wants to learn more about themselves. Complete this one-page questionnaire and help them find out.</p>\n    <p>Your answers are anonymous. We don\'t identify your answer individually, only combined with the answers of others.</p>\n    <p>Please be completely honest, it\'s the best way to help your friend.</p>\n</div>\n\n\n<h1>Is your friend...</h1>\n<div id="ContentHolder" class=\'content\'>\n    <!--<b class="holdPlease inline">-->\n        <!--<i class="icon-repeat icon-2x"></i>-->\n    <!--</b>-->\n</div>\n\n<p class="textAlignCenter">\n    <button class="btn btn-large btn-primary" id="SubmitForm">\n        Submit\n    </button>\n</p>\n\n'}),define("text!pages/friend_survey-thanks.hbs",[],function(){return'\n\n<div class="intro">\n    <h1>Thank you</h1>\n    <p>\n        We\'re doing fancy math things to combine your answers with those of other people.\n        We\'ll use this to tell your friend about how others percieve him or her.\n    </p>\n</div>\n\n\n<p class="large">\n    You can learn about yourself, too. Play our personality game and, if you\'d like, ask your friends what they think about you.\n</p>\n<p class="textAlignCenter">\n    <a href="#startGame" class="btn btn-large btn-primary">Get Started</a>\n</p>\n\n'}),define("pages/friend_survey-fields",[],function(){return[{question_id:"high_extraversion",question_topic:"tipi",question_type:"icon_slider",icon:"icon-sun",steps:7,value:4,question:"Extraverted and Enthusiastic?",labels:[{position:0,label:"Disagree Strongly"},{position:"16.666%",label:"&bull;"},{position:"33.333%",label:"&bull;"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"66.666%",label:"&bull;"},{position:"83.333%",label:"&bull;"},{position:"100%",label:"Agree Strongly"}]},{question_id:"low_agreeableness",question_topic:"tipi",question_type:"icon_slider",icon:"icon-comments",steps:7,value:4,question:"Critical and Quarrelsome?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]},{question_id:"high_conscientiousness",question_topic:"tipi",question_type:"icon_slider",icon:"icon-briefcase",steps:7,value:4,question:"Dependable and Self-Disciplined?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]},{question_id:"high_neuroticism",question_topic:"tipi",question_type:"icon_slider",icon:"icon-bolt",steps:7,value:4,question:"Anxious and Easily Upset?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]},{question_id:"high_openness",question_topic:"tipi",question_type:"icon_slider",icon:"icon-cloud",steps:7,value:4,question:"Open to New Experiences and Complex?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]},{question_id:"low_extraversion",question_topic:"tipi",question_type:"icon_slider",icon:"icon-book",steps:7,value:4,question:"Reserved and Quiet?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]},{question_id:"high_agreeableness",question_topic:"tipi",question_type:"icon_slider",icon:"icon-smile",steps:7,value:4,question:"Sympathetic and Warm?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]},{question_id:"low_conscientiousness",question_topic:"tipi",question_type:"icon_slider",icon:"icon-leaf",steps:7,value:4,question:"Disorganized and Careless?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]},{question_id:"low_neuroticism",question_topic:"tipi",question_type:"icon_slider",icon:"icon-home",steps:7,value:4,question:"Calm and Emotionally Stable?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]},{question_id:"low_openness",question_topic:"tipi",question_type:"icon_slider",icon:"icon-cog",steps:7,value:4,question:"Conventional and Uncreative?",labels:[{position:0,label:"Disagree Strongly"},{position:"50%",label:"Neither Agree Nor Disagree"},{position:"100%",label:"Agree Strongly"}]}]
}),define("text!ui_widgets/icon_slider.hbs",[],function(){return'\n<p>{{question}}</p>\n<div class="slider" title="{{question}}"></div>\n<legend>\n    {{#labels}}\n        <label style="left:{{position}}">{{{label}}}</label>\n    {{/labels}}\n</legend>\n'}),define("jqueryui/core",["jquery"],function(e){!function(e,t){function n(t,n){var s,r,o,a=t.nodeName.toLowerCase();return"area"===a?(s=t.parentNode,r=s.name,t.href&&r&&"map"===s.nodeName.toLowerCase()?(o=e("img[usemap=#"+r+"]")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var s=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,s,r=e(this[0]);r.length&&r[0]!==document;){if(i=r.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(r.css("zIndex"),10),!isNaN(s)&&0!==s))return s;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++s)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),s=isNaN(i);return(s||i>=0)&&n(t,!s)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function s(t,n,i,s){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?a["inner"+i].call(this):this.each(function(){e(this).css(o,s(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){e(this).css(o,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var s,r=e.ui[t].prototype;for(s in i)r.plugins[s]=r.plugins[s]||[],r.plugins[s].push([n,i[s]])},call:function(e,t,n){var i,s=e.plugins[t];if(s&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<s.length;i++)e.options[s[i][0]]&&s[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",s=!1;return t[i]>0?!0:(t[i]=1,s=t[i]>0,t[i]=0,s)}})}(e)}),define("jqueryui/widget",["jquery"],function(e){!function(e,t){var n=0,i=Array.prototype.slice,s=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(r){}s(t)},e.widget=function(t,n,i){var s,r,o,a,l={},c=t.split(".")[0];t=t.split(".")[1],s=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[c]=e[c]||{},r=e[c][t],o=e[c][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),a=new n,a.options=e.widget.extend({},a.options),e.each(i,function(t,i){return e.isFunction(i)?(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},s=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,r=this._superApply;return this._super=e,this._superApply=s,t=i.apply(this,arguments),this._super=n,this._superApply=r,t}}(),void 0):(l[t]=i,void 0)}),o.prototype=e.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix:t},l,{constructor:o,namespace:c,widgetName:t,widgetFullName:s}),r?(e.each(r._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,o,n._proto)}),delete r._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){for(var s,r,o=i.call(arguments,1),a=0,l=o.length;l>a;a++)for(s in o[a])r=o[a][s],o[a].hasOwnProperty(s)&&r!==t&&(n[s]=e.isPlainObject(r)?e.isPlainObject(n[s])?e.widget.extend({},n[s],r):e.widget.extend({},r):r);return n},e.widget.bridge=function(n,s){var r=s.prototype.widgetFullName||n;e.fn[n]=function(o){var a="string"==typeof o,l=i.call(arguments,1),c=this;return o=!a&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,a?this.each(function(){var i,s=e.data(this,r);return s?e.isFunction(s[o])&&"_"!==o.charAt(0)?(i=s[o].apply(s,l),i!==s&&i!==t?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,r);t?t.option(o||{})._init():e.data(this,r,new s(o,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var s,r,o,a=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(a={},s=n.split("."),n=s.shift(),s.length){for(r=a[n]=e.widget.extend({},this.options[n]),o=0;o<s.length-1;o++)r[s[o]]=r[s[o]]||{},r=r[s[o]];if(n=s.pop(),i===t)return r[n]===t?null:r[n];r[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];a[n]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var s,r=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=s=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,s=this.widget()),e.each(i,function(i,o){function a(){return t||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?r[o]:o).apply(r,arguments):void 0}"string"!=typeof o&&(a.guid=o.guid=o.guid||a.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+r.eventNamespace,h=l[2];h?s.delegate(h,c,a):n.bind(c,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var s,r,o=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(s in r)s in n||(n[s]=r[s]);return this.element.trigger(n,i),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,s,r){"string"==typeof s&&(s={effect:s});var o,a=s?s===!0||"number"==typeof s?n:s.effect||n:t;s=s||{},"number"==typeof s&&(s={duration:s}),o=!e.isEmptyObject(s),s.complete=r,s.delay&&i.delay(s.delay),o&&e.effects&&e.effects.effect[a]?i[t](s):a!==t&&i[a]?i[a](s.duration,s.easing,r):i.queue(function(n){e(this)[t](),r&&r.call(i[0]),n()})}})}(e)}),define("jqueryui/mouse",["jquery","./widget"],function(e){!function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,s=1===n.which,r="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return s&&!r&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(e)}),define("jqueryui/slider",["jquery","./core","./mouse","./widget"],function(e){!function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,i=this.options,s=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(n=i.values&&i.values.length||1,s.length>n&&(s.slice(n).remove(),s=s.slice(0,n)),t=s.length;n>t;t++)o.push(r);this.handles=s.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(n+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):this.range=e([])},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,i,s,r,o,a,l,c,h=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),s=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(i-h.values(t));(s>n||s===n&&(t===h._lastChangedValue||h.values(t)===u.min))&&(s=n,r=e(this),o=t)}),a=this._start(t,o),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,r.addClass("ui-state-active").focus(),l=r.offset(),c=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-l.left-r.width()/2,top:t.pageY-l.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,s,r;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),i=n/t,i>1&&(i=1),0>i&&(i=0),"vertical"===this.orientation&&(i=1-i),s=this._valueMax()-this._valueMin(),r=this._valueMin()+i*s,this._trimAlignValue(r)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var i,s,r;this.options.values&&this.options.values.length?(i=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>i||1===t&&i>n)&&(n=i),n!==this.values(t)&&(s=this.values(),s[t]=n,r=this._trigger("slide",e,{handle:this.handles[t],value:n,values:s}),i=this.values(t?0:1),r!==!1&&this.values(t,n,!0))):n!==this.value()&&(r=this._trigger("slide",e,{handle:this.handles[t],value:n}),r!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,n){var i,s,r;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,s=arguments[0],r=0;r<i.length;r+=1)i[r]=this._trimAlignValue(s[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,n){var i,s=0;switch("range"===t&&this.options.range===!0&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(s=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;s>i;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,i,s,r,o=this.options.range,a=this.options,l=this,c=this._animateOff?!1:a.animate,h={};this.options.values&&this.options.values.length?this.handles.each(function(i){n=100*((l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())),h["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[c?"animate":"css"](h,a.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:n+"%"},a.animate),1===i&&l.range[c?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:a.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:n+"%"},a.animate),1===i&&l.range[c?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:a.animate}))),t=n}):(i=this.value(),s=this._valueMin(),r=this._valueMax(),n=r!==s?100*((i-s)/(r-s)):0,h["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[c?"animate":"css"](h,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:n+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:a.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:n+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(n){var i,s,r,o,a=e(n.target).data("ui-slider-handle-index");switch(n.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(n.target).addClass("ui-state-active"),i=this._start(n,a),i===!1))return}switch(o=this.options.step,s=r=this.options.values&&this.options.values.length?this.values(a):this.value(),n.keyCode){case e.ui.keyCode.HOME:r=this._valueMin();break;case e.ui.keyCode.END:r=this._valueMax();break;case e.ui.keyCode.PAGE_UP:r=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;r=this._trimAlignValue(s+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;r=this._trimAlignValue(s-o)}this._slide(n,a,r)},click:function(e){e.preventDefault()},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(e)}),define("ui_widgets/icon_slider",["backbone","Handlebars","text!./icon_slider.hbs","jqueryui/slider"],function(e,t,n){var i,s,r,o,a,l;return r="ui_widgets/icon_slider",l=t.compile(n),a=".slider",o=".ui-slider-handle",s="yay",i=e.View.extend({className:"iconSlider",initialize:function(){return _.bindAll(this,"onSlide","onStop")},render:function(){return this.$el.html(l(this.model.attributes)),this.$(a).slider({min:1,max:this.model.attributes.steps,value:this.model.attributes.value,range:"min",slide:this.onSlide,stop:this.onStop}),this.$(o).append("<i class='"+this.model.attributes.icon+"'></i>"),this},_shimmer:function(e){return e?(e.removeClass(s),setTimeout(function(){return e.addClass(s,1)})):void 0},onSlide:function(e,t){return this.trigger("slide",{model:this.model,value:t.value})},onStop:function(e,t){return this._shimmer($(t.handle)),this.model.set("value",t.value),this.trigger("stop",{model:this.model,value:t.value})}})}),define("pages/friend_survey",["jquery","underscore","backbone","Handlebars","core","text!./friend_survey.hbs","text!./friend_survey-thanks.hbs","./friend_survey-fields","ui_widgets/icon_slider","ui_widgets/hold_please"],function(e,t,n,i,s,r,o,a,l,c){var h,u,d,p;return d="#ContentHolder",p="#SubmitForm",h=n.Collection.extend({url:function(){return""+s.cfg.apiServer+"/api/v1/games/"+this.game_id+"/friend_survey"},toJSON:function(){var e;return e={},this.each(function(t){return e[t.attributes.question_id]=t.attributes.value}),{friend_survey:e}},sync:function(e){return n.sync("create",this,e)}}),u=n.View.extend({title:"Help a Friend",className:"friendSurveyPage",events:{"click #SubmitForm":"onSubmit"},initialize:function(){return t.bindAll(this,"onSync","onError"),this.collection=new h(a),this.collection.game_id=this.options.params.game_id},render:function(){var e=this;return this.$el.html(r),this.collection.each(function(t){var n;return n=new l({model:t}),e.$(d).append(n.render().el)}),this},onSubmit:function(){var e;return c.show(p),s.analytics.trackKeyMetric("Friend Survey","Submitted Answers"),e=this.collection.sync("create"),e.done(this.onSync),e.fail(this.onError)},onSync:function(){return c.hide(),this.$el.html(o)},onError:function(){throw c.hide(),new Error("Problem saving")}})}),define("text!pages/game_results.hbs",[],function(){return'\n<div id="ResultsDisplay" class="results">\n    <p class="textAlignCenter">\n        <b class="holdPlease inline">\n            <i class="icon-repeat icon-4x"></i>\n        </b>\n        <br/>\n    </p>\n    <p class="muted textAlignCenter">\n        Loading Results...\n    </p>\n</div>\n\n<p id="CallToAction" class="textAlignCenter">\n    <a class="btn btn-large btn-primary" href="#dashboard">View My Dashboard</a>\n    <br/>\n    <br/>\n</p>\n\n'}),define("text!pages/game_results-rt.hbs",[],function(){return'\n\n<b class="gfx-badge">\n    <img src="images/game/teasers/reaction_time_disc.jpg" alt="3 partially transparent circles"/>\n</b>\n\n\n<hgroup class="mainHeading">\n    <h3>Your Results For</h3>\n    <h1>Reaction Time</h1>\n</hgroup>\n\n\n<div id="ResultsDisplay" class="results">\n\n</div>\n\n<div class="explanation">\n    <p class="large"><strong>The Reaction Time Game</strong> Measures the time it takes for your brain to recieve a message and send that message to the muscles in your fingers.</p>\n    <p class="large">The fastest time for an average man: 253ms, average woman: 261ms</p>\n</div>\n\n\n<p id="CallToAction" class="textAlignCenter">\n    <a class="btn btn-large btn-primary btn-alt" href="#dashboard-productivity">Dashboard</a>\n    <a class="btn btn-large btn-primary" href="#game/reaction_time">Play Again</a>\n</p>\n\n'}),define("text!pages/game_results-emo.hbs",[],function(){return'\n\n<b class="gfx-badge">\n    <img src="images/game/teasers/emotions.jpg" alt="3 partially transparent circles"/>\n</b>\n\n\n<hgroup class="mainHeading">\n    <h3>Your Results For</h3>\n    <h1>Emotions</h1>\n</hgroup>\n\n\n<div id="ResultsDisplay" class="results">\n\n</div>\n\n<div class="explanation">\n    <p class="large">\n        Emotional well-being can greatly affect your physical health.\n        Stress, depression, and anxiety can contribute to a host of physical ailments including digestive disorders,\n        sleep disturbances, and lack of energy.\n    </p>\n</div>\n\n\n<p id="CallToAction" class="textAlignCenter">\n    <a class="btn btn-large btn-primary btn-alt" href="#dashboard-mood">Dashboard</a>\n    <a class="btn btn-large btn-primary" href="#game/emotions">Play Again</a>\n</p>\n\n'}),define("text!pages/game_results-friend_teaser.hbs",[],function(){return'\n<div class="friendTeaser">\n    <p class="textAlignCenter large">\n        <strong>Find What Others Think About You</strong>\n    </p>\n    <p>You\'ve probably heard that perception is reality. Knowing what others think of you can greatly help you understand yourself better.</p>\n    <p>\n        Send this quick and anonymous 1-page survey to <strong>at least 3 friends</strong> and see what people truly think of your personality. Its all anonymous, so the results will be honest and unbiased.\n    </p>\n    <p>\n        Your personality information is safe at TidePool and will not be shared with your friends.\n    </p>\n    <!--<a class="btn btn-link btn-large" href="{{origin}}/#helpMyFriend/{{user_id}}/{{game_id}}">Preview</a>-->\n\n    <br/>\n\n    <p class="textAlignCenter">\n        <a class="btn btn-large btn-primary btn-alt friendSurvey" href="mailto:?subject={{emailSubject}}&body={{emailBody}}">\n            <i class="icon-envelope"></i>\n            Ask Friends\n        </a>\n        <input type=\'text\' class="large" value="{{origin}}/#friendHelper/{{user_id}}/{{game_id}}"/>\n        <br/>\n        <a href="{{origin}}/#friendHelper/{{user_id}}/{{game_id}}" class="surveyPreview">\n            Preview the Survey\n        </a>\n    </p>\n\n</div>\n\n\n'}),define("text!pages/game_results-friend_teaser_email.hbs",[],function(){return"Hi!\n\nI would like your perspective on my personality. Help now by answering this quick and completely anonymous one page questionnaire.\n\nPlease answer honestly. Remember, its anonymous, and being truthful is the best way to help.\n\nClick here to help me.\n{{origin}}/#friendHelper/{{user_id}}/{{game_id}}\n\nThanks!"}),define("text!game/results/personality.hbs",[],function(){return'\n<img\n    class="img-badge"\n    src="/images/badges/{{score.logo_url}}"\n    alt="Badge representing the personalty type of: {{score.name}}"\n    title="Personality game played on {{prettyDate time_played}} at {{prettyTime time_played}} "\n/>\n\n\n<hgroup class="mainHeading">\n    <h3>You are</h3>\n    <h1>{{score.name}}</h1>\n</hgroup>\n\n<div class="explanation">\n    {{{score.one_liner}}}\n</div>\n\n\n'}),define("game/results/personality",["backbone","Handlebars","game/results/base","text!./personality.hbs","markdown"],function(e,t,n,i,s){var r,o;return o="game/results/personality",r=n.extend({className:"personality",tmpl:t.compile(i),start:function(){return this._prepareData()},_prepareData:function(){var e;return e=this.model.get("score"),e.one_liner=s.toHTML(e.one_liner),this.model.set("score",e),this}})}),define("entities/results/game",["classes/collection","entities/results/result","core","game/results/reaction_time","game/results/personality","game/results/emotions"],function(e,t,n,i,s,r){var o,a,l;return a="entities/results/game",l={ReactionTimeResult:i,PersonalityResult:s,Holland6Result:null,Big5Result:null,SurveyResult:null,EmoResult:r},o=e.extend({url:function(){return""+n.cfg.apiServer+"/api/v1/users/-/games/"+this.game_id+"/results"},model:t,initialize:function(e){if(null==e.game_id)throw new Error("Need game_id");return this.game_id=e.game_id,this.on("error",this.onErr),this.on("sync",this.onSync)},_makeViewsForModels:function(){return this.each(function(e){var t;return t=l[e.attributes.type],null!=t?e.view=new t({model:e}):null!==t?console.error("No view class has been built and configured for result type `"+e.attributes.type+"`"):void 0})},onSync:function(e,n){var i;return(null!=(i=n.status)?i.state:void 0)===t.STATES.pending?console.error("Data synced but it doesn't look like a result set"):this._makeViewsForModels()
},onErr:function(){return console.error(""+a+": error")}})}),define("text!ui_widgets/guest_signup.hbs",[],function(){return'\n\n\n<p class="textAlignCenter large">\n    <strong>Create a free account</strong>\n</p>\n\n<p>\n    This lets you see your detailed personality report and play more games to learn about yourself.\n</p>\n\n<br/>\n\n<p class="textAlignCenter">\n    <button class="btn btn-large btn-primary" id="ActionShowSignup">Sign Up</button>\n</p>\n'}),define("ui_widgets/guest_signup",["backbone","text!./guest_signup.hbs","core"],function(e,t,n){var i;return i=e.View.extend({className:"guestSignup",events:{"click #ActionShowSignup":"onClickedSignUp"},initialize:function(){return this.listenTo(n.user,"sync",this.onUserSync)},render:function(){return this.$el.html(t),this},onClickedSignUp:function(){return n.analytics.track(this.className,"Pressed Sign Up"),n.trigger("session:showRegister")},onUserSync:function(e){return e.isGuest()?void 0:n.router.navigate("dashboard",{trigger:!0})}})}),define("pages/game_results",["backbone","Handlebars","text!./game_results.hbs","text!./game_results-rt.hbs","text!./game_results-emo.hbs","text!./game_results-friend_teaser.hbs","text!./game_results-friend_teaser_email.hbs","entities/results/game","entities/results/results","game/results/reaction_time_history","game/results/emotions_history","game/results/emotions_overview","ui_widgets/psst","core","ui_widgets/guest_signup"],function(e,t,n,i,s,r,o,a,l,c,h,u,d,p,f){var m,g,v,b,y,w,k;return b="#ResultsDisplay",y="#CallToAction",v={pers:"PersonalityResult",rt:"ReactionTimeResult",emo:"EmoResult"},g={ReactionTimeResult:i,EmoResult:s},k=t.compile(r),w=t.compile(o),m=e.View.extend({title:"Results",className:"gameResultsPage",events:{"click .friendSurvey":"onClickFriendSurvey","click .surveyPreview":"onClickSurveyPreview"},initialize:function(){var e;if(null==(null!=(e=this.options.params)?e.game_id:void 0))throw new Error("Need game_id");return this.collection=new a({game_id:this.options.params.game_id}),this.listenTo(this.collection,"sync",this.onSync),this.listenTo(this.collection,"error",this.onError),this.collection.fetch()},render:function(){var e;return this.$el.html(n),p.user.isGuest()&&(e=new f,this.$(y).html(e.render().el)),this},_renderResults:function(){return this.$(b).empty(),this._hasType(this.collection,v.rt)?this._renderAsType(v.rt):this._hasType(this.collection,v.emo)?this._renderAsType(v.emo):this._hasType(this.collection,v.pers)?this._renderAsType(v.pers):this._renderGeneric(),this},_hasType:function(e,t){return e.find(function(e){return e.attributes.type===t})},_renderGeneric:function(){return this.collection.each(function(e){var t;return this.$(b).append(null!=(t=e.view)?t.render().el:void 0)})},_renderAsType:function(e){var t,n,i;switch($("body").addClass(""+this.className+"-"+e),null!=g[e]&&this.$el.html(g[e]),this.collection.each(function(e){var t;return this.$(b).append(null!=(t=e.view)?t.render().el:void 0)}),e){case v.rt:return this._appendReactionTimeHistory();case v.emo:return this._appendEmotionCharts();case v.pers:return t=this.collection.find(function(e){return e.attributes.type===v.pers}),n=t.attributes.score.name.split(" ").join("-"),i={user_id:p.user.id,game_id:this.collection.game_id,origin:window.location.protocol+"//"+window.location.hostname},this.$(y).append(k(_.extend(i,{emailSubject:encodeURIComponent("Request for Help"),emailBody:encodeURIComponent(w(i))}))),$("body").addClass(""+this.className+"-"+n);default:return console.warn("Unknown type: "+e)}},_appendReactionTimeHistory:function(){var e,t;return t=new l,e=new c({collection:t}),e.collection.fetch({data:{type:v.rt}}),this.$(b).append(e.render().el)},_appendEmotionCharts:function(){var e,t,n;return e=new l,t=new h({collection:e}),n=new u({collection:e}),t.collection.fetch({data:{type:v.emo}}),this.$(b).append(t.render().el),this.$(b).prepend(n.render().el)},onSync:function(e,t){var n;return(null!=t?null!=(n=t.status)?n.state:void 0:void 0)===l.STATES.pending?(this._renderResults(),d({sel:b,title:"Results Are Pending",msg:"Sorry, but for some reason results haven't yet been calculated for game "+e.game_id,type:d.TYPES.error})):e.length?this._renderResults():(this.$(b).empty(),d({sel:b,title:"No Results Found",msg:"Sorry, but we didn't find any results for game "+e.game_id,type:d.TYPES.error}))},onError:function(e,t){var n;return this.$(b).empty(),d({sel:b,title:"Error Getting Results",msg:(null!=(n=t.responseJSON)?n.status.message:void 0)||t.statusText,type:d.TYPES.error})},onClickFriendSurvey:function(){return p.analytics.trackKeyMetric("Friend Survey","Clicked Email Link")},onClickSurveyPreview:function(){return p.analytics.trackKeyMetric("Friend Survey","Clicked Survey Preview")}})}),define("text!pages/home.hbs",[],function(){return'\n<div class="heroHolder">\n    <div class="hero majorSection">\n        <h1>\n            <!--Awareness is<br/>-->\n            <!--the beginning<br/>-->\n            <!--of improvement.-->\n            Discover Your <br/>\n            Personality Type\n\n        </h1>\n\n        <!--<h1>Meet TidePool.</h1>-->\n\n        <p>\n            <span class="shadowWarrior">\n                <a href="#startGame" class="btn btn-large btn-primary">Play Personality Game</a>\n            </span>\n        </p>\n        <p class=\'whisper\'>Only Takes 5 Minutes</p>\n    </div>\n</div>\n\n\n\n<div class="majorDivider withContent">\n    <div class="valueDesc">\n        <ul>\n            <!-- Personality -->\n            <!--<li>Learn your personality type</li>-->\n            <li>A <em>fun</em>, scientifically validated game helps you <em>discover your personality.</em></li>\n            <!--<li>Discover who you are</li>-->\n\n            <!-- Results -->\n            <!--<li>See an accurate description of yourself with charts, graphs, and recommendations</li>-->\n            <!--<li>We show you graphs and descriptions of your personality and interests</li>-->\n            <!--<li>See your strengths and weaknesses described in easy-to-understand charts</li>-->\n            <!--<li>Learn how to play up your strengths and improve your weaknessess</li>-->\n\n\n            <li class="hasImg">\n                <img src="images/home_page/lightbulb.png" alt="Game being played"/>\n            </li>\n\n            <!-- Social -->\n            <!--<li>Find out what your friends think of you</li>-->\n            <!--<li>Find out how you\'re preceived by your peers</li>-->\n\n\n            <li><em>Get recommendations</em> based on your personal traits.</li>\n\n            <!--<li>Track the changes in your mood over time</li>-->\n\n            <!--<li>See how your emotions and mental sharpness relate</li>-->\n            <!--<li>Uncover how your emotions change over time</li>-->\n            <!--<li>Track your emotions over time</li>-->\n            <!--<li>Track your mental sharpness over time</li>-->\n            <!--<li>Improve your mental sharpness</li>-->\n            <!--<li>Track and uncover your daily emotions</li>-->\n            <!--<li>Learn how to be more productive</li>-->\n        </ul>\n    </div>\n</div>\n\n\n<div class="aboutHolder"><div class="aboutPage majorSection clearfix">\n    <h2>How Does it Work?</h2>\n    <section class="col3rds">\n        <p>\n            Play easy games that measure your personality, emotions, and psychology.\n        </p>\n        <img src="images/home_page/about-graphics_01b.png" alt="Game being played"/>\n    </section>\n\n    <section class="col3rds">\n        <p>\n            Our patented technology will generate helpful recommendations and insightful results.\n        </p>\n        <img src="images/home_page/about-graphics_02b.png" alt="Personality Badges"/>\n    </section>\n\n    <section class="col3rds">\n        <p>\n            As you play more games,\n            you\'ll be able to compare each aspect of your self, mood, productivity, and health.\n        </p>\n        <img src="images/home_page/about-graphics_03b.png" alt="Self Improvement Map"/>\n    </section>\n</div></div>\n\n\n\n<div class="majorDivider"></div>\n\n\n\n<div class="teamHolder"><div class="teamPage majorSection">\n\n    <h2>Meet the TidePool Team</h2>\n    <p>\n        <div class="coolPerson"><i class="avatar huge"><img src="images/people/galen.jpg" alt="Photo of Team Member"/></i>\n            <p>Galen<br/>Buckwalter</p>\n        </div>\n        <div class="coolPerson"><i class="avatar huge"><img src="images/people/vamsee.jpg" alt="Photo of Team Member"/></i>\n            <p>Vamsee<br/>Nalamothu</p>\n        </div>\n        <div class="coolPerson"><i class="avatar huge"><img src="images/people/kerem.jpg" alt="Photo of Team Member"/></i>\n            <p>Kerem<br/>Karatal</p>\n        </div>\n        <div class="coolPerson"><i class="avatar huge"><img src="images/people/miraj.jpg" alt="Photo of Team Member"/></i>\n            <p>Miraj<br/>Sanghvi</p>\n        </div>\n        <div class="coolPerson"><i class="avatar huge"><img src="images/people/eric.jpg" alt="Photo of Team Member"/></i>\n            <p>Eric<br/>Miller</p>\n        </div>\n        <div class="coolPerson"><i class="avatar huge"><img src="images/people/jenni.jpg" alt="Photo of Team Member"/></i>\n            <p>Jenni<br/>Leder</p>\n        </div>\n        <div class="coolPerson"><i class="avatar huge"><img src="images/people/mayank.jpg" alt="Photo of Team Member"/></i>\n            <p>Mayank<br/>Sanganeria</p>\n        </div>\n    </p>\n\n    <hr>\n\n    <h2>Our Awesome Investors</h2>\n    <p>\n    <div class="supercoolPerson"><i class="avatar large"><img src="images/people/md.jpg" alt="Photo of Investor"/></i>\n        <p>Michael Dearing</p>\n        <p class="muted">Harrison Metal</p>\n    </div>\n    <div class="supercoolPerson"><i class="avatar large"><img src="images/people/mike.jpg" alt="Photo of Investor"/></i>\n        <p>Mike Hirshland</p>\n        <p class="muted">Resolute.VC</p>\n    </div>\n    <div class="supercoolPerson"><i class="avatar large"><img src="images/people/tim.jpg" alt="Photo of Investor"/></i>\n        <p>Tim Draper</p>\n        <p class="muted">DFJ</p>\n    </div>\n\n    <br/>\n    </p>\n\n    <br/>\n\n    <h3>And Support From</h3>\n\n    <p class="supercoolPerson caps">\n        Diego Berdakin,\n        Dan Gould,\n        Rich Rygg,\n        Jeff Lipp,\n        Jarl Mohn,<br/>\n        Jim & Peggy Davis,\n        Rak Tech Fund,\n        and Amplify\n    </p>\n\n</div></div>'}),define("pages/home",["backbone","Handlebars","text!./home.hbs"],function(e,t,n){var i;return i=e.View.extend({title:"Home",className:"homePage",tmpl:t.compile(n),render:function(){var e;return this.$el.html(this.tmpl()),null!=(e=this.layout)&&"function"==typeof e.shimmerLogo&&e.shimmerLogo(),this}})}),define("entities/results_calculator",["jquery","backbone"],function(e,t){var n,i,s,r;return r="entities/results_calculator",s=2,i=15,n=t.Model.extend({STATES:{pending:"pending",error:"error",done:"done"},urlRoot:function(){return""+window.apiServerUrl+"/api/v1/users/-/games/"+this.get("game_id")+"/results"},initialize:function(){return this.tries=0,this.on("sync",this.onSync),this.tryTryAgain()},tryTryAgain:function(){return this.polls=0,this.fetch()},pollForProgress:function(t){var n,s=this;return n=e.ajax({type:"GET",url:t}),n.done(function(e,t,n){switch(200!==n.status&&console.log("Unexpected StatusCode: "+n.status),e.status.state){case s.STATES.pending:return s.polls+=1,s.polls>=i?s.trigger("error",s,"Timed out waiting for results."):setTimeout(function(){return s.pollForProgress(e.status.link)},500);case s.STATES.done:return s.set("status",e.status);case s.STATES.error:return s._handleServerError(e);default:return s.trigger("error",s,"Unexpected status "+e.status.state)}}),n.fail(function(e,t,n){return s.trigger("error",s,t,{jqXHR:e,textStatus:t,errorThrown:n})})},_handleServerError:function(e){return this.tries++,console.log("Error on try "+this.tries),this.tries>=s?this.trigger("error",this,e.status.message):this.tryTryAgain()},onSync:function(e){return this.pollForProgress(e.attributes.status.link)}})}),define("entities/user_event/_events",["backbone","classes/model","core"],function(e,t){var n,i;return i=t.extend({defaults:function(){return{event:null,time:(new Date).getTime()}},initialize:function(){return this.on("invalid",function(e,t){return console.warn("event model invalid: "+t)})},validate:function(e){return e.event?null:"Requires the `event` property"}}),n=e.Collection.extend({model:i})}),define("utils/detect",[],function(){var e;return e={isTouch:function(){return!!("ontouchstart"in window)||!!("onmsgesturechange"in window)},isUIwebView:function(){return/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent)}}}),define("entities/user_event/_event_bundle",["underscore","classes/model","./_events","utils/detect","core"],function(e,t,n,i,s){var r,o,a;return a={ImageRank:"image_rank",CirclesTest:"circles_test",ReactionTime:"reaction_time",Survey:"survey",Snoozer:"snoozer",EmotionsCircles:"emotions_circles",InterestPicker:"interest_picker"},o={start:"level_started",instructions:"show_instructions",sublevelStart:"sublevel_initialize",moveStart:"start_move",moveEnd:"end_move",interact:"interacted",change:"changed",resize:"resized",shown:"shown",decoy:"decoy",miss:"miss",correct:"correct",incorrect:"incorrect",selected:"selected",deselected:"deselected",readyToProceed:"ready_to_proceed",notReadyToProceed:"not_ready_to_proceed",summary:"level_summary",end:"level_completed"},r=t.extend({url:function(){return""+s.cfg.apiServer+"/api/v1/users/-/games/"+this.attributes.game_id+"/event_log"},isNew:function(){return!1},defaults:function(){return{event_type:null,stage:null,events:new n,timezone_offset:(new Date).getTimezoneOffset(),is_touch:i.isTouch()}},initialize:function(){if(!this.attributes.event_type)throw new Error("Need event_type");if("string"!=typeof this.attributes.event_type)throw new Error("event_type should be a string");if("number"!=typeof this.attributes.stage)throw new Error("Need stage as a number");if(!this.attributes.game_id)throw new Error("Need game_id");return this.on("error",this.onErr),this._translateEventType()},validate:function(e){return e.events.length>0?null:"Can't save unless there is at least 1 event"},toJSON:function(){var t;return t=e.clone(this.attributes),t.events=t.events.toJSON(),{event_log:t}},_translateEventType:function(){var e;return e=a[this.attributes.event_type],null!=e&&this.set({event_type:e}),this},onErr:function(e,t){var n;return console.error({message:(null!=(n=t.responseJSON)?n.status.message:void 0)||t.statusText,model:e,xhr:t})},record:function(t,n){return this.attributes.events.add(t,e.extend({validate:!0},n)),this}}),r.EVENTS=o,r}),define("text!ui_widgets/steps_remaining.hbs",[],function(){return'\n\n\n<div class="pillHolder">\n    {{#each levels}}\n        <div\n            class="step {{#isComplete}}completed{{/isComplete}}"\n            title="{{ friendly_name }}"\n            style="width:{{ ../width }}"\n        >\n        </div>\n    {{/each}}\n</div>\n\n{{#if title}}\n    <h3 class="title">\n        {{title}}\n    </h3>\n{{/if}}\n'}),define("ui_widgets/steps_remaining",["backbone","Handlebars","text!./steps_remaining.hbs"],function(e,t,n){var i,s;return s=t.compile(n),i=e.View.extend({className:"stepsRemaining",initialize:function(){if(!this.collection)throw new Error("Need a collection");return this.listenTo(this.collection,"change:isComplete",this.render)},render:function(){return this.$el.html(s({title:this.options.title,levels:this.collection.toJSON(),width:""+Math.floor(100*(1/this.collection.length))+"%"})),this},setComplete:function(e){var t;return t=this.collection.at(e),null!=t?t.set("isComplete",!0):void 0}})}),define("text!ui_widgets/proceed.hbs",[],function(){return'\n<i class="icon-circle-blank"></i>\n<i class="icon-arrow-right"></i>'}),define("ui_widgets/proceed",["jquery","backbone","text!./proceed.hbs"],function(e,t,n){var i,s,r;return s="ui_widgets/proceed",r="body",i=t.View.extend({tagName:"button",className:"proceed",events:{click:"onClick"},initialize:function(){return _.bindAll(this,"show","hide")},render:function(){return this.$el.is(":visible")?void 0:(this.$el.html(n),e(r).append(this.el),this.delegateEvents(),this._animateIn(),this)},_animateIn:function(){var e=this;return this.$el.removeClass("bounceIn"),setTimeout(function(){return e.$el.addClass("bounceIn",1)})},onClick:function(){return this.trigger("click")},show:function(){return this.render()},hide:function(){return this.remove()}}),new i}),define("game/levels/_base/main",["underscore","backbone","entities/user_event/_event_bundle","composite_views/perch","ui_widgets/proceed"],function(e,t,n,i,s){var r,o;return o="game/levels/_base",r=t.View.extend({initialize:function(){if(null==this.options.assessment||null==this.options.stageNo||null==this.options.stageDef)throw new Error("Need assessment and stageNo and stageDef");return this.event=new n({event_type:this.options.stageDef,stage:this.options.stageNo,game_id:this.options.assessment.get("id")}),null!=this.model.attributes.data&&(this.collection=this.CollectionClass?new this.CollectionClass(this.model.attributes.data):new t.Collection(this.model.attributes.data)),"function"==typeof this.start?this.start():this.track(n.EVENTS.start)},clearInteracted:function(e){return e.each(function(e){return e.set("interacted",null)})},checkAllInteracted:function(e){var t;return t=e.filter(function(e){return e.get("interacted")}),t.length===e.length?!0:void 0},readyToProceed:function(){return this.alreadyReady?void 0:(this.alreadyReady=!0,s.show(),this.listenToOnce(s,"click",this.endLevel),this.track(n.EVENTS.readyToProceed))},notReadyToProceed:function(){return this.alreadyReady?(this.alreadyReady=!1,s.hide(),this.stopListening(s),this.track(n.EVENTS.notReadyToProceed)):void 0},endLevel:function(){return s.hide(),this.track(n.EVENTS.summary,this.summaryData),this.track(n.EVENTS.end),this.event.save(),this.trigger("done",this.summaryData),"function"==typeof this.close&&this.close(),this.remove(),this.options.assessment.nextStage()},track:function(t,n){var i;return i={event:t},this.event.record(e.extend(i,n))},remove:function(){return s.hide(),this.$el.remove(),this.stopListening(),this}}),r.EVENTS=n.EVENTS,r}),define("game/levels/_base",["game/levels/_base/main"],function(e){return e}),define("text!game/levels/reaction_time_disc/main.hbs",[],function(){return'\n\n<div id="CircleColorizer">\n    <a id="ReactionTimeTarget" class="circle" href="#">\n        <i class="icon-ok icon-4x"></i>\n    </a>\n</div>\n\n\n\n'}),define("text!game/levels/reaction_time_disc/instructions-simple.hbs",[],function(){return'\n<p>\n    Click on the circle as soon as it turns red.\n</p>\n<p class="textAlignCenter">\n    <img src="images/game/instructions/reaction_time_disc_a.jpg" alt="Hand pressing a red disc"/>\n</p>\n'}),define("text!game/levels/reaction_time_disc/instructions-complex.hbs",[],function(){return'\n<p>\n    Click the red circle only when it appears AFTER a yellow circle.\n</p>\n<p class="textAlignCenter">\n    <img src="images/game/instructions/reaction_time_disc_b.jpg" alt="Hand pressing a red disc"/>\n</p>\n'}),define("game/levels/reaction_time_disc/main",["underscore","backbone","Handlebars","game/levels/_base","text!./main.hbs","text!./instructions-simple.hbs","text!./instructions-complex.hbs","composite_views/perch"],function(e,t,n,i,s,r,o,a){var l,c,h,u,d,p,f,m,g,v;return m="game/levels/reaction_time_disc",u="#CircleColorizer",v="yellow",g="red",d="target",p="hit",h=750,f=1500,c={simple:"simple",complex:"complex"},l=i.extend({className:"reactionTimeDisc",events:{"click #ReactionTimeTarget":"_onCircleClicked","click .target #ReactionTimeTarget":"_onCorrectClick"},start:function(){return this.stageNo=this.options.stageNo,this.assessment=this.options.assessment,this.sequenceType=this.model.get("sequence_type"),this.colorSequence=this.model.get("sequence"),this.sequenceNo=-1,this.numOfSequences=this.colorSequence.length,e.bindAll(this,"_showCircle","_end","_start")},render:function(){var e;return e=this.sequenceType===c.simple?r:o,this.$el.html(s),a.show({content:e,large:!0,btn1Text:"I'm Ready",onClose:this._start,supressTracking:!0}),this},_start:function(){var e,t;return t=function(){var t,n,i,s;for(i=this.colorSequence,s=[],t=0,n=i.length;n>t;t++)e=i[t],s.push(e.color+":"+e.interval);return s}.call(this).slice(0),this.track(i.EVENTS.start,{sequence_type:this.sequenceType,data:t}),$("#infobox").css("visibility","hidden"),this._waitAndShow()},_showCircle:function(){var e,t,n;if(this.sequenceNo++,this.sequenceNo<this.numOfSequences){if(e=this.colorSequence[this.sequenceNo],n=this.colorSequence[this.sequenceNo-1],this.track(i.EVENTS.shown,{color:e.color,index:this.sequenceNo,time_interval:e.interval}),$(u).prop("class",e.color),this.sequenceType===c.simple&&e.color===g?$(u).addClass(d):this.sequenceType===c.complex&&e.color===g&&(null!=n?n.color:void 0)===v&&$(u).addClass(d),t=this.sequenceNo+1,t<this.numOfSequences)return this._waitAndShow();if(t===this.numOfSequences)return this._waitAndEnd()}},_waitAndShow:function(){var e;return e=this.colorSequence[this.sequenceNo+1].interval,this.step=setTimeout(this._showCircle,e)},_waitAndEnd:function(){return this.step=setTimeout(this._end,f)},_end:function(){return this.endLevel()},_onCircleClicked:function(e){var t,n;return e.preventDefault(),t=this.colorSequence[this.sequenceNo],n=this.colorSequence[this.sequenceNo-1],this.sequenceNo<=0?this._trackIncorrect():this.sequenceType===c.simple&&t.color===g?this._trackCorrect():this.sequenceType===c.complex&&t.color===g&&n.color===v?this._trackCorrect():this._trackIncorrect()},_onCorrectClick:function(){return $(u).addClass(p)},_trackCorrect:function(){var e;return e=this.colorSequence[this.sequenceNo],e.alreadyTracked?void 0:(this.track(i.EVENTS.correct,{color:e.color,index:this.sequenceNo}),e.alreadyTracked=!0)},_trackIncorrect:function(){var e;return this.track(i.EVENTS.incorrect,{color:(null!=(e=this.colorSequence[this.sequenceNo])?e.color:void 0)||"blank",index:this.sequenceNo})},close:function(){return this.step?clearTimeout(this.step):void 0}})}),define("game/levels/reaction_time_disc",["game/levels/reaction_time_disc/main"],function(e){return e}),define("text!game/levels/rank_images/main.hbs",[],function(){return'\n\n<ul id="RankingArea" class="rankingArea connectedSortable">\n\n</ul>\n\n<ul id="UnrankedArea" class="unrankedArea connectedSortable">\n\n</ul>\n\n\n'}),define("text!game/levels/rank_images/rankable_image_view.hbs",[],function(){return'\n\n<img src="{{url}}" alt="{{image_id}}" data-id="{{image_id}}" />\n\n\n'}),define("game/levels/rank_images/rankable_image_view",["backbone","Handlebars","text!./rankable_image_view.hbs"],function(e,t,n){var i,s,r,o;return s="game/levels/rank_images/rankable_image_view",r=".rankImages",o=".dropTarget",i=e.View.extend({tmpl:t.compile(n),className:"rankableImage",tagName:"li",attributes:{tabindex:2},initialize:function(){},render:function(){return this.$el.html(this.tmpl(this.model.attributes)),this}})}),define("game/levels/rank_images/rankable_images",["backbone","./rankable_image_view"],function(e,t){var n,i,s,r;return r="game/levels/rank_images/rankable_images Model",i=e.Model.extend({defaults:{rank:null},initialize:function(){return this.view=new t({model:this})}}),s="game/levels/rank_images/rankable_images Collection",n=e.Collection.extend({model:i})}),define("jqueryui/sortable",["jquery","./core","./mouse","./widget"],function(e){!function(e){function t(e,t,n){return e>t&&t+n>e}function n(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||n(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var i=null,s=!1,r=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,r.widgetName+"-item")===r?(i=e(this),!1):void 0}),e.data(t.target,r.widgetName+"-item")===r&&(i=e(t.target)),i?!this.options.handle||n||(e(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(s=!0)}),s)?(this.currentItem=i,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,n,i){var s,r,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(r)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,i,s,r,o=this.options,a=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?a=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(a=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?a=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(a=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),a!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(i=this.items[n],s=i.item[0],r=this._intersectsWithPointer(i),r&&i.instance===this.currentContainer&&s!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==s&&!e.contains(this.placeholder[0],s)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],s):!0)){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,s=this.placeholder.offset(),r=this.options.axis,o={};r&&"x"!==r||(o.left=s.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(o.top=s.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each(function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,s=i+this.helperProportions.height,r=e.left,o=r+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,h=this.offset.click.left,u="x"===this.options.axis||i+c>a&&l>i+c,d="y"===this.options.axis||t+h>r&&o>t+h,p=u&&d;
return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:r<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&a<i+this.helperProportions.height/2&&s-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var n="x"===this.options.axis||t(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||t(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=n&&i,r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return s?this.floating?o&&"right"===o||"down"===r?2:1:r&&("down"===r?2:1):!1},_intersectsWithSides:function(e){var n=t(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"===r&&i||"left"===r&&!i:s&&("down"===s&&n||"up"===s&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,i,s,r,o=[],a=[],l=this._connectWith();if(l&&t)for(n=l.length-1;n>=0;n--)for(s=e(l[n]),i=s.length-1;i>=0;i--)r=e.data(s[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&a.push([e.isFunction(r.options.items)?r.options.items.call(r.element):e(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(a.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=a.length-1;n>=0;n--)a[n][0].each(function(){o.push(this)});return e(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,i,s,r,o,a,l,c,h=this.items,u=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(n=d.length-1;n>=0;n--)for(s=e(d[n]),i=s.length-1;i>=0;i--)r=e.data(s[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(u.push([e.isFunction(r.options.items)?r.options.items.call(r.element[0],t,{item:this.currentItem}):e(r.options.items,r.element),r]),this.containers.push(r));for(n=u.length-1;n>=0;n--)for(o=u[n][1],a=u[n][0],i=0,c=a.length;c>i;i++)l=e(a[i]),l.data(this.widgetName+"-item",o),h.push({item:l,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,i,s,r;for(n=this.items.length-1;n>=0;n--)i=this.items[n],i.instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(s=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item,t||(i.width=s.outerWidth(),i.height=s.outerHeight()),r=s.offset(),i.left=r.left,i.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)r=this.containers[n].element.offset(),this.containers[n].containerCache.left=r.left,this.containers[n].containerCache.top=r.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,i=t.options;i.placeholder&&i.placeholder.constructor!==String||(n=i.placeholder,i.placeholder={element:function(){var i=t.currentItem[0].nodeName.toLowerCase(),s=e("<"+i+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===i?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(s)}):"img"===i&&s.attr("src",t.currentItem.attr("src")),n||s.css("visibility","hidden"),s},update:function(e,s){(!n||i.forcePlaceholderSize)&&(s.height()||s.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),s.width()||s.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(i.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),i.placeholder.update(t,t.placeholder)},_contactContainers:function(i){var s,r,o,a,l,c,h,u,d,p,f=null,m=null;for(s=this.containers.length-1;s>=0;s--)if(!e.contains(this.currentItem[0],this.containers[s].element[0]))if(this._intersectsWith(this.containers[s].containerCache)){if(f&&e.contains(this.containers[s].element[0],f.element[0]))continue;f=this.containers[s],m=s}else this.containers[s].containerCache.over&&(this.containers[s]._trigger("out",i,this._uiHash(this)),this.containers[s].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",i,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(o=1e4,a=null,p=f.floating||n(this.currentItem),l=p?"left":"top",c=p?"width":"height",h=this.positionAbs[l]+this.offset.click[l],r=this.items.length-1;r>=0;r--)e.contains(this.containers[m].element[0],this.items[r].item[0])&&this.items[r].item[0]!==this.currentItem[0]&&(!p||t(this.positionAbs.top+this.offset.click.top,this.items[r].top,this.items[r].height))&&(u=this.items[r].item.offset()[l],d=!1,Math.abs(u-h)>Math.abs(u+this.items[r][c]-h)&&(d=!0,u+=this.items[r][c]),Math.abs(u-h)<o&&(o=Math.abs(u-h),a=this.items[r],this.direction=d?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;a?this._rearrange(i,a,null,!0):this._rearrange(i,null,this.containers[m].element,!0),this._trigger("change",i,this._uiHash()),this.containers[m]._trigger("change",i,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",i,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!i[0].style.width||n.forceHelperSize)&&i.width(this.currentItem.width()),(!i[0].style.height||n.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,s=this.options;"parent"===s.containment&&(s.containment=this.helper[0].parentNode),("document"===s.containment||"window"===s.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===s.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===s.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(s.containment)||(t=e(s.containment)[0],n=e(s.containment).offset(),i="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:s.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:s.scrollLeft())*i}},_generatePosition:function(t){var n,i,s=this.options,r=t.pageX,o=t.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),s.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/s.grid[1])*s.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-s.grid[1]:n+s.grid[1]:n,i=this.originalPageX+Math.round((r-this.originalPageX)/s.grid[0])*s.grid[0],r=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-s.grid[0]:i+s.grid[0]:i)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var s=this.counter;this._delay(function(){s===this.counter&&this.refreshPositions(!i)})},_clear:function(e,t){this.reverting=!1;var n,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||i.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||i.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over&&(i.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),n=0;n<i.length;n++)i[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(n=0;n<i.length;n++)i[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(e)}),define("game/levels/rank_images/main",["backbone","Handlebars","game/levels/_base","text!./main.hbs","./rankable_images","jqueryui/sortable"],function(e,t,n,i,s){var r,o,a,l,c,h,u,d,p;return a="game/levels/rank_images",u="#RankingArea",p="#UnrankedArea",h=".rankableImage",c=".proceed",d=".connectedSortable",l='<li class="message">Rank from favorite to least favorite by clicking or dragging images.</li>',o={ranked:"image_ranked",unranked:"image_rank_cleared"},r=n.extend({className:"rankImages",start:function(){return this.collection=new s(this.model.get("image_sequence")),this.options.instructions.set({text:this.model.get("instructions")}),_.bindAll(this,"onOver","onSortStart","onSortEnd","onUnrankedImageClick","onRankedImageClick","onUnrankedImageKeypress","onRankedImageKeypress"),this.listenTo(this.collection,"change:rank",this.onRankChange),this.track(n.EVENTS.start,{data:this.collection.toJSON()})},render:function(){var e=this;return this.$el.html(i),require(["jquiTouchPunch"],function(){return e.collection.each(function(t){return e.$(p).append(t.view.render().el)}),e.$msg=$(l),e._checkOnMsg(),e.$(d).sortable({containment:"."+e.className,placeholder:"rankableImage placeholder",connectWith:d,cancel:"."+e.$msg.prop("class"),over:e.onOver,start:e.onSortStart,stop:e.onSortEnd}),e.$(d).disableSelection(),e.$(p).on("keypress",".rankableImage",e.onUnrankedImageKeypress),e.$(u).on("keypress",".rankableImage",e.onRankedImageKeypress),navigator.userAgent.toLowerCase().indexOf("firefox")>-1?void 0:(e.$(p).on("click",".rankableImage",e.onUnrankedImageClick),e.$(u).on("click",".rankableImage",e.onRankedImageClick))}),this},_checkOnMsg:function(){return this.$(u).children().length?this._hideMsg():this._showMsg()},_showMsg:function(){return this.$(u).append(this.$msg)},_hideMsg:function(){return this.$msg.remove()},_checkOnRanks:function(){var e;return this.collection.each(function(e){return e.view.$el.parent(u).length?e.set({rank:e.view.$el.index()}):e.set({rank:e.defaults.rank})}),this._buildRankArrayForServer(),e=this.collection.filter(function(e){var t;return t=e.attributes.rank,t||0===t?!0:void 0}),e.length===this.collection.length?this.readyToProceed():this.notReadyToProceed()},_buildRankArrayForServer:function(){return this.summaryData={final_rank:this.collection.pluck("rank")}},onUnrankedImageKeypress:function(e){var t;if(e.charCode||32===e.which)return this.onUnrankedImageClick(e),t=this.$(p).find(h).first(),t?t.focus():void 0},onRankedImageKeypress:function(e){return e.charCode||32===e.which?this.onRankedImageClick(e):void 0},onUnrankedImageClick:function(e){return this.$(u).append(e.currentTarget),this._checkOnMsg(),this._checkOnRanks()},onRankedImageClick:function(e){return this.$(p).append(e.currentTarget),this._checkOnMsg(),this._checkOnRanks()},onOver:function(){return this._checkOnMsg()},onSortStart:function(e){var t;return t=$(e.currentTarget).find("img").data("id"),this._trackDragged(t)},onSortEnd:function(){return this._checkOnRanks()},onRankChange:function(e,t){return null===t?this._trackRankCleared(e.attributes.image_id,e.previous("rank")):this._trackRanked(e.attributes.image_id,t)},_trackRanked:function(e,t){return this.track(o.ranked,{image_no:e,rank:t})},_trackRankCleared:function(e,t){return this.track(o.unranked,{image_no:e,prev_rank:t})},_trackDragged:function(e){return this.track(n.EVENTS.moveStart,{image_no:e})}})}),define("game/levels/rank_images",["game/levels/rank_images/main"],function(e){return e}),define("entities/circles",["backbone","classes/model"],function(e,t){var n,i,s;return s="game/levels/circle_proximity/circles",n=t.extend({maxSize:4,baseSizePx:75,sizeToScale:[.4,.7,1,1.3,1.6],sizeToClass:["size1","size2","size3","size4","size5"],defaults:{selfProximityPx:null,selfOverlapPx:null,selfOverlapRatio:null,userChangedSize:!1,userChangedPos:!1,width:null,top:0,left:0,pos:{x:0,y:0}},initialize:function(){return this._calcAbbreviation(),this._calcImageUrl(),this.set("size",2),this._setWidthBySize(this.get("size")),this.on("change:size",this.onChangeSize),this.on("change:pos",this.onChangePos)},_calcAbbreviation:function(){var e,t,n;return t=this.get("trait1"),n=this.get("trait2"),t&&n?(t=t.charAt(0),n=n.charAt(0),e=""+t+"<em>/</em>"+n,this.set("abbreviation",e)):void 0},_calcImageUrl:function(){var e;return(e=this.get("image_id"))?this.set("image_url","/images/game/emotions/"+e+".png"):void 0},_setWidthBySize:function(e){return this.set({width:this.sizeToScale[e]*this.baseSizePx})},onChangeSize:function(e,t){return this.set({userChangedSize:!0,interacted:!0}),this._setWidthBySize(t)},onChangePos:function(){return this.set({userChangedPos:!0,interacted:!0})},getScale:function(){return this.sizeToScale[this.get("size")]}}),i=e.Collection.extend({model:n})}),define("text!game/levels/circle_size/instructions.hbs",[],function(){return"<p>\n    You are on a roll!\n</p>\n<p>\n    In this next game, each circle represents a psychological trait.\n</p>\n<p>\n    Collapse or expand each circle to show how well each trait describes you.\n</p>\n<p>\n    Make sure to change the size of all five circles.\n</p>\n\n\n\n\n\n\n"}),define("game/levels/circle_size/circle_view",["backbone"],function(e){var t,n;return n="game/levels/circle_proximity/circle_view",t=e.View.extend({className:"circle",initialize:function(){return this.listenTo(this.model,"change:size",this.onChangeSize)},render:function(){return this.$el.html(this.model.get("abbreviation")),this.setClassBySize(this.model.get("size")),this},onChangeSize:function(e,t){return this.setClassBySize(t)},removeSizeClass:function(){var e,t,n,i,s;for(i=this.model.sizeToClass,s=[],t=0,n=i.length;n>t;t++)e=i[t],s.push(this.$el.removeClass(e));return s},setClassBySize:function(e){return this.removeSizeClass(),this.$el.addClass(this.model.sizeToClass[e])}})}),define("text!game/levels/circle_size/sizey_view.hbs",[],function(){return'\n<div class="slider needsclick"></div>\n\n<label>\n    {{trait1}}<br/>\n    {{trait2}}\n</label>\n'}),define("game/levels/circle_size/sizey_view",["backbone","Handlebars","./circle_view","text!./sizey_view.hbs","fastclick","jqueryui/slider"],function(e,t,n,i){var s,r,o,a,l,c;return o="game/levels/circle_proximity/sizey_view",c=".slider",l=".ui-slider-handle",r=".circle",a="needsclick",s=e.View.extend({className:"sizey",tmpl:t.compile(i),initialize:function(){return _.bindAll(this,"onSlide","onFocus","onClick"),this.circle=new n({model:this.model})},render:function(){return this.$el.html(this.circle.render().el),this.$el.append(this.tmpl(this.model.attributes)),this.$el.find(c).slider({value:this.model.get("size"),max:this.model.maxSize,slide:this.onSlide}),this.$(l).on("click",this.onClick),this.$(l).on("focus",this.onFocus),this},onSlide:function(e,t){return this.model.set({size:t.value,interacted:!0})},onClick:function(){return this.model.set({interacted:!0})},onFocus:function(){return this.model.set({interacted:!0})}})}),define("game/levels/circle_size/main",["underscore","backbone","entities/circles","game/levels/_base","text!./instructions.hbs","./sizey_view","composite_views/perch","ui_widgets/proceed"],function(e,t,n,i,s,r,o,a){var l;return l=i.extend({className:"circleSize",initialize:function(){return this.listenTo(this.collection,"change:interacted",this.onChangeInteracted),this.listenTo(this.collection,"change:size",this.onChangeSize),this.listenToOnce(a,"click",this._close),e.bindAll(this,"render"),this.options.showInstructions?o.show({content:s,btn1Text:"I'm Ready",onClose:this.render,mustUseButton:!0,supressTracking:!0}):this.render()},render:function(){var e=this;return this.collection.each(function(t){return t.view=new r({model:t}),e.$el.append(t.view.render().el)}),this},_close:function(){return this.collection.each(function(e){var t;return null!=(t=e.view)?"function"==typeof t.remove?t.remove():void 0:void 0}),a.hide(),this.clearInteracted(this.collection),this.trigger("done"),this.remove()},onChangeSize:function(e,t){return this.options.runner.track(i.EVENTS.resize,{index:e.collection.indexOf(e),new_size:t})},onChangeInteracted:function(){return this.checkAllInteracted(this.collection)?a.show():void 0}})}),define("game/levels/circle_size",["game/levels/circle_size/main"],function(e){return e}),define("text!game/levels/circle_proximity/instructions.hbs",[],function(){return'\n<p>\n    Great!\n</p>\n<p>\n    Now, place the circles that you consider most important closer to the large green circle, and place the less important ones further away.\n</p>\n<p class="textAlignCenter">\n    <img src="images/game/instructions/circle_proximity.jpg" alt="Hand dragging a blue circle towards a green one"/>\n</p>'}),define("text!game/levels/circle_proximity/self.hbs",[],function(){return'\n<div class="line"></div>\n<i class="user gfx-user_circles"></i>\n<div class="borderPatrol"></div>\n\n'}),define("game/levels/circle_proximity/self_view",["backbone","text!./self.hbs"],function(e,t){var n,i,s;return n=e.Model.extend({defaults:{pxSize:200,size:200,top:200,left:0}}),s="game/levels/circle_proximity/self_view",i=e.View.extend({id:"SelfCircle",className:"self",initialize:function(){return this.model=new n},render:function(){return this.$el.html(t),this},_setCssStyling:function(e){return this.$el.css({top:e.top,left:e.left})},_calculateSelfCenter:function(){return this._center={x:this.$el.parent().width()/2,y:this.model.get("top")+this.getSelfRadius()},this._center},getSelfCenter:function(){return this._center||this._calculateSelfCenter()},getSelfRadius:function(){return this._radius||this.model.get("pxSize")/2},position:function(){var e;return e=this.getSelfCenter().x-this.model.get("pxSize")/2,this.model.set({left:e}),this._setCssStyling(this.model.attributes),this}})}),define("text!game/levels/circle_proximity/proxy_view.hbs",[],function(){return'\n\n{{#if image_url}}\n\n    <div tabindex="2" class="circle hasImage">\n        {{#if image_url}}\n            <img src="{{image_url}}" alt="Image representing emotion(s)"/>\n        {{/if}}\n    </div>\n\n{{else}}\n\n    <div tabindex="2" class="circle">{{{abbreviation}}}</div>\n    <label>\n        <span class="inner">\n            <b class="fluff arrowTop"></b>\n            {{trait1}}<br/>\n            {{trait2}}\n        </span>\n    </label>\n\n{{/if}}\n'}),define("jqueryui/draggable",["jquery","./core","./mouse","./widget"],function(e){!function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}
},_setContainment:function(){var t,n,i,s=this.options;return s.containment?"window"===s.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===s.containment?(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):s.containment.constructor===Array?(this.containment=s.containment,void 0):("parent"===s.containment&&(s.containment=this.helper[0].parentNode),n=e(s.containment),i=n[0],i&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n),void 0):(this.containment=null,void 0)},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:s.scrollTop(),left:s.scrollLeft()}),{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*i}},_generatePosition:function(t){var n,i,s,r,o=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=t.pageX,c=t.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),o.grid&&(s=o.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,c=n?s-this.offset.click.top>=n[1]||s-this.offset.click.top>n[3]?s:s-this.offset.click.top>=n[1]?s-o.grid[1]:s+o.grid[1]:s,r=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=n?r-this.offset.click.left>=n[0]||r-this.offset.click.left>n[2]?r:r-this.offset.click.left>=n[0]?r-o.grid[0]:r+o.grid[0]:r)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("ui-draggable"),s=i.options,r=e.extend({},n,{item:i.element});i.sortables=[],e(s.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,r))})},stop:function(t,n){var i=e(this).data("ui-draggable"),s=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,s))})},drag:function(t,n){var i=e(this).data("ui-draggable"),s=this;e.each(i.sortables,function(){var r=!1,o=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(r=!0,e.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(r=!1),r})),r?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(s).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),s=e(this).data("ui-draggable").options;i.css("opacity")&&(s._opacity=i.css("opacity")),i.css("opacity",s.opacity)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),i=n.options,s=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=s=n.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=s=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=s=n.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=s=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(document).scrollTop()<i.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(document).scrollLeft()<i.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)))),s!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),i=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(t,n){var i,s,r,o,a,l,c,h,u,d,p=e(this).data("ui-draggable"),f=p.options,m=f.snapTolerance,g=n.offset.left,v=g+p.helperProportions.width,b=n.offset.top,y=b+p.helperProportions.height;for(u=p.snapElements.length-1;u>=0;u--)a=p.snapElements[u].left,l=a+p.snapElements[u].width,c=p.snapElements[u].top,h=c+p.snapElements[u].height,a-m>v||g>l+m||c-m>y||b>h+m||!e.contains(p.snapElements[u].item.ownerDocument,p.snapElements[u].item)?(p.snapElements[u].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(i=Math.abs(c-y)<=m,s=Math.abs(h-b)<=m,r=Math.abs(a-v)<=m,o=Math.abs(l-g)<=m,i&&(n.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),s&&(n.position.top=p._convertPositionTo("relative",{top:h,left:0}).top-p.margins.top),r&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),d=i||s||r||o,"outer"!==f.snapMode&&(i=Math.abs(c-b)<=m,s=Math.abs(h-y)<=m,r=Math.abs(a-g)<=m,o=Math.abs(l-v)<=m,i&&(n.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),s&&(n.position.top=p._convertPositionTo("relative",{top:h-p.helperProportions.height,left:0}).top-p.margins.top),r&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[u].snapping&&(i||s||r||o||d)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=i||s||r||o||d)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,i=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});i.length&&(t=parseInt(e(i[0]).css("zIndex"),10)||0,e(i).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+i.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),s=e(this).data("ui-draggable").options;i.css("zIndex")&&(s._zIndex=i.css("zIndex")),i.css("zIndex",s.zIndex)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(e)}),define("game/levels/circle_proximity/proxy_view",["underscore","backbone","Handlebars","text!./proxy_view.hbs","game/levels/_base","jqueryui/draggable"],function(e,t,n,i,s){var r,o,a,l,c,h,u;return u="game/levels/circle_proximity/proxy_view",l=".circle",o="yay",h="fresh",c=".ui-draggable",a=function(e,t){var n;return n={x:e.x-t.x,y:e.y-t.y}},r=t.View.extend({className:"proxy "+h,tmpl:n.compile(i),events:{"focus .circle":"onFocus","click .circle":"onClick"},initialize:function(){return e.bindAll(this,"onDragStart","onDrag","onDragStop")},render:function(){var e=this;return this.$el.html(this.tmpl(this.model.attributes)),this.$(l).addClass(this.model.sizeToClass[this.model.attributes.size]),require(["jquiTouchPunch"],function(){return e._makeDraggable()}),this},_makeDraggable:function(){return this.$el.draggable({handle:l,stack:c,start:this.onDragStart,drag:this.onDrag,stop:this.onDragStop})},_shimmerSelf:function(){var e,t=this;if(null!=(e=this.options.selfView)?e.$el:void 0)return this.options.selfView.$el.removeClass(o),setTimeout(function(){return t.options.selfView.$el.addClass(o,1)})},_showLine:function(){return null!=this.options.$line?this.options.$line.show():void 0},_maintainLine:function(e,t){var n,i,s,r,o;if(null!=this.options.$line)return r=this.coordToCenter({x:t.position.left,y:t.position.top}),s=this._calculateDistanceFromSelf(r),o=(s-200)/200,o>1&&(o=1),0>o&&(o=0),o=1-o,i=a(r,this.options.selfView.getSelfCenter()),n=180/Math.PI*Math.acos(i.y/s),i.x>0&&(n*=-1),this.options.$line.css({height:s,opacity:o,"-webkit-transform":"rotate("+n+"deg)","-moz-transform":"rotate("+n+"deg)","-o-transform":"rotate("+n+"deg)","-ms-transform":"rotate("+n+"deg)",transform:"rotate("+n+"deg)"})},_hideLine:function(){return null!=this.options.$line?this.options.$line.hide():void 0},_calculateDistanceFromSelf:function(e){var t,n,i;return i=this.options.selfView.getSelfCenter(),n=a(e,i),t=Math.sqrt(n.x*n.x+n.y*n.y)},_updateModelSelfOverlap:function(){var e,t,n,i,s;return s=this.options.selfView.getSelfRadius(),e=this.getCircleSize()/2,t=this.model.get("selfProximityPx"),s+e>t?(i=s+e-t,i>2*e&&(i=2*e)):i=null,n=i/(2*e),this.model.set({selfOverlapPx:i,selfOverlapRatio:n})},_updateModelPosition:function(){var e,t;return t=this.$el.position(),e=this.coordToCenter({x:t.left,y:t.top}),this.model.set({pos:{x:e.x,y:e.y},left:t.left,top:t.top,selfProximityPx:Math.round(this._calculateDistanceFromSelf(e))}),this._updateModelSelfOverlap(),this},onDragStart:function(){return this.$el.removeClass(h),this._showLine(),this.options.track(s.EVENTS.moveStart,{index:this.model.collection.indexOf(this.model),item:this.model.toJSON()})},onDrag:function(e,t){return this._maintainLine(e,t)},onDragStop:function(){return this._shimmerSelf(),this._hideLine(),this._updateModelPosition(),this.options.track(s.EVENTS.moveEnd,{index:this.model.collection.indexOf(this.model),item:this.model.toJSON()})},onFocus:function(){return this._updateModelPosition()},onClick:function(){return this._updateModelPosition()},positionByCenter:function(e){var t;return t=this.centerToCoord(e),this.$el.css({left:Math.round(t.x),top:Math.round(t.y)})},getCircleSize:function(){return this._width=this._width||this.$(l).width(),this._width},coordToCenter:function(e){var t,n;return n=this.getCircleSize()/2,t={x:e.x+n,y:e.y+n}},centerToCoord:function(e){var t,n;return n=this.getCircleSize()/2,t={x:e.x-n,y:e.y-n}}})}),define("game/levels/circle_proximity/main",["underscore","backbone","entities/circles","game/levels/_base","text!./instructions.hbs","composite_views/perch","./self_view","./proxy_view","ui_widgets/proceed"],function(e,t,n,i,s,r,o,a,l){var c,h;return h=function(e){return e*Math.PI/180},c=i.extend({className:"circleProximity",initialize:function(){return this.listenTo(this.collection,"change:interacted",this.onChangeInteracted),this.listenToOnce(l,"click",this._close),e.bindAll(this,"_renderLevel")},render:function(){return this.options.showInstructions?r.show({content:s,btn1Text:"I'm Ready",large:!0,onClose:this._renderLevel,mustUseButton:!0,supressTracking:!0}):this._renderLevel()},_renderLevel:function(){var t,n=this;return this.selfView=new o,this.$el.html(this.selfView.render().el),this.selfView.position(),this.$line=this.$(".line"),t=this.selfView.$el.width()/2,this.$line.css({left:t,top:t}),this.collection.each(function(t){return t.view=new a({model:t,$line:n.$line,selfView:n.selfView,track:e.bind(n.options.runner.track,n.options.runner)}),n.$el.append(t.view.render().el)}),this._positionCirclesAround(this.selfView.getSelfCenter()),this},_positionCirclesAround:function(e){var t,n,i,s;return t=this.collection.length,s=360/t,n=s/2+270,i=250,this.collection.each(function(t){return t.view.positionByCenter({x:Math.cos(h(n))*i+e.x,y:Math.sin(h(n))*i+e.y}),n+=s})},_close:function(){return this.collection.each(function(e){return e.view.remove()}),l.hide(),this.trigger("done"),this.remove()},onChangeInteracted:function(){return this.checkAllInteracted(this.collection)?l.show():void 0}})}),define("game/levels/circle_proximity",["game/levels/circle_proximity/main"],function(e){return e}),define("game/levels/circle_size_and_proximity",["jquery","underscore","backbone","Handlebars","game/levels/_base","entities/circles","game/levels/circle_size","game/levels/circle_proximity"],function(e,t,n,i,s,r,o,a){var l;return l=s.extend({className:"circleSizeAndProximity",start:function(){return this.circlesCollection=new r(this.model.get("circles")),this.track(s.EVENTS.start)},render:function(){return this._showCircleSize(),this},_showCircleSize:function(){return this.options.instructions.set({text:this.model.get("instructions")[0]}),this.curView=new o({collection:this.circlesCollection,runner:this,showInstructions:this.options.showInstructions}),this.$el.html(this.curView.el),this.track(s.EVENTS.sublevelStart),this.circlesCollection=this.curView.collection,this.listenToOnce(this.curView,"done",this._showCircleProximity)},_showCircleProximity:function(){return this.options.instructions.set({text:this.model.get("instructions")[1]}),this.curView=new a({collection:this.circlesCollection,runner:this,showInstructions:this.options.showInstructions}),this.$el.html(this.curView.el),this.curView.render(),this.track(s.EVENTS.sublevelStart,{data:this.circlesCollection.toJSON()}),this.listenToOnce(this.curView,"done",this.onTestDone)},onTestDone:function(){return this.summaryData={data:this.circlesCollection.toJSON(),self_coord:{top:this.curView.selfView.getSelfCenter().y-this.curView.selfView.getSelfRadius(),left:this.curView.selfView.getSelfCenter().x-this.curView.selfView.getSelfRadius(),size:2*this.curView.selfView.getSelfRadius()}},this.endLevel()}})}),define("game/levels/alex_trebek/main",["underscore","backbone","game/levels/_base","ui_widgets/icon_slider","ui_widgets/formation/select_by_icon"],function(e,t,n,i,s){var r,o,a,l;return l="game/levels/alex_trebek",r={icon_slider:"icon_slider",select_by_icon:"select_by_icon"},o={icon_slider:i,select_by_icon:s},a=n.extend({className:"alexTrebek",render:function(){var e=this;return this.$el.empty(),null!=this.collection&&this.collection.each(function(t){return e._renderOneQuestion(t)}),this},_renderOneQuestion:function(e){var t,n;if(n=e.attributes.question_type,!o[n])return console.warn(""+n+" is not a known question type");switch(t=new o[n]({model:e}),this.$el.append(t.render().el),n){case r.icon_slider:return this.listenTo(t,"slide",this.onSlide),this.listenTo(t,"stop",this.onChange);case r.select_by_icon:return this.listenTo(t,"change",this.onChange)}},_setDataForServer:function(){return this.summaryData={data:this.collection.toJSON()}},onSlide:function(e){return this.track(n.EVENTS.interact,e.model.attributes)},onChange:function(e){return e.model.set({interacted:!0}),e.model.set("answer",e.value),this.track(n.EVENTS.change,e.model.attributes),this.checkAllInteracted(this.collection)&&this.readyToProceed(),this._setDataForServer()}})}),define("game/levels/alex_trebek",["game/levels/alex_trebek/main"],function(e){return e}),define("game/levels/emotions_circles/main",["underscore","backbone","game/levels/_base","entities/circles","game/levels/circle_proximity"],function(e,t,n,i,s){var r;return r=n.extend({className:"emotionsCircles",start:function(){return this.options.instructions.set({text:this.model.get("instructions")}),this.collection=new i(this.model.attributes.circles),this.collection.each(function(e){return e.set("size",4)}),this.clearInteracted(this.collection),this.track(n.EVENTS.start)},render:function(){var e=this;return this.circleProximity=new s({collection:this.collection,runner:this,showInstructions:this.options.showInstructions}),this.$el.html(this.circleProximity.el),setTimeout(function(){return e.circleProximity.render()},1),this.listenToOnce(this.circleProximity,"done",this.onTestDone),this},onTestDone:function(){return this.summaryData={data:this.collection.toJSON(),self_coord:{top:this.circleProximity.selfView.getSelfCenter().y-this.circleProximity.selfView.getSelfRadius(),left:this.circleProximity.selfView.getSelfCenter().x-this.circleProximity.selfView.getSelfRadius(),size:2*this.circleProximity.selfView.getSelfRadius()}},this.endLevel()}})}),define("game/levels/emotions_circles",["game/levels/emotions_circles/main"],function(e){return e}),define("text!game/levels/snoozer/instructions-simple.hbs",[],function(){return'\n\n<div class="centered spaceAbove">\n    <h1 class="gfx-logo-snoozer"></h1>\n    <h3>\n        Press the alarm clocks when they ring so you can snooze longer.\n    </h3>\n</div>\n\n<p class="textAlignCenter">\n    <span class="clock"></span>\n</p>\n\n<p class="textAlignCenter">\n    <button class="btn btn-large btn-primary" id="ActionNext" type="button">Start</button>\n</p>'}),define("text!game/levels/snoozer/instructions-complex.hbs",[],function(){return'\n<div class="hero centered">\n    {{#if correct}}\n        <h1>Good!</h1>\n        <h3>You got <em>{{correct}}</em> out of <em>{{total}}</em></h3>\n        <h3>\n            Next, press the ringing clocks if they are green like this:\n        </h3>\n    {{else}}\n        <h1>Oops...</h1>\n        <h3>You missed all {{total}}</h3>\n        <h3>\n            Get ready this time. Press the ringing clocks if they are green:\n        </h3>\n    {{/if}}\n</div>\n\n<p class="textAlignCenter">\n    <span class="clock"></span>\n</p>\n\n<div class="centered">\n    <h3>But not if they\'re orange:</h3>\n</div>\n\n<p class="textAlignCenter decoy">\n    <span class="clock"></span>\n</p>\n\n<p class="textAlignCenter">\n    <button class="btn btn-large btn-primary" id="ActionNext" type="button">Ready</button>\n</p>'}),define("text!game/levels/snoozer/score.hbs",[],function(){return'<div class="hero centered results">\n    <h1 class="gfx-logo-snoozer"></h1>\n    <h3 class="inverse uppercase">\n        <div class="left fluff underline">\n            <b class="underline"></b>\n        </div>\n        <div class="right fluff underline">\n            <b class="underline"></b>\n        </div>\n        Results\n    </h3>\n</div>\n\n<div class="speed centered">\n    <h3 class="title inverse">Fastest Speed</h3>\n    <h3 class="time">{{fastest_time}}ms</h3>\n    <p class="textAlignCenter uppercase large">\n        Avg Man: 253, Avg Woman, 261\n    </p>\n</div>\n\n<div class="summary textAlignCenter">\n    <h3 class="yay">\n        <span class="clock small"></span>\n        {{correct}}/{{total}} Correct\n    </h3>\n    <h3 class="boo">\n        <span class="clock small"></span>\n        {{incorrect}} Incorrect\n    </h3>\n</div>\n\n<p class="large centered">\n    Your time can improve with training.\n    A good reaction time might be the only thing between life and death or injury.\n    The more you play these games, the faster you\'ll be able to think on your feet and achieve better focus.\n</p>\n\n<p class="callToAction textAlignCenter">\n    <a class="btn btn-large btn-primary btn-alt" href="#dashboard-productivity">Dashboard</a>\n    <a class="btn btn-large btn-primary" href="#game/just_snoozer">Play Again</a>\n</p>'}),define("text!game/levels/snoozer/stage.hbs",[],function(){return'\n\n\n\n\n\n\n\n<div class="stageHolder">\n    <div class="left fluff underline">\n        <b class="underline"></b>\n    </div>\n    <div class="right fluff underline">\n        <b class="underline"></b>\n    </div>\n    <b class="bottom fluff underline"></b>\n    <div class="stage underline">\n\n    </div>\n</div>\n\n\n'}),define("game/levels/snoozer/clock_view",["underscore","backbone","Handlebars"],function(e,t){var n,i,s,r,o,a;return s=1e3,r=150,o=500,n={ring:"ringing",decoy:"decoy","float":"float",hitGood:"yay",hitBad:"boo"},a='<b class="clock"></b>',i=t.View.extend({className:"clockHolder",events:{click:"onClick"},initialize:function(){if(!this.options.daddy)throw new Error("Need options.daddy");return e.bindAll(this,"miss","_stopRing")},render:function(){return this.$el.html(a),this},_reset:function(){return this.ringTime=new Date,this.$el.prop("class",this.className),this.model.clear().set(this.model.defaults)},_clearTimeout:function(){return clearTimeout(this.timeout)},_upNext:function(e,t){return clearTimeout(this.timeout),this.timeout=setTimeout(e,t)},_stopRing:function(){var e=this;return this._reset(),this._upNext(function(){return e.isRinging=!1},r)},correct:function(){return this.model.set({reaction_time:new Date-this.ringTime}),this.options.daddy.trigger("correct",this.model),this.$el.addClass(n.hitGood),this._upNext(this._stopRing,o)},incorrect:function(){return this.options.daddy.trigger("incorrect",this.model),this.$el.addClass(n.hitBad),this._upNext(this._stopRing,o)},miss:function(){return this.model.set({reaction_time:new Date-this.ringTime}),this.$el.hasClass(n.decoy)||this.options.daddy.trigger("miss",this.model),this._stopRing()},onClick:function(){return this._clearTimeout(),this.$el.hasClass(n.decoy)?this.incorrect():this.$el.hasClass(n.ring)?this.correct():this.incorrect()},ring:function(e,t){return this._reset(),e=e||s,this.model.set({duration:e,isDecoy:t||!1}),t?this.options.daddy.trigger("decoy",this.model):this.options.daddy.trigger("ring",this.model),this.$el.addClass(n.ring),this.$el.addClass(n.float),t&&this.$el.addClass(n.decoy),this.isRinging=!0,this._upNext(this.miss,e)}})}),define("game/levels/snoozer/clock",["backbone"],function(e){return e.Model.extend({defaults:{reaction_time:null,duration:null,isDecoy:null},initialize:function(){}})}),define("game/levels/snoozer/summary",["underscore","classes/model","utils/detect"],function(e,t,n){var i;return i=t.extend({defaults:{total:null,decoys:null,correct:0,incorrect:0,missed:0,reaction_times:[]},initialize:function(){return this.set("is_touch",n.isTouch())},addTime:function(e){var t;return t=this.get("reaction_times"),t.push(e),this.set({reaction_times:t})},calculate:function(){var t,n;return n=this.get("reaction_times"),n.length?(this.set({fastest_time:e.min(n)}),this.set({slowest_time:e.max(n)}),t=e.reduce(n,function(e,t){return e+t}),this.set({average_time:t/n.length}),this):void 0}})}),define("game/levels/snoozer/clock_popper",["underscore","backbone","Handlebars","text!./stage.hbs","./clock_view","./clock","./summary","utils/numbers","game/levels/_base"],function(e,t,n,i,s,r,o,a,l){var c,h,u,d;return d=".stage",u=3,h={clockCount:5,stepLimit:10,pauseTime:1e3,durationMax:1600,durationMin:1100},c=t.View.extend({className:"clockPopper",initialize:function(t){var n,i,o,a;if(!this.options.level)throw new Error("Need options.level");for(this.options=e.extend(h,t),this.clocks=[],n=o=0,a=this.options.clockCount;a>=0?a>o:o>a;n=a>=0?++o:--o)i=new r,this.clocks.push(new s({daddy:this,model:i}));return e.bindAll(this,"ringOne","_goSlow","_goFast","_done"),this.on("ring",this.onRing),this.on("decoy",this.onDecoy),this.on("miss",this.onMiss),this.on("correct",this.onCorrect),this.on("incorrect",this.onIncorrect)},render:function(){var e,t,n,s;for(this.$el.html(i),s=this.clocks,t=0,n=s.length;n>t;t++)e=s[t],this.$(d).append(e.render().el);return this.step=0,this.options.complex?this._goFast(!0):(this.options.stepLimit-=u,this._goSlow(!0)),this},onRing:function(e){return this.options.level.summary.increment("total"),this.options.level.track(l.EVENTS.shown,e.attributes)},onDecoy:function(e){return this.options.level.summary.increment("decoys"),this.options.level.track(l.EVENTS.decoy,e.attributes)},onMiss:function(e){return this.options.level.summary.increment("missed"),this.options.level.track(l.EVENTS.miss,e.attributes)},onCorrect:function(e){return this.options.level.summary.increment("correct"),this.options.level.summary.addTime(e.attributes.reaction_time),this.options.level.track(l.EVENTS.correct,e.attributes)},onIncorrect:function(e){return this.options.level.summary.increment("incorrect"),this.options.level.track(l.EVENTS.incorrect,e.attributes)},_getRandomClock:function(){var e;return e=this.clocks[Math.floor(Math.random()*this.clocks.length)],e.isRinging?this._getRandomClock():e},_done:function(e){var t=this;return e===!0?(this.step=0,this._goFast(!0)):setTimeout(function(){return t.options.level.next()},this.options.pauseTime)},_goSlow:function(t){var n;return t===!0?setTimeout(this._goSlow,this.options.pauseTime):this.step>=u?this._done(!0):(this.step++,n=this.ringOne(),t=e.random(this.options.durationMin/2,this.options.durationMax/2),setTimeout(this._goSlow,n+t))},_goFast:function(e){var t;return e===!0?setTimeout(this._goFast,this.options.pauseTime):this.step>=this.options.stepLimit?this._done():(this.step++,t=this.ringOne(),setTimeout(this._goFast,t/2))},ringOne:function(t){var n,i;return i=e.random(this.options.durationMin,this.options.durationMax),n=this._getRandomClock(),t?setTimeout(function(){return n.ring(i)},t):this.options.complex&&a.flipCoin()?(n.ring(i,!0),this.step--):n.ring(i),i}})}),define("game/levels/snoozer/main",["underscore","backbone","Handlebars","game/levels/_base","text!./instructions-simple.hbs","text!./instructions-complex.hbs","text!./score.hbs","./clock_popper","./summary"],function(e,t,n,i,s,r,o,a,l){var c,h,u,d;return h="snoozerBackground",u=n.compile(r),d=n.compile(o),c=i.extend({className:"snoozer",events:{"click #ActionNext":"next"},render:function(){return this.curScreen=0,this.summary=new l,$("body").addClass(h),this._showScreen(this.curScreen),this},_parseOptions:function(e){var t;return t={level:this,complex:e||!1,clockCount:this.model.attributes.target_count||null,stepLimit:this.model.attributes.limit_to||null,durationMax:this.model.attributes.interval_ceil||null,durationMin:this.model.attributes.interval_floor||null}},_showScreen:function(e){var t,n;switch(null!=(n=this.popper)&&n.remove(),e){case 0:return this.track(i.EVENTS.instructions),this.$el.html(s);case 1:return this.track(i.EVENTS.sublevelStart,{mode:"simple"}),this.popper=new a(this._parseOptions()),this.$el.html(this.popper.render().el);case 2:return this.track(i.EVENTS.instructions),this.$el.html(u(this.summary.attributes));case 3:return this.track(i.EVENTS.sublevelStart,{mode:"complex"}),t=this._parseOptions(!0),this.popper=new a(t),this.$el.html(this.popper.render().el);default:return this.summaryData=this.summary.calculate().attributes,this.endLevel()}},next:function(){return this._showScreen(++this.curScreen)},close:function(){return $("body").removeClass(h)}})}),define("game/levels/snoozer",["game/levels/snoozer/main"],function(e){return e}),define("text!game/levels/interest_picker/interest_picker.hbs",[],function(){return'\n\n\n\n<div class="menu">\n    <div class="content">\n        <div class="row one"></div>\n        <div class="row two"></div>\n        <div class="row three"></div>\n        <div class="row four"></div>\n    </div>\n</div>\n\n<div class="bentoBox">\n\n    <h3 id="SymbolCount">Symbols</h3>\n    <div class="symbols content">\n        <div id="SymbolCountdown" class="countdown">\n            Collect <br/>\n            <strong>{{symbols}}</strong>\n        </div>\n    </div>\n\n    <br/>\n\n    <h3 id="WordCount">Words</h3>\n    <div class="words content">\n        <div id="WordCountdown" class="countdown">\n            Collect <br/>\n            <strong>{{words}}</strong>\n        </div>\n    </div>\n\n</div>\n\n\n'
}),define("game/levels/interest_picker/baits",["underscore","backbone","classes/model"],function(e,t,n){var i,s,r;return r={word:"word",symbol:"symbol"},i=n.extend({TYPES:r,defaults:{type:r.symbol,value:"Default",dimension:null,desc:null,isPicked:null,factors:{realistic:null,investigative:null,artistic:null,social:null,enterprising:null,conventional:null}}}),s=t.Collection.extend({model:i,countPickedWords:function(){var e;return e=this.filter(function(e){return e.get("isPicked")&&e.get("type")===e.TYPES.word}),e.length},countPickedSymbols:function(){var e;return e=this.filter(function(e){return e.get("isPicked")&&e.get("type")===e.TYPES.symbol}),e.length},getPicked:function(){var t;return t=this.filter(function(e){return e.get("isPicked")}),e.map(t,function(e){return e.toJSON()})}}),s.TYPES=r,s}),define("text!game/levels/interest_picker/bait_symbol.hbs",[],function(){return'\n<i class="{{value}}"></i>\n\n'}),define("game/levels/interest_picker/bait_view",["underscore","backbone","Handlebars","text!./bait_symbol.hbs"],function(e,t,n,i){var s,r,o,a,l,c,h,u,d;return d=n.compile(i),a=".bentoBox .content",r=200,o={word:".bentoBox .words",symbol:".bentoBox .symbols"},l=".menu .content",u="sliding",h="picked",c="naughty",s=t.View.extend({className:"bait",events:{mousedown:"onClick"},initialize:function(){return e.bindAll(this,"_picked")},render:function(){var e=this;return this._reset(),this.model.attributes.type===this.model.TYPES.symbol?(this.$el.html(d(this.model.attributes)),this.$el.addClass(this.model.TYPES.symbol)):(this.$el.text(this.model.attributes.value),this.$el.addClass(this.model.TYPES.word)),setTimeout(function(){return e.$el.addClass(u)},10),this},onClick:function(){return this.model.attributes.isPicked?this.unpick().remove():this._pick()},_reset:function(){return this.delegateEvents(),this.$el.removeClass(u),this.$el.removeClass(h),this.$el.removeClass(c)},_pick:function(){return this.timeout=setTimeout(this._picked,r),this.$el.addClass(h),this.model.set({isPicked:!0,record_time:(new Date).getTime()},this)},_picked:function(){return this._reset(),this.$el.appendTo(o[this.model.attributes.type])},unpick:function(){return clearTimeout(this.timeout),this.model.set({isPicked:!1,record_time:(new Date).getTime()}),this._reset(),this},sayNo:function(){var e=this;return this.$el.addClass(c),this.timeout=setTimeout(function(){return e.$el.addClass(u).removeClass(c)},2*r),this},close:function(){return clearTimeout(this.timeout),this}})}),define("game/levels/interest_picker/main",["underscore","backbone","Handlebars","game/levels/_base","utils/numbers","text!./interest_picker.hbs","./baits","./bait_view"],function(e,t,n,i,s,r,o,a){var l,c,h,u,d,p,f,m,g,v,b,y,_,w,k,S,x;return v=2,x=1,b=800,_=12e3,d=".menu .row",c="blocked",w=".content.words",f=".content.symbols",k="#WordCount",m="#SymbolCount",h=".countdown",p="shimmer",S=n.compile("Words <span class='muted'>{{count}}/"+x+"</span>"),g=n.compile("Symbols <span class='muted'>{{count}}/"+v+"</span>"),y=n.compile(r),u='<span class="good"><i class="icon-ok-sign"></i> Done</span>',l=i.extend({className:"interestPicker",CollectionClass:o,start:function(){var t=this;return this.track(i.EVENTS.start),this.collection.reset(this.collection.shuffle(),{silent:!0}),this.collection.each(function(e){var t;return t=new a({model:e}),e.view=t}),this.listenTo(this.collection,"change",this.onChange),e.bindAll(this,"_step","_startSteppin"),this._i=0,$(window).blur(function(){return clearInterval(t._interval)}),$(window).focus(this._startSteppin),this._startSteppin(),this},render:function(){return this.$el.html(y({words:x,symbols:v})),this._updateCounts(),this},_startSteppin:function(){return clearInterval(this._interval),this._interval=setInterval(this._step,b)},_hasPickedEnough:function(){var e,t;return t=this.collection.filter(function(e){return e.get("isPicked")&&e.get("type")===e.TYPES.word}),e=this.collection.filter(function(e){return e.get("isPicked")&&e.get("type")===e.TYPES.symbol}),t.length>=x&&e.length>=v?!0:void 0},_step:function(){var e;return e=this.collection.at(this._i),e&&!e.attributes.isPicked&&this._pickRow().append(e.view.render().el),this._i++,this._i>=this.collection.length?this._i=0:void 0},_pickRow:function(){var e;return e=s.pickOneAnyOne($(""+d+":not('."+c+"')")),$(d).removeClass(c),$(e).addClass(c)},_updateCounts:function(){return $(h).hide(),this._lastWordCount!==this.collection.countPickedWords()&&this._updateWordCount(this.collection.countPickedWords()),this._lastSymbCount!==this.collection.countPickedSymbols()&&this._updateSymbolCount(this.collection.countPickedSymbols()),this._lastWordCount=this.collection.countPickedWords(),this._lastSymbCount=this.collection.countPickedSymbols()},_updateWordCount:function(e){return e===x?($(k).html(u),this._shimmerSel(w)):$(k).html(S({count:e}))},_updateSymbolCount:function(e){return e===v?($(m).html(u),this._shimmerSel(f)):$(m).html(g({count:e}))},_shimmerSel:function(e){var t;return t=$(e),t.removeClass(p),setTimeout(function(){return t.addClass(p)},1)},onChange:function(e){switch(this._updateCounts(),this._onBaitChange(e),e.attributes.type){case e.TYPES.word:this.collection.countPickedWords()>x&&e.view.unpick().sayNo();break;case e.TYPES.symbol:this.collection.countPickedSymbols()>v&&e.view.unpick().sayNo()}return this._hasPickedEnough()?(this.summaryData={picked:this.collection.getPicked()},this.readyToProceed()):this.notReadyToProceed()},_onBaitChange:function(e){switch(e.attributes.isPicked){case!0:return this.track(i.EVENTS.selected,e.toJSON());case!1:return this.track(i.EVENTS.deselected,e.toJSON());default:return console.warn("Twilight zone. Neither picked nor not picked")}},close:function(){return clearInterval(this._interval),$(window).off(),this.remove()}})}),define("game/levels/interest_picker",["game/levels/interest_picker/main"],function(e){return e}),define("text!game/welcome/personality.hbs",[],function(){return'\n<div class="gameWelcome personality">\n\n    <div class="title">\n        <h1 class="gfx-logo-personality"></h1>\n        <h3>\n            Play to discover the different shades of your personality and interests.\n        </h3>\n    </div>\n\n    <p class="image">\n        <img src="images/home_page/about-graphics_02b.png" alt="Personality Badges"/>\n    </p>\n\n    <p class="action">\n        <button class="btn btn-large btn-primary" id="ActionBeginGame" type="button">Start Game</button>\n    </p>\n</div>\n\n'}),define("text!game/calculate_results.hbs",[],function(){return'\n<h1>Congratulations!</h1>\n<h3>You have completed the game.</h3>\n<p id="StatusMessage" class="muted">\n    Calculating Results...\n</p>\n\n<b class="holdPlease inline">\n    <i class="icon-repeat icon-4x"></i>\n</b>\n\n'}),define("entities/daddy_ios",["utils/detect"],function(e){var t,n,i;return i="iosAction://",n=function(){return this},t=function(t){return e.isUIwebView()||(null!=t?t.force:void 0)?this.isUp=!0:this.save=this.cleanUp=n,this},t.prototype={holla:function(e,t){return this.iframe=this.iframe||document.createElement("IFRAME"),this.iframe.setAttribute("src",""+i+JSON.stringify(e)),console.log({iosAction:JSON.stringify(e)}),document.documentElement.appendChild(this.iframe),t||this.cleanUp,this},cleanUp:function(){return null!=this.iframe?(this.iframe.parentNode.removeChild(this.iframe),delete this.iframe,this):void 0}},t}),define("game/calculate_results",["backbone","Handlebars","text!./calculate_results.hbs","core","composite_views/perch","entities/daddy_ios"],function(e,t,n,i,s,r){var o,a,l;return a="game/calculate_results",l="#StatusMessage",o=e.View.extend({className:"calculateResults",initialize:function(){return this.ios=new r,this.listenTo(this.model,"change",this.onChange),this.listenTo(this.model,"error",this.onError),i.analytics.track(this.className,"Starting game results calculation")},render:function(){return this.$el.html(n),this},_updateStatusMsg:function(e){return e.attributes.status.message?this.$(l).text(e.attributes.status.message):void 0},_showResults:function(){return i.router.navigate("gameResults/"+this.model.attributes.game_id,{trigger:!0})},_gotGameResults:function(){return i.analytics.track(this.className,"Successfully calculated game results"),this.ios.isUp?this.ios.holla(1):this._showResults()},onError:function(e,t){var n,r=this;return this.ios.holla(0),i.analytics.track(this.className,"Error Getting game results"),s.show({title:"Sorry, There Is a Problem.",msg:(null!=(n=t.responseJSON)?n.status.message:void 0)||t.statusText,btn1Text:"Ok",onClose:function(){return r._showResults()},mustUseButton:!0})},onChange:function(e){return this._updateStatusMsg(e),e.attributes.status.state===e.STATES.done?this._gotGameResults(e):void 0}})}),define("game/mini_instructions",["backbone"],function(e){var t;return t=e.View.extend({className:"miniInstructions",initialize:function(){return this.model=new e.Model,this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.model.attributes.text),this}})}),define("pages/play_game",["backbone","Handlebars","core","entities/results_calculator","entities/user_event/_event_bundle","ui_widgets/steps_remaining","ui_widgets/hold_please","ui_widgets/psst","game/levels/reaction_time_disc","game/levels/rank_images","game/levels/circle_size_and_proximity","game/levels/alex_trebek","game/levels/emotions_circles","game/levels/snoozer","game/levels/interest_picker","text!game/welcome/personality.hbs","game/calculate_results","game/mini_instructions","utils/numbers"],function(e,t,n,i,s,r,o,a,l,c,h,u,d,p,f,m,g,v,b){var y,_,w,k,S,x,C,P,T,E,N,I;return P="pages/playGame",T="/pages/play_game",C="#HeaderRegion",w="baseline",E=.25,I={ReactionTime:l,ImageRank:c,CirclesTest:h,Survey:u,EmotionsCircles:d,Snoozer:p,InterestPicker:f},x={baseline:m},N={baseline:"The Personality Game",emotions:"Emotions Game"},k="Play a Game",_=1,S="This short, fun, and interactive assessment helps you discover your personality type.",y=e.View.extend({title:k,className:"playGamePage",events:{"click #ActionBeginGame":"_begin"},initialize:function(){if(!this.options.params)throw new Error("Need params");return o.show(null,!0),this.model=n.user.createGame(this.options.params.def_id),this.listenTo(n.user,"error",this._userModelErr),this.listenTo(this.model,"error",this._curGameErr),this.listenTo(this.model,"sync",this.onSync),this.listenTo(this.model,"change:stage_completed",this._onStageChanged),n.analytics.track(this.className,""+this.options.params.def_id+" Game Started"),this.options.params.def_id===w?n.analytics.trackKeyMetric(""+w+" game","Started"):void 0},_showWelcome:function(){var e;return e=this.options.params.def_id,null!=x[e]?this.$el.html(x[e]):this._begin()},_begin:function(){return this._trackLevels(),this.miniInstructions=new v,$(C).append(this.miniInstructions.el),this.model.nextStage()},onSync:function(){return o.hide()},_onStageChanged:function(e){var t,n,i;return t=e.attributes.stage_completed,n=e.attributes.stages.length,null!=(i=this.stepsRemaining)&&i.setComplete(t),-1===t?this._showWelcome():n>t?this._showLevel(t):t===n?this._endGame():t>n?this._calculateResults():console.log(""+P+"._curGameSync: unusual curStage: "+t)},_curGameErr:function(){throw o.hide(),a({title:"Error",msg:"Sorry, there was a problem loading the game.",sel:this.$el,type:a.TYPES.error}),new Error(""+P+": Error on the game model")},_userModelErr:function(){throw o.hide(),a({title:"Error",msg:"Sorry, there was a problem loading the user.",sel:this.$el,type:a.TYPES.error}),new Error(""+P+": Error on the user model")},_trackLevels:function(){return 1!==this.model.attributes.stages.length?(this.stepsRemaining=new r({title:N[this.options.params.def_id],collection:new e.Collection(this.model.attributes.stages)}),$(C).append(this.stepsRemaining.render().el)):void 0},_finishPreviousLevel:function(t){return t&&t instanceof e.View?(t.remove(),this.miniInstructions.model.set({text:""}),n.analytics.track(this.className,""+t.model.attributes.stageDef+" Level Finished")):void 0},_showLevel:function(t){var i,s;if(s=this.model.get("stages")[t],i=I[s.level_definition_name]||I[s.view_name],!i)throw new Error("View Class not found for game level of type "+s.view_name);return this._finishPreviousLevel(this.curLevel),this.curLevel=new i({model:new e.Model(s),assessment:this.model,stageNo:t,stageDef:s.level_definition_name||s.view_name,showInstructions:"ReactionTime"===s.view_name||!1,instructions:this.miniInstructions.model}),this.$el.html(this.curLevel.render().el),this.model.setLevelSeen(s.view_name),n.analytics.trackPage(""+T+"/"+this.options.params.def_id+"/"+t),n.analytics.track(this.className,""+this.curLevel.model.attributes.stageDef+" Level Started")},_endGame:function(){return b.casino(E)?(this._finishPreviousLevel(this.curLevel),this.curLevel=new u({assessment:this.model,stageNo:999,stageDef:"survey",model:new e.Model({data:[{question:"Did you enjoy playing this game?",question_id:"enjoyed_game",topic:"user_behavior_survey",question_type:"select_by_icon",options:[{icon:"gfx-happiness",value:"yes"},{icon:"gfx-sadness",value:"no"}]}]})}),this.$el.html(this.curLevel.render().el),n.analytics.trackKeyMetric(""+this.options.params.def_id+" Enjoyment","Shown Question"),this.listenToOnce(this.curLevel,"done",function(e){var t;return"yes"===(null!=e?null!=(t=e.data[0])?t.answer:void 0:void 0)?n.analytics.trackKeyMetric(""+this.options.params.def_id+" Enjoyment","Answered Yes"):n.analytics.track(""+this.options.params.def_id+" Enjoyment","Answered No")})):this._calculateResults()},_calculateResults:function(){return n.analytics.trackKeyMetric("Game","Finished"),n.analytics.track(this.className,""+this.options.params.def_id+" Game Finished"),this.options.params.def_id===w&&n.analytics.trackKeyMetric(""+w+" Game","Finished"),this.listenToOnce(this.curLevel.event,"sync",this._eventSync),this.listenToOnce(this.curLevel.event,"error",this._eventSync)},_eventSync:function(){return this._finishPreviousLevel(this.curLevel),this.curLevel=new g({game:this.model,model:new i({game_id:this.model.get("id")})}),this.$el.html(this.curLevel.render().el)},close:function(){var e,t;return null!=(e=this.curLevel)&&"function"==typeof e.close&&e.close(),null!=(t=this.curLevel)?t.remove():void 0}})}),define("text!pages/social_results.hbs",[],function(){return'\n\n<h1>Personality Comparison</h1>\n\n<div class="contents">\n    <p class="textAlignCenter">\n        <b class="holdPlease inline">\n            <i class="icon-repeat icon-2x muted"></i>\n        </b>\n    </p>\n    <br/>\n    <p class="textAlignCenter">\n        <span class="muted">Loading results for id: {{game_id}}</span>\n    </p>\n</div>\n\n<div class="textAlignCenter">\n    <div class="contentSelf chartHolder">\n        <h2>Tidepool Results</h2>\n    </div>\n    <div class="contentSocial chartHolder">\n        <h2>Social Results</h2>\n    </div>\n</div>\n'}),define("text!pages/social_results-not_enough.hbs",[],function(){return'\n\n<h1>Personality Comparison</h1>\n\n<p class="large">\n    There are not enough results yet to compute your social personality profile.\n</p>\n<p>\n    You need to have at least <strong>3 friends</strong> complete a personality survey for you by sharing this link with them:\n    <a href="{{origin}}/#friendHelper/0/{{game_id}}">\n        {{origin}}/#friendHelper/0/{{game_id}}\n    </a>\n\n</p>\n\n'}),define("entities/friend_survey",["underscore","classes/model","core"],function(e,t,n){var i;return i=t.extend({url:function(){return""+n.cfg.apiServer+"/api/v1/games/"+this.attributes.game_id+"/friend_survey"},initialize:function(){return this.on("error",this.onErr)},onErr:function(){return console.error("Error getting the friend survey results")}})}),define("pages/social_results",["backbone","Handlebars","core","text!./social_results.hbs","text!./social_results-not_enough.hbs","entities/friend_survey","charts/polar_area"],function(e,t,n,i,s,r,o){var a,l,c,h,u,d;return u=t.compile(i),d=t.compile(s),l=".contents",c=".contentSelf",h=".contentSocial",a=e.View.extend({title:"Social Survey Results",className:"socialResultsPage",initialize:function(){return this.options.params.game_id||console.error("Need game_id"),this.model=new r({game_id:this.options.params.game_id}),this.listenTo(this.model,"sync",this.onSync),this.listenTo(this.model,"error",this.onErr),this.model.fetch()},render:function(){return this.$el.html(u(this.options.params)),this},renderContent:function(){},onSync:function(){return this.chartSelf=new o({data:{name:"Self-Reported",chartValues:this.model.attributes.my_results,width:350,height:300,options:{animation:!1}}}),this.chartSocial=new o({data:{name:"Social Personality",chartValues:this.model.attributes.others_results,width:350,height:300}}),this.$(l).remove(),this.$(c).append(this.chartSelf.render().el),this.$(h).append(this.chartSocial.render().el)},onErr:function(){return this.$el.html(d({game_id:this.options.params.game_id,origin:window.location.protocol+"//"+window.location.hostname}))}})}),define("text!pages/team.hbs",[],function(){return'\n\n\n<h2>Meet the TidePool Team</h2>\n<p>\n    <div class="coolPerson"><i class="avatar huge"><img src="images/people/galen.jpg" alt="Photo of Team Member"/></i>\n        <p>Galen<br/>Buckwalter</p>\n    </div>\n    <div class="coolPerson"><i class="avatar huge"><img src="images/people/vamsee.jpg" alt="Photo of Team Member"/></i>\n        <p>Vamsee<br/>Nalamothu</p>\n    </div>\n    <div class="coolPerson"><i class="avatar huge"><img src="images/people/kerem.jpg" alt="Photo of Team Member"/></i>\n        <p>Kerem<br/>Karatal</p>\n    </div>\n    <div class="coolPerson"><i class="avatar huge"><img src="images/people/miraj.jpg" alt="Photo of Team Member"/></i>\n        <p>Miraj<br/>Sanghvi</p>\n    </div>\n    <div class="coolPerson"><i class="avatar huge"><img src="images/people/eric.jpg" alt="Photo of Team Member"/></i>\n        <p>Eric<br/>Miller</p>\n    </div>\n    <div class="coolPerson"><i class="avatar huge"><img src="images/people/jenni.jpg" alt="Photo of Team Member"/></i>\n        <p>Jenni<br/>Leder</p>\n    </div>\n</p>\n\n<hr>\n\n<h2>Our Awesome Investors</h2>\n<p>\n    <div class="supercoolPerson"><i class="avatar large"><img src="images/people/md.jpg" alt="Photo of Investor"/></i>\n        <p>Michael Dearing</p>\n        <p class="muted">Harrison Metal</p>\n    </div>\n    <div class="supercoolPerson"><i class="avatar large"><img src="images/people/mike.jpg" alt="Photo of Investor"/></i>\n        <p>Mike Hirshland</p>\n        <p class="muted">Resolute.VC</p>\n    </div>\n    <div class="supercoolPerson"><i class="avatar large"><img src="images/people/tim.jpg" alt="Photo of Investor"/></i>\n        <p>Tim Draper</p>\n        <p class="muted">DFJ</p>\n    </div>\n\n    <br/>\n</p>\n\n<br/>\n\n<h3>And Support From</h3>\n\n<p class="supercoolPerson caps">\n    Diego Berdakin,\n    Dan Gould,\n    Rich Rygg,\n    Jeff Lipp,\n    Jarl Mohn,<br/>\n    Jim & Peggy Davis,\n    Rak Tech Fund,\n    and Amplify\n</p>\n\n\n'}),define("pages/team",["backbone","Handlebars","text!./team.hbs"],function(e,t,n){var i;return i=e.View.extend({title:"Our Team",className:"teamPage",render:function(){return this.$el.html(n),this}})});
//# sourceMappingURL=main.js.map